<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="README.css">
<link rel="prev" href="MANUAL-ja.html">
<link rel="next" href="CONTENTS-ja.html">
<title>「のどか」 - MANUAL - CUSTOMIZE</title>
<style type="text/css">
.auto-style1 {
	font-family: "ＭＳ Ｐゴシック";
}
.auto-style2 {
	font-family: "ＭＳ Ｐゴシック";
	font-weight: bold;
}
.auto-style3 {
	font-size: 100%;
}
.auto-style4 {
	font-family: "ＭＳ Ｐゴシック";
	font-size: 100%;
	color: #AA0000;
}
.auto-style5 {
	font-family: "ＭＳ ゴシック";
}
.auto-style6 {
	color: #AA0000;
}
</style>
</head>

<body class="manual">

<div class="main">
  <dl>
    <dt class="h1"><font face="ＭＳ Ｐゴシック"><a href="MANUAL-ja.html#CUSTOMIZE" name="CUSTOMIZE">
	８. カスタマイズ　customize</a>
	
    </font>
	
    <dd class="d1">
	<div>
	  <p><font face="ＭＳ Ｐゴシック">付属の </font> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font color="#AA0000"><code><font face="ＭＳ Ｐゴシック">
		</font> </code>
		</font><font face="ＭＳ Ｐゴシック">設定ファイルを利用すれば、エディットコントロールで Emacs 
		風の操作ができるようになります。また、ホームディレクトリに置いた </font><code><font face="ＭＳ Ｐゴシック">
		<a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック"> 
		をカスタマイズすることによって、Windowsおよび各種アプリケーションを自分の好きなキー操作で利用することができるようになります。</font></p>
	  
	  <p> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック"> 
		は<a href="#HOME">ホームディレクトリ</a>から検索されます。</font></p>

	  <p> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック"> 
		は上から下へ読まれていき、重複する記述があれば、より下に書かれているものが有効になります。コメントは  
		</font> <code><font face="ＭＳ Ｐゴシック">#</font></code><font face="ＭＳ Ｐゴシック"> 
		ではじめます。アルファベットの大文字と小文字は区別されません。詳しい文法は  
		</font> <a href="syntax.txt"><code><font face="ＭＳ Ｐゴシック">syntax.txt</font></code></a><font face="ＭＳ Ｐゴシック"> 
		を参照してください。</font></p>

	  <p><font face="ＭＳ Ｐゴシック">この章を読む前に、</font><code><a href="../contrib/nodoka-settings.txt"><font face="ＭＳ Ｐゴシック">contrib\nodoka-settings.txt</font></a></code><font face="ＭＳ Ｐゴシック"> 
		を読んで付属の設定ファイルについて理解を深めておくことをお勧めします。</font></p>
	  
	  <dl>
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="key">i. キー割り当ての変更</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p><font face="ＭＳ Ｐゴシック">キー割り当てを変更するには、以下のように記述をします。</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ Ｐゴシック">&nbsp;</font><font face="ＭＳ ゴシック">key <em>KEY</em> = <em>
			KEY</em> や <em>FUNCTION</em> …
		  </font>
		  </p>
		  
		  <p><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
			より左の  
			</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
			をキーボードで押すと、Windows へは  
			</font> <code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
			より右の  
			</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
			が順番に入力されます。また、右に  
			</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
			が書かれている場合はウィンドウの最大化や移動などの機能が実行されます。</font></p>
		  
		  <p><code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
			は<a href="#keyboard">キーボード定義</a>で定義されるもので、デフォルトでは  
			</font> <a href="./109.nodoka.txt"><code>
			<font face="ＭＳ Ｐゴシック">109.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> 
			又は  
			</font> <a href="./104.nodoka.txt"><code><font face="ＭＳ Ｐゴシック">
			104.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> で定義されている  
			</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
			が使用できます。<a href="keyboard.html#キーボード配列定義">図示したものは、こちら。</a></font></p>
		  
		  <dl>
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="modifier">モディファイヤの指定</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の前に以下のような記号を付けることによって、コントロールキーなどの状態を表現できます。また、これらをモディファイヤと呼ぶことにします。</font></p>
				<dd class="d3">
				<div>
					<p>例えば<font face="ＭＳ Ｐゴシック">、C-を用いるとコントロールキーが押された場合を記述でき、以下の設定例では、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
					+ </font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
					を押した時に、</font><kbd><font face="ＭＳ Ｐゴシック">HOME</font></kbd><font face="ＭＳ Ｐゴシック"> 
					キーが入力されます。</font></p>
					<p class="sample"><font face="ＭＳ Ｐゴシック">&nbsp;</font><font face="ＭＳ ゴシック">key 
					C-A = HOME </font></p>
				</div>
				</dd>
				<p class="auto-style4">■ 
				コントロールキー、Altキー、Shiftキー、NumLockキー、CapsLockキー、ScrollLockキーの状態を示すモディファイヤ</p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック">C-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">M-</font></code><font face="ＭＳ Ｐゴシック"> 
				か  
				</font><code><font face="ＭＳ Ｐゴシック">A-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">Alt</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">S-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されていることを表します。
				 
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">W-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">Windows</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">NL-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">NumLock</font></kbd><font face="ＭＳ Ｐゴシック"> 
				がロック状態であることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">CL-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">CapsLock</font></kbd><font face="ＭＳ Ｐゴシック"> 
				がロック状態であることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">SL-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">ScrollLock</font></kbd><font face="ＭＳ Ｐゴシック"> 
				がロック状態であることを表します。<br>
　</font></ul>
				<p class="auto-style4">■ 
				論理的なモディファイヤ</p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック">L0-〜L9-, LA-〜LF-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、<a href="#lock">ロックキーの項</a>をご覧ください。</font><li><code>
					<font face="ＭＳ Ｐゴシック">M0-〜M9-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、<a href="#mod0〜mod9(M0〜M9)">モディファイヤキーの定義の後段</a>をご覧ください。<br>
					</font>
				</ul>
				<p class="auto-style4">■ カタカナキーや、IMEの状態を示すモディファイヤ　（<font face="ＭＳ Ｐゴシック">Microsoft 
				Office系アプリとMS-IMEの組み合わせでTSF有効な場合、正しく取得できません。）</font></p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック">KL-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、</font><kbd><font face="ＭＳ Ｐゴシック">カナ</font></kbd><font face="ＭＳ Ｐゴシック"> 
				がロック状態であることを表します。(</font><a href="CUSTOMIZE-ja.html#def_option_KL" target="MANUAL"><font face="ＭＳ Ｐゴシック">オプション 
				(</font><code><font face="ＭＳ Ｐゴシック">KL-</font></code><font face="ＭＳ Ｐゴシック">)</font></a>指定<font face="ＭＳ Ｐゴシック">が必要となります。def 
					option KL- = enable )<br>109 キーボードなら、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font><kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font><kbd><font face="ＭＳ Ｐゴシック">ひらがな</font></kbd><font face="ＭＳ Ｐゴシック">。<br>104 キーボードなら、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font><kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font><kbd><font face="ＭＳ Ｐゴシック">CapsLock</font></kbd><font face="ＭＳ Ｐゴシック">。<br>なお Microsoft Office IME2010 
					  変換入力中に未確定の文字があるとき、ローマ字入力とかな入力を切り替えると認識が一文字遅れます。<br>またIME上のKANAをクリックした場合は確定していても遅れます。Google日本語入力も似たような不具合があります。<br>
					</font>
					<li><code><font face="ＭＳ Ｐゴシック">IL-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、IME が On になっていることを表します。 <a href="MANUAL-ja.html#Q6">
					IMEがOnになったあとで、一文字キー入力すると、IC-も付くので、IME On中を判定させる場合、</a></font><a href="MANUAL-ja.html#Q6">IL-*IC- 
					を使うことになります。</a><li><code><font face="ＭＳ Ｐゴシック">IC-</font></code><font face="ＭＳ Ｐゴシック"> 
				あるいは
			     
				</font><code><font face="ＭＳ Ｐゴシック">I- </font></code>
					<font face="ＭＳ Ｐゴシック">は、IME で変換中であることを表します。<br></font>
					<li><code><font face="ＭＳ Ｐゴシック">IH-</font></code> 
					  半角入力であることを示します。全角入力時には追加されません。<li><code>
					<font face="ＭＳ Ｐゴシック">IK-</font></code> 
					  カタカナ入力であることを示します。ひらがな入力時には追加されません。<li><code>
					<font face="ＭＳ Ｐゴシック">IJ-</font></code> 
					  日本語入力であることを示します。英数入力時には追加されません。<li><code>
					<font face="ＭＳ Ｐゴシック">IW-</font></code> 
					  変換候補ウィンドウが開いていることを示します。<br>なお、これらKL-, IL-, IH-, IK-, IJ- 
					は、TSF(Text Services 
					Framework)が使える場合には、IMM32ではなく、そちらから取得します。ただし、お使いのIME種別やアプリケーションに依存して、<u><b>正しく取得できないことがあります。</b></u>またWindows 
					  2000では、IH-, IK-, IJ-は機能しません。<br>また、IW-については、Google日本語入力では<span>候補ウィンドウでは認識するものの、サジェストウィンドウでは</span>認識できません。またx64環境の32bitアプリでは認識できません。また 
					  Micorosoft Word 2010も認識できません。<br>
					また、IH-, IK-, IJ- については、<a href="#def_option_UseTSF">def 
					option UseTSF = false</a>, あるいは、<a href="#function_UseTSF">&amp;UseTSF(false)</a>の場合、認識できなくなります。<br>
				</ul>
				<p class="auto-style4">■ ウィンドウの状態を示すモディファイヤ</p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック">MAX-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、ウィンドウが最大化されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">MIN-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、ウィンドウが最小化されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">MMAX-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、MDI 子ウィンドウが最大化されていることを表します。
			     
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">MMIN-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、MDI 子ウィンドウが最小化されていることを表します。<br></font>
				</ul>
				<p class="auto-style4">■ タッチパッドの状態を示すモディファイヤ<font face="ＭＳ Ｐゴシック">　有効にするためには<a href="#def_option_ts4nodoka" target="MANUAL">オプション</a>を設定する必要があります。</font></p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック">T-</font></code><font face="ＭＳ Ｐゴシック"> 
					は、タッチパッドに指が触れていることを表します。 </font>
					<li><code><font face="ＭＳ Ｐゴシック">TS-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、全てのキーが離されるまでオフにならないことを除けば  
				</font><code><font face="ＭＳ Ｐゴシック">T-</font></code><font face="ＭＳ Ｐゴシック"> 
				と同じです。</font><li><code><font face="ＭＳ Ｐゴシック">TL-</font></code><font face="ＭＳ Ｐゴシック"> 
					は、タッチパッド の左側の領域に、指が触れていることを表します。</font><li><code>
					<font face="ＭＳ Ｐゴシック">TLS-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、全てのキーが離されるまでオフにならないことを除けば  
				</font><code><font face="ＭＳ Ｐゴシック">TL-</font></code><font face="ＭＳ Ｐゴシック"> 
				と同じです。
			   
				</font>
					<li><code><font face="ＭＳ Ｐゴシック">TR-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、タッチパッド の右側の領域に指が触れていることを表します。</font><li><code>
					<font face="ＭＳ Ｐゴシック">TRS-</font></code><font face="ＭＳ Ｐゴシック"> 
				は、全てのキーが離されるまでオフにならないことを除けば  
				</font><code><font face="ＭＳ Ｐゴシック">TR-</font></code><font face="ＭＳ Ｐゴシック"> 
				と同じです。<br></font>
				</ul>
				<p class="auto-style4">■ 
				<a name="K0toK7Modifier">複数のキーボード(最大8個まで)を接続した場合、どのキーボードからの入力であるかを示すモディファイヤ</a></p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック"><a name="K0-">K0-からK7-</a></font></code><font face="ＭＳ Ｐゴシック"> 
				は、それぞれのキーボードからの入力であることを表します。<br>　def option 
					UnitID行が無ければ、表示されません。また指定されたキーボード以外の入力については、K0-となります。詳細については、<a target="MANUAL" href="#def_option_UnitID">def 
					option UnitID</a>の説明をご覧ください。<br>
　</font></ul>
				<p class="auto-style4">■ 
				<a name="DP-Modifier">キー2回押し検出モディファイヤ</a></p>
				<ul>
					<li><code><font face="ＭＳ Ｐゴシック"><a name="DP">DP-</a></font></code><font face="ＭＳ Ｐゴシック"> 
				は、指定した時間内に同じキーが続けて2回押されたことを示します。<br>　def option 
					UseDoublePress行が無ければ、表示されません。詳細については、<a target="MANUAL" href="#def_option_UnitID">def 
					option UseDoublePress</a>の説明をご覧ください。<br></font>
				</ul>
				<p><font face="ＭＳ Ｐゴシック"><br></font>
			</div>
			  <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="ignoreModifier">
			モディファイヤキーの無視</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">上記の例では左側に </font> <code>
				<font face="ＭＳ Ｐゴシック">C-A</font></code><font face="ＭＳ Ｐゴシック"> 
				と記述していますが、この記述では、ロックキーなどは押されていても押されてなくても良いと記述していることになります。たとえば、</font><kbd><font face="ＭＳ Ｐゴシック">CapsLock</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押したあとで  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押しても、押さずに  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押しても、Windows へは  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Home</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">特定のモディファイヤの状態を無視したい場合は、モディファイヤに &quot;</font><code><font face="ＭＳ Ｐゴシック">*</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				をつけます。逆にモディファイヤが必ず押されていなければならない場合は付けません。<br>
				またモディファイヤが必ず離されていなければならない場合は &quot;</font><code><font face="ＭＳ Ｐゴシック">~</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				を付けます。たとえば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ Ｐゴシック">&nbsp;</font><font face="ＭＳ ゴシック">key *S-F9 = 
				&amp;WindowMinimize
				</font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">このように記述すると、</font><kbd><font face="ＭＳ Ｐゴシック">F9</font></kbd><font face="ＭＳ Ｐゴシック"> 
				又は  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">F9</font></kbd><font face="ＭＳ Ｐゴシック"> 
				でウィンドウを最小化することができますが、例えば、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">F9</font></kbd><font face="ＭＳ Ｐゴシック"> 
				ではできません。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">デフォルトでは、暗黙に </font> <code>
				<font face="ＭＳ Ｐゴシック">
				~C-~M-~S-*NL-*CL-*SL-*KL-*IL-~IC-*MAX-*MIN-*MMAX-*MMIN-*T-*TS-*TL-*TLS-*TR-*TRS-</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されていることになっていますが、<a href="#defaultModifier">変更</a>できます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">また、</font><kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				は必ず押されていてほしいがほかのモディファイヤはどうでもいいという場合は、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ Ｐゴシック">&nbsp;</font><font face="ＭＳ ゴシック">key S-*F9 = 
				&amp;WindowMinimize
				</font>
			  </p>

			  <p class="continue"><font face="ＭＳ Ｐゴシック">というように &quot;</font><code><font face="ＭＳ Ｐゴシック">*</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				をキーの直前に記述します。&quot;</font><code><font face="ＭＳ Ｐゴシック">~</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				についても同様です。</font></p>
			</div>

		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="inputModifier">
			入力されたキーと同じモディファイヤの指定</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
				より右側でのモディファイヤの指定の方法です。</font></p>

			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key *S-A = C-*S-B
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">例えばこのように記述した場合、</font><kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと、Windows へは  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと、Windows へは  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">つまり、</font><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
				の右側で  
				</font> <code><font face="ＭＳ Ｐゴシック">*</font></code><font face="ＭＳ Ｐゴシック"> 
				で指定されたモディファイヤは、キーボードで実際に入力したモディファイヤと同じになるように設定されます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">したがって、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と入れ替えたい場合は、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key *A = *B<br>
			  &nbsp;key *B = *A
			  </font>
			  </p>

			  <p class="continue"><font face="ＭＳ Ｐゴシック">となります。</font></p>
			</div>

		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="keyUpDown">キーを押す/離す</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の前にモディファイヤと同じように  
				</font> <code><font face="ＭＳ Ｐゴシック">D-</font></code><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <code><font face="ＭＳ Ｐゴシック">U-</font></code><font face="ＭＳ Ｐゴシック"> 
				を付けることができます。これは、それぞれキーの押すことと離すことに対応しています。デフォルトでは  
				</font> <code><font face="ＭＳ Ｐゴシック">*D-*U-</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されています。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key A = B C
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">という記述は、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key *U-*D-A = D-B U-B D-C U-C
			  </font>
			  </p>

			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				と同じであり、さらに次のものとも同じになります。キーリピートが起こった場合は、</font><code><font face="ＭＳ Ｐゴシック">~U-D-A</font></code><font face="ＭＳ Ｐゴシック"> 
				が何度も実行され、キーを離したときに  
				</font> <code><font face="ＭＳ Ｐゴシック">U-~D-A</font></code><font face="ＭＳ Ｐゴシック"> 
				が実行されます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key ~U-D-A = D-B U-B D-C<br>
			  &nbsp;key U-~D-A = U-C
			  </font>
			  </p>
			</div>

		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="keyRepeat">キーリピートした</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
				より左の  
				</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の前にモディファイヤと同じように  
				</font> <code><font face="ＭＳ Ｐゴシック">R-</font></code><font face="ＭＳ Ｐゴシック"> 
				を付けることができます。これは、キーリピートが発生したことを表します。デフォルトでは  
				</font> <code><font face="ＭＳ Ｐゴシック">*R-</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されています。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key A = B<br>
			  &nbsp;key R-A = C
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">という記述をすると、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押しつづけると、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">BCCCCCCCCCCCCCCCCCCCCC
			  </font>
			  </p>

			  <font face="ＭＳ Ｐゴシック">と入力されます。とてもややこしいのであまり使わないように、しましょう。
			</font>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="defaultModifier">
			デフォルトモディファイヤの変更</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">デフォルトでは、左側のキーには </font> <code>
				<font face="ＭＳ Ｐゴシック">
				~C-~M-~S-*NL-*CL-*SL-*KL-*IL-~IC-*MAX-*MIN-*MMAX-*MMIN-*T-*TS-*TL-*TLS-*TR-*TRS-*K0-*K1-*K2-*K3-</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されていますが、これを変更することができます。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key *IC- =
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				と記述すると、この文以降のデフォルトモディファイヤは  
				</font> <code><font face="ＭＳ Ｐゴシック">
				~C-~M-~S-*NL-*CL-*SL-*KL-*IL-*IC-*MAX-*MIN-*MMAX-*MMIN-*T-*TS-*TL-*TLS-*TR-*TRS-*K0-*K1-*K2-*K3-</font></code><font face="ＭＳ Ｐゴシック"> 
				となり 、ICの前の記号が ~ から * に変更され、IME非入力中から、IMEの状態はどちらでも良いことに変更されました。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">デフォルトモディファイヤの変更を複数行うときには、例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key L0-*IC-~C- =
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				のように、しなければなりません。以下のように指定するのは間違いです。最後のものしか有効になりません。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key L0- =<br>
			  &nbsp;key *IC- =<br>
			  &nbsp;key ~C- = # この行しか有効にならない<br>
			  </font>
			  </p>
			</div>
		  </dl>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="keymap">ii. キーマップ定義</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p><font face="ＭＳ Ｐゴシック">
			「のどか」には、キーマップという概念があります。キーマップにカスタマイズしたいキー情報を書き込んでゆき、ウィンドウごとにキーマップを使い分けます。キーマップを定義するには、以下のどれかの文を書いてからキーを設定します。</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">keymap <em>キーマップ名</em><br>
		  keymap2 <em>キーマップ名</em><br>
		  window <em>キーマップ名</em> <em>ウィンドウクラス名</em><br>
		  window <em>キーマップ名</em> ( <em>ウィンドウクラス名</em> &amp;&amp; <em>ウィンドウタイトル名</em> )<br>
		  window <em>キーマップ名</em> ( <em>ウィンドウクラス名</em> || <em>ウィンドウタイトル名</em> )</font></p>
		  
		  <p><font face="ＭＳ Ｐゴシック">例えば、メモ帳で </font> <kbd><font face="ＭＳ Ｐゴシック">
			Control</font></kbd><font face="ＭＳ Ｐゴシック"> + 
			</font> <kbd><font face="ＭＳ Ｐゴシック">Z</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を押すと最小化されるが、メモ帳以外のエディットコントロールで  
			</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
			+ 
			</font> <kbd><font face="ＭＳ Ｐゴシック">Z</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を押すと単なる  
			</font> <kbd><font face="ＭＳ Ｐゴシック">Z</font></kbd><font face="ＭＳ Ｐゴシック"> 
			キーと同じになるという指定がしたい場合は、</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">window EditControl /:Edit$/ : Global<br>
		  &nbsp;key C-Z = Z<br>
		  window Notepad /Notepad:Edit$/ : Global<br>
		  &nbsp;key C-Z = &amp;WindowMinimize </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述します。ここで </font> <code>
			<font face="ＭＳ Ｐゴシック">/Notepad:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
			はメモ帳の上にあるエディットコントロールの</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">を表しています。</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">は正規表現で記述します。</font><code><font face="ＭＳ Ｐゴシック">: 
			Global</font></code><font face="ＭＳ Ｐゴシック"> は</font><code><em><font face="ＭＳ Ｐゴシック">親キーマップ</font></em></code><font face="ＭＳ Ｐゴシック">を指定しています。</font></p>
		  
		  <dl>
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="windowClass">
			ウィンドウクラス/タイトル名</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">Windows 
				の全てのウィンドウは、何らかのウィンドウクラスに属しています。例えば、メモ帳のウィンドウクラス名は  
				</font> <code><font face="ＭＳ Ｐゴシック">Notepad</font></code><font face="ＭＳ Ｐゴシック"> 
				で、エディットコントロールのウィンドウクラス名は  
				</font> <code><font face="ＭＳ Ｐゴシック">Edit</font></code><font face="ＭＳ Ｐゴシック"> 
				です。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">
				「のどか」は、どのウィンドウでどのキーを押したらどんな動作をするか、ということを区別するために</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">と</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウタイトル名</font></em></code><font face="ＭＳ Ｐゴシック">を用いています。そのために、「のどか」ではウィンドウの重なりの状態を 
				&quot;</font><code><font face="ＭＳ Ｐゴシック">:</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				で繋げて表現します。例えば、メモ帳の上のエディットコントロールの</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">ならば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">C:\WINDOWS\system32\notepad.exe:Notepad:Edit
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と表現します。ただし、一番最初の</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">には 
				、そのアプリケーションのパス名を付けています。</font></p>
			  
			  <p><code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
				文には、この</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">と</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウタイトル名</font></em></code><font face="ＭＳ Ｐゴシック">を記述することができますが、</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">全てを書く必要はなく、正規表現で省略することができます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">例えば、</font><code><font face="ＭＳ Ｐゴシック">/:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				は全てのエディットコントロールの</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">を表しますし、</font><code><font face="ＭＳ Ｐゴシック">/:#32770.*:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				ならば、ダイアログボックス上にある全てのエディットコントロールの</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">を表します 
				(</font><code><font face="ＭＳ Ｐゴシック">#32770</font></code><font face="ＭＳ Ｐゴシック"> 
				はダイアログボックスのウィンドウクラス名)。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">個々のウィンドウの</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">と</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウタイトル名</font></em></code><font face="ＭＳ Ｐゴシック">を調べるには、タスクトレイメニュー</font><a href="MANUAL-ja.html#menu-i" class="menu-item"><font face="ＭＳ Ｐゴシック">調査(I)...</font></a><font face="ＭＳ Ｐゴシック">の「ウィンドウの調査」、または</font><code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック">
				</font> <a href="#function_WindowIdentify"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowIdentify</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を利用してください。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">と</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウタイトル名</font></em></code><font face="ＭＳ Ｐゴシック">の両方を記述する場合は、括弧で囲みその間を  
				</font> <code><font face="ＭＳ Ｐゴシック">&amp;&amp;</font></code><font face="ＭＳ Ｐゴシック"> 
				か  
				</font> <code><font face="ＭＳ Ｐゴシック">||</font></code><font face="ＭＳ Ｐゴシック"> 
				で区切ります。</font><code><font face="ＭＳ Ｐゴシック">&amp;&amp;</font></code><font face="ＭＳ Ｐゴシック"> 
				の場合は、両方にマッチするようなウィンドウを表し、</font><code><font face="ＭＳ Ｐゴシック">||</font></code><font face="ＭＳ Ｐゴシック"> 
				の場合はどちらか一方にマッチするようなウィンドウを表します。</font></p>
				<p><font face="ＭＳ Ｐゴシック">例えば、x86版のWordpadと、x64版のWordpadを区別するには次のような記述となります。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック"># wordpad.exe の x86, x64でキーバインドを変える。<br>
				<br>
				include &quot;109.nodoka&quot; # 109 キーボード設定<br>
				keymap Global<br>
				<br>
				# wordpad.exe以外では、non と表示させる。<br>
				key C-A = N O N<br>
				<br>
				# x86側のwordpad.exeでは、86 と表示させる。<br>
				window WORDPADx86 (/x86/ &amp;&amp; /wordpad\.exe/) : Global<br>
				key C-A = _8 _6<br>
				<br>
				# x64側のwordpad.exeでは、64 と表示させる。<br>
				window WORDPADx64 ( /Program Files\\\\Windows NT/ &amp;&amp; /wordpad\.exe/ 
				): Global<br>
				key C-A = _6 _4</font></p>
			  
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="regexp">正規表現について</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">と</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウタイトル名</font></em></code><font face="ＭＳ Ｐゴシック">には正規表現が使用できます。正規表現は  
				</font> <code><font face="ＭＳ Ｐゴシック">/.../</font></code><font face="ＭＳ Ｐゴシック"> 
				で囲むか、</font><code><font face="ＭＳ Ｐゴシック">\m@...@</font></code><font face="ＭＳ Ｐゴシック">で囲みます 
				(ただし</font><code><font face="ＭＳ Ｐゴシック">@</font></code><font face="ＭＳ Ｐゴシック">はどんな文字でも良いです)。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">正規表現エンジンには <a href="http://www.boost.org/libs/regex/doc/index.html" target="_top">
				Boost.Regex</a> を使用しています。このエンジンでは  
				<a target="_blank" href="http://www.kt.rim.or.jp/~kbk/regex/regex.html#PERL">

				Perl で使用できる正規表現</a>がほぼカバーされています。よく使いそうなものを挙げておきます。</font></p>
			  
			  <ul>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">|</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Alternation
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">*</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match 0 or more times
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">+</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match 1 or more times
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">?</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match 1 or 0 times
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">.</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match any character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">^</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match the beginning of the string
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">$</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match the end of the string
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\b</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a word boundary
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\B</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a non word boundary
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\w</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a word character (</font><code><font face="ＭＳ Ｐゴシック">[0-9a-z_]</font></code><font face="ＭＳ Ｐゴシック">)
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\W</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a non word character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\s</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a whitespace character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\S</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a non-whitespace character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\d</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a digit character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">\D</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Match a non-digit character
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">(</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				&quot;</font><code><font face="ＭＳ Ｐゴシック">)</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Grouping
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック">[</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				&quot;</font><code><font face="ＭＳ Ｐゴシック">]</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				Character class
			    </font>
			    <li><font face="ＭＳ Ｐゴシック">より詳しくは  
				<a target="_blank" href="http://www.boost.org/doc/libs/1_37_0/libs/regex/doc/html/index.html">
				Boost.Regex: Regular Expression Syntax</a>を見てください。
			   
				</font>
			  </ul>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="parentKeymap">親キーマップ</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				親キーマップとは、現在のキーマップに適切なキー割り当てが定義されていない場合に、キーを捜しに行くキーマップです。&quot;</font><code><font face="ＭＳ Ｐゴシック">:</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				の後ろに<em>親キーマップ名</em>を書きます。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap sub : Global<br>
			  &nbsp;key C-A = &amp;WindowMinimize<br>
			  window EditControl /:Edit$/ : sub<br>
			  &nbsp;key C-A = &amp;KeymapParent
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述した場合、エディットコントロールで  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、ウィンドウは最小化されます。つまり、</font><a href="#function_KeymapParent"><code><font face="ＭＳ Ｐゴシック">&amp;KeymapParent</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を記述することで 、親キーマップで定義されたキーを利用することができるのです。もし、<em>親キーマップ名</em>が指定されていなければ  
				</font> <a href="#function_Default"><code><font face="ＭＳ Ｐゴシック">
				&amp;Default</font></code></a><font face="ＭＳ Ｐゴシック"> 
				扱いとなり、ウィンドウへキーがそのまま入力されます。</font></p>
				<p class="continue"><font face="ＭＳ Ｐゴシック">
				&nbsp;　例えば、下記のように、VMware Workstation使用時には、すべてのキーが&amp;Defalutとなり、何もキー入れ替えされないことになります。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ Ｐゴシック">window VMWare /:VMUIFrame/<br>
　</font></p>
			  
			  <p class="continue"><font face="ＭＳ ゴシック">&nbsp;</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="defaultKey">デフォルトキー</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">keymap</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">keymap2</font></code><font face="ＭＳ Ｐゴシック"> 
				には、最後にキーを羅列することによってデフォルトキーを定義することができます。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">window EditControl /:Edit$/ : Global = A<br>
			  &nbsp;key *B = *C
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述すると、</font><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると  
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力したことになるが、</font><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				以外のキーを入力すると、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力したことになります。また、デフォルトキーを指定しなかった場合のデフォルトキーは、</font><code><font face="ＭＳ Ｐゴシック">keymap</font></code><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
				の場合は  
				</font> <a href="#function_KeymapParent"><code>
				<font face="ＭＳ Ｐゴシック">&amp;KeymapParent</font></code></a><font face="ＭＳ Ｐゴシック"> 
				で、</font><code><font face="ＭＳ Ｐゴシック">keymap2</font></code><font face="ＭＳ Ｐゴシック"> 
				の場合は  
				</font> <a href="#function_Undefined"><code>
				<font face="ＭＳ Ｐゴシック">&amp;Undefined</font></code></a><font face="ＭＳ Ｐゴシック"> 
				になります。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="keymap2">二段階キーマップ</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">keymap2</font></code><font face="ＭＳ Ｐゴシック"> 
				はデフォルトキーが  
				</font> <a href="#function_Undefined"><code>
				<font face="ＭＳ Ｐゴシック">&amp;Undefined</font></code></a><font face="ＭＳ Ｐゴシック"> 
				になって いるようなキーマップで、主に </font> <a href="#function_Prefix"><code>
				<font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を利用して 2 ストロークキーを記述する時に使用します。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="initialKeymap">初期キーマップ</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック"> 
				の一番初めの行には、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">window Global ( // || // ) = 
				&amp;OtherWindowClass
				</font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">という行が隠れていると考えて下さい。つまり、</font><code><font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック">で何もキーマップを指定せずに書き始めると、<em>キーマップ名</em> 
				</font> <code><font face="ＭＳ Ｐゴシック">Global</font></code><font face="ＭＳ Ｐゴシック"> 
				のキーマップに対するキー定義になるということです。そして、</font><code><font face="ＭＳ Ｐゴシック">Global</font></code><font face="ＭＳ Ｐゴシック"> 
				キーマップのデフォルトキーは  
				</font> <a href="#function_OtherWindowClass"><code>
				<font face="ＭＳ Ｐゴシック">&amp;OtherWindowClass</font></code></a><font face="ＭＳ Ｐゴシック"> 
				が設定されています。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="conflictKeymap">
			矛盾したキーマップの指定</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">同じキーマップに対する </font> <code>
				<font face="ＭＳ Ｐゴシック">keymap</font></code><font face="ＭＳ Ｐゴシック"> 
				や  
				</font> <code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
				や  
				</font> <code><font face="ＭＳ Ｐゴシック">keymap2</font></code><font face="ＭＳ Ｐゴシック"> 
				は何度でも指定できますが、矛盾する指定をしてはいけません。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap Amap : Global<br>
			  ...<br>
			  keymap Bmap : Amap<br>
			  ...<br>
			  keymap Amap : Global<br>
			  ...
			  </font>
			  </p>
			  
			  <font face="ＭＳ Ｐゴシック">という指定は問題ありませんが、
			  
			  </font>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap Amap : Global<br>
			  ...<br>
			  keymap Bmap : Amap<br>
			  ...<br>
			  keymap Amap : Bmap # 矛盾<br>
			  ...
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">という指定はしてはいけません。この場合、</font><code><font face="ＭＳ Ｐゴシック">keymap 
				Amap : Bmap</font></code><font face="ＭＳ Ｐゴシック"> のかわりに  
				</font> <code><font face="ＭＳ Ｐゴシック">keymap Amap : Global</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されたものとみなされます。エラーは出ません。</font></p>
			</div>
			
		    <dt class="h3"><a name="matchManyClasses"><code>
			<font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
			に複数該当する場合</font></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">window EditControl /:Edit$/ : Global<br>
			  &nbsp;key A = A space E D I T enter<br>
			  &nbsp;key B = B space E D I T enter<br>
			  window Notepad /:Notepad/ : Global<br>
			  &nbsp;key A = A space N O T E P A D enter<br>
			  &nbsp;key C = C space N O T E P A D enter
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				という記述をしたとします。ここで、「メモ帳」を立ち上げると、メモ帳の</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">は</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">C:\WINDOWS\system32\notepad.exe:Notepad:Edit
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">となっているので、</font><code><font face="ＭＳ Ｐゴシック">/:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <code><font face="ＭＳ Ｐゴシック">/:Notepad/</font></code><font face="ＭＳ Ｐゴシック"> 
				は両方共もメモ帳の</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">に該当します。この時、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、メモ帳には「</font><code><font face="ＭＳ Ｐゴシック">a notepad</font></code><font face="ＭＳ Ｐゴシック">」と表示されます。これは、重複する記述があれば、より下に書かれているものが有効になるからです。しかし、</font><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力した場合は、重複していないので、メモ帳には「</font><code><font face="ＭＳ Ｐゴシック">b 
				edit</font></code><font face="ＭＳ Ｐゴシック">」と表示されることになります。</font></p>
			  
			  <p><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力した場合に、内部で行われる処理は以下のようになります。</font></p>
			  
			  <ol>
			    <li><font face="ＭＳ Ｐゴシック">まず</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">は  
				</font> <code><font face="ＭＳ Ｐゴシック">/:Notepad/</font></code><font face="ＭＳ Ｐゴシック"> 
				に該当しますが、キー割り当てがないので、</font><code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
				のデフォルトキーである  
				</font> <code><font face="ＭＳ Ｐゴシック">&amp;KeymapParent</font></code><font face="ＭＳ Ｐゴシック"> 
				が採用されます。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;KeymapParent</font></code><font face="ＭＳ Ｐゴシック"> 
				は<em>親キーマップ</em>の参照なので、</font><code><font face="ＭＳ Ｐゴシック">Global</font></code><font face="ＭＳ Ｐゴシック"> 
				キーマップを参照します。
			     
				</font>
			    <li><font face="ＭＳ Ｐゴシック">そうすると、</font><code><font face="ＭＳ Ｐゴシック">Global</font></code><font face="ＭＳ Ｐゴシック"> 
				キーマップでも  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				の割り当てがないので、</font><code><font face="ＭＳ Ｐゴシック">Global</font></code><font face="ＭＳ Ｐゴシック"> 
				キーマップのデフォルトキーである、</font><code><font face="ＭＳ Ｐゴシック">&amp;OtherWindowClass</font></code><font face="ＭＳ Ｐゴシック"> 
				が採用されます。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;OtherWindowClass</font></code><font face="ＭＳ Ｐゴシック"> 
				が採用されると、まず、他に該当する</font><code><em><font face="ＭＳ Ｐゴシック">ウィンドウクラス名</font></em></code><font face="ＭＳ Ｐゴシック">がないかどうか探します。もしなければ、</font><code><font face="ＭＳ Ｐゴシック">&amp;Default</font></code><font face="ＭＳ Ｐゴシック"> 
				扱いとなります。この場合は  
				</font> <code><font face="ＭＳ Ｐゴシック">/:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				に該当します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">/:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				に該当したので、</font><code><font face="ＭＳ Ｐゴシック">/:Edit$/</font></code><font face="ＭＳ Ｐゴシック"> 
				の  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が採用されます。したがって、「b edit」と表示されることとなります。
			   
				</font>
			  </ol>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="perKeymapDefinition">
			キーマップが影響する定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">以下の単語で始まる定義は、キーマップ毎に定義できます。
			  </font>
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">key ...</font></code><font face="ＭＳ Ｐゴシック"> <a href="#key">
				キー割り当ての変更</a>
			    </font>
			    <li><code><font face="ＭＳ Ｐゴシック">event ...</font></code><font face="ＭＳ Ｐゴシック"> <a href="#event">
				イベント定義</a>
			    </font>
			    <li><code><font face="ＭＳ Ｐゴシック">mod ...</font></code><font face="ＭＳ Ｐゴシック"> <a href="#mod">
				モディファイヤキー割り当ての変更</a>
			  	</font>
			  </ul>
			  <font face="ＭＳ Ｐゴシック">以下の単語で始まる定義は、キーマップ毎に定義することはできません。
			  </font>
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">def ...</font></code><font face="ＭＳ Ｐゴシック"> <a href="#keyboard">
				キーボード定義</a>
			    </font>
			    <li><code><font face="ＭＳ Ｐゴシック">keyseq ...</font></code><font face="ＭＳ Ｐゴシック"> <a href="#keyseq">
				キーシーケンス定義</a>
			  	</font>
			  </ul>
			</div>
		  </dl>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="mod">iii. モディファイヤキー割り当ての変更</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;mod <em>モディファイヤキー名</em> = <em>キー名</em> …<br>
		  &nbsp;mod <em>モディファイヤキー名</em> += <em>キー名</em> …<br>
		  &nbsp;mod <em>モディファイヤキー名</em> -= <em>キー名</em> …<br>
		  </font>
		  </p>
		  
		  <p><font face="ＭＳ Ｐゴシック">最初の 3 つは、<em>キー名</em>で指定したキーをモディファイヤキーにしたり (</font><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック">) 
			追加したり (</font><code><font face="ＭＳ Ｐゴシック">+=</font></code><font face="ＭＳ Ｐゴシック">) 
			削除したり (</font><code><font face="ＭＳ Ｐゴシック">-=</font></code><font face="ＭＳ Ｐゴシック">) 
			します。各キーマップ毎に割り当てます。明示的に割り当てない場合は、親キーマップから引き継がれます。例えば、</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;mod shift += 無変換
		  </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">は、</font><kbd><font face="ＭＳ Ｐゴシック">無変換</font></kbd><font face="ＭＳ Ｐゴシック"> 
			キーを shift モディファイヤキーにします。従って、</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;key S-A = X
		  </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">という記述があった場合に、</font><kbd><font face="ＭＳ Ｐゴシック">無変換</font></kbd><font face="ＭＳ Ｐゴシック"> 
			+ 
			</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を押すと  
			</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を入力したことになります。正確には、</font><kbd><font face="ＭＳ Ｐゴシック">無変換押す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">X押す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">X離す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">無変換離す</font></kbd><font face="ＭＳ Ｐゴシック"> 
			というキーが Windows へ入力されます。これでは都合が悪いということは多いと思われるので、</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;key *無変換 = *LShift </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">として </font> <kbd>
			<font face="ＭＳ Ｐゴシック">無変換</font></kbd><font face="ＭＳ Ｐゴシック"> キーを押すと  
			</font> <kbd><font face="ＭＳ Ｐゴシック">LShift</font></kbd><font face="ＭＳ Ｐゴシック"> 
			が入力されるように割り当てます。そうすれば、Windows へは  
			</font> <kbd><font face="ＭＳ Ｐゴシック">LShift押す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">LShift離す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">X押す</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">X離す</font></kbd><font face="ＭＳ Ｐゴシック"> 
			というキーが入力されます。</font></p>
		  
		  <p><font face="ＭＳ Ｐゴシック"><em>モディファイヤキー名</em>には、</font><code><font face="ＭＳ Ｐゴシック">shift(S)</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">alt</font></code><font face="ＭＳ Ｐゴシック"> 
			(</font><code><font face="ＭＳ Ｐゴシック">meta</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">menu, A, M</font></code><font face="ＭＳ Ｐゴシック">), 
			</font> <code><font face="ＭＳ Ｐゴシック">control</font></code><font face="ＭＳ Ｐゴシック"> 
			(</font><code><font face="ＭＳ Ｐゴシック">ctrl, C</font></code><font face="ＭＳ Ｐゴシック">), 
			</font> <code><font face="ＭＳ Ｐゴシック">windows</font></code><font face="ＭＳ Ｐゴシック"> 
			(</font><code><font face="ＭＳ Ｐゴシック">win, W</font></code><font face="ＭＳ Ｐゴシック">), 
			</font> <code><font face="ＭＳ Ｐゴシック">mod0</font></code><font face="ＭＳ Ｐゴシック">〜</font><code><font face="ＭＳ Ｐゴシック">mod9(M0〜M9)</font></code><font face="ＭＳ Ｐゴシック">が記述できます。括弧の中の名前も使用できます。</font></p>
		  
		  <p><a name="mod0〜mod9(M0〜M9)"><code><font face="ＭＳ Ｐゴシック">mod0</font></code><font face="ＭＳ Ｐゴシック">〜</font><code><font face="ＭＳ Ｐゴシック">mod9(M0〜M9)</font></code></a><font face="ＭＳ Ｐゴシック"> 
			は「のどか」の中でのみ有効なモディファイヤで、例えば以下のように使用します。</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;mod M0 = Up<br>
		  &nbsp;key M0-Left = Left Up
		  </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">このように割り当てると、</font><kbd><font face="ＭＳ Ｐゴシック">↑</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を押しながら  
			</font> <kbd><font face="ＭＳ Ｐゴシック">←</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を押すとカーソルが左斜め上へ移動することになります。</font></p>
		  
		  <dl>
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="trueModifier">
			真のモディファイヤ</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">モディファイヤにしたいキーの前に &quot;</font><code><font face="ＭＳ Ｐゴシック">!</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				を付けると、<em>真のモディファイヤ</em>になります。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift += !無変換<br>
			  &nbsp;key 無変換 = Y<br>
			  &nbsp;key S-A = X
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述した場合、</font><kbd><font face="ＭＳ Ｐゴシック">無変換</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと  
				</font> <kbd><font face="ＭＳ Ｐゴシック">X押す</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">X離す</font></kbd><font face="ＭＳ Ｐゴシック"> 
				というキーが Windows へ入力されます。Windows からは、</font><kbd><font face="ＭＳ Ｐゴシック">無変換</font></kbd><font face="ＭＳ Ｐゴシック"> 
				キーが押されたということは分かりませんし、</font><kbd><font face="ＭＳ Ｐゴシック">Y</font></kbd><font face="ＭＳ Ｐゴシック"> 
				も Windows へ入力されることはありません。つまり、真のモディファイヤに定義されているキーや  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				などは実行されません。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">以下のような行を記述すると、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod !<em>モディファイヤキー名</em>
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">その<em>モディファイヤキー名</em>に割り当てられているモディファイヤを全て<em>真のモディファイヤ</em>に変更します。</font></p>
				<p class="continue"><span class="auto-style1">
				注意：上記のような設定の場合、Shiftキーと無変換キーを押しても、Shiftキーしか認識できません。他のモディファイヤーでも同様となります。</span></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="oneShotModifier">One 
			Shot モディファイヤ と SandS</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">モディファイヤにしたいキーの前に &quot;</font><code><font face="ＭＳ Ｐゴシック">!!</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				を付けると、<em>One Shot モディファイヤ</em>になります。たとえば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift = !!LShift<br>
			  &nbsp;key S-A = X<br>
			  &nbsp;key S-LShift = Y </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述した場合、</font><kbd><font face="ＭＳ Ｐゴシック">LShift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押してすぐ離した場合は、Windows へは、</font><kbd><font face="ＭＳ Ｐゴシック">Y</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されますが、</font><kbd><font face="ＭＳ Ｐゴシック">LShift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力した場合は、</font><kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
				のみが Windows へ入力されます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">以下のような行を記述すると、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod !!<em>モディファイヤキー名</em>
			  </font>
			  </p>
			  
			  <p class="continue" style="text-align: left">
				<font face="ＭＳ Ｐゴシック">その<em>モディファイヤキー名</em>に割り当てられているモディファイヤを全て<em>One 
				Shot モディファイヤ</em>に変更します。<br>
　</font></p>
			  
			  <p class="continue" style="text-align: left">
				<font face="ＭＳ Ｐゴシック">一般的には SandS (Space and 
				Shift)と呼ばれているスペースキーをシフトキーとして使用するには、次の記述を実施してください。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift += !!Space</font></p>
			  
			  <p class="continue" style="text-align: left">
				<font face="ＭＳ Ｐゴシック">キーリピート有りにしたい場合には、次のOne 
				Shot(キーリピート有)の項を参考にすると、下記となります。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift += !!!Space</font></p>
			  
			  <p class="continue" style="text-align: left">
				<font face="ＭＳ Ｐゴシック">シフトを押したけれども、取りやめた時にスペースが入ることを防ぐには下記となります。(
				<a target="_blank" href="http://jisx6004.client.jp/mayu2.html">
				http://jisx6004.client.jp/mayu2.html</a> を参考にしました。)</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift += !!Space<br>
				&nbsp;key R-*Space = &amp;Ignore</font></p>
			</div>
			<dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="oneShotRepeatableModifier">
			One Shot (キーリピート有)</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック"><em>One Shot モディファイヤ</em>は通常キーリピートしませんが、&quot;</font><code><font face="ＭＳ Ｐゴシック">!!!</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				を付けると、キーリピートをするようになります。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod shift = !!!Up</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">とすると、</font><kbd><font face="ＭＳ Ｐゴシック">↑</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押しながら何か別のキー (例えば  
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック">) 
				を押すと  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と同じことになりますが、</font><kbd><font face="ＭＳ Ｐゴシック">↑</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押しっぱなしにすると  
				</font> <kbd><font face="ＭＳ Ｐゴシック">↑</font></kbd><font face="ＭＳ Ｐゴシック"> 
				がキーリピートして、カーソルが上へ動くということになります。</font></p>

			  <p><font face="ＭＳ Ｐゴシック">キーリピートが開始するまでの時間を</font><a href="#def_option_delay_of_oneShotRepeatableModifier"><font face="ＭＳ Ｐゴシック">オプション 
				(</font><code><font face="ＭＳ Ｐゴシック">delay-of !!!</font></code><font face="ＭＳ Ｐゴシック">)</font></a><font face="ＭＳ Ｐゴシック"> 
				で設定できます。</font></p>
			  
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="lock">ロックキー</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				「のどか」には、「のどか」の中でのみ有効なロックキーが存在します。これらはキーのモディファイヤとして  
				</font> <code><font face="ＭＳ Ｐゴシック" color="#000000">L0-</font></code><font face="ＭＳ Ｐゴシック">〜L9及びLA〜</font><code><font face="ＭＳ Ｐゴシック" color="#000000">LF-</font></code><font face="ＭＳ Ｐゴシック"> 
				を書くことができ、</font><a href="#function_Toggle"><code><font face="ＭＳ Ｐゴシック">&amp;Toggle</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を使うことによりトグル あるいは、ロックかアンロックの状態に変更させることができます。例えば、
			  
			  </font>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key ひらがな = &amp;Toggle(L0)<br>
			  &nbsp;key L0-A = B
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述すると、</font><kbd><font face="ＭＳ Ｐゴシック">ひらがな</font></kbd><font face="ＭＳ Ｐゴシック"> 
				キーがトグル状態になっているときに  
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと Windows へは  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font></p>
			</div>
		  </dl>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="keyseq" class="a2">iv. 
		キーシーケンス定義</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p class="sample">
		  <font face="ＭＳ ゴシック">keyseq $<em>キーシーケンス名</em> = <em>KEY</em> や <em>
			FUNCTION</em> …
		  </font>
		  </p>
		  
		  <p><code><font face="ＭＳ Ｐゴシック">keyseq</font></code><font face="ＭＳ Ｐゴシック"> 
			を使うことで、一連のキー入力に対して名前を付けることができます。例えば、</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">keyseq $Right2Times = Right Right<br>
		  &nbsp;key C-F = $Right2Times
		  </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">とすると、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
			+ 
			</font> <kbd><font face="ＭＳ Ｐゴシック">F</font></kbd><font face="ＭＳ Ｐゴシック"> 
			で右に二つカーソルを進めることができます。</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;key C-F = Right Right
		  </font>
		  </p>
		  
		  <p class="continue"><font face="ＭＳ Ｐゴシック">は、</font><code><font face="ＭＳ Ｐゴシック">$Right2Times</font></code><font face="ＭＳ Ｐゴシック"> 
			という名前が定義されないこと以外は、先の例と同じになります。<br>
			<br>
			$ToggleIME, $WindowClassName, $WindowTitleName, $NodokaVal 
			などが、のどかのプログラム内部あるいは、<a href="./104.nodoka.txt">104.nodoka</a>、<a href="./109.nodoka.txt">109.nodoka</a>、<a href="./emacsedit.nodoka.txt">emacsedit.nodoka</a> 
			などで定義されているので、include している設定ファイルの中で、ユニークな使われていないキーシーケンス名を用いる必要があります。</font></p>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="event" class="a2">v. 
		イベント定義</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p class="sample">
		  <font face="ＭＳ ゴシック">&nbsp;event <em>EVENT</em> = <em>KEY</em> や <em>
			FUNCTION</em> …
		  </font>
		  </p>
		  
		  <p><font face="ＭＳ Ｐゴシック">あるイベントが起こったときに </font> <code><em>
			<font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> や  
			</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
			を実行します。イベントはキーマップ毎に定義され、親キーマップにイベントが定義されていてもそれは無視されます。</font></p>
		  
		  <p><code><em><font face="ＭＳ Ｐゴシック">EVENT</font></em></code><font face="ＭＳ Ｐゴシック"> 
			には以下のものが指定できます。</font></p>
		  
		  <ul>
		    <li><code><font face="ＭＳ Ｐゴシック">prefixed</font></code><font face="ＭＳ Ｐゴシック">: 
			</font> <a href="#function_Prefix"><code><font face="ＭＳ Ｐゴシック">
			&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> によってキーマップが指定された時。
		     
			</font>
		    <li><code><font face="ＭＳ Ｐゴシック">before-key-down</font></code><font face="ＭＳ Ｐゴシック">: 
			キーが押された時。
		     
			</font>
		    <li><code><font face="ＭＳ Ｐゴシック">after-key-up</font></code><font face="ＭＳ Ｐゴシック">: 
			キーが離された後。
		   
			</font>
		  </ul>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="keyboard">vi. キーボード定義</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p><font face="ＭＳ Ｐゴシック">基本となるキーボード定義は </font> <a href="./109.nodoka.txt"><code>
			<font face="ＭＳ Ｐゴシック">109.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> 
			又は  
			</font> <a href="./104.nodoka.txt"><code>
			<font face="ＭＳ Ｐゴシック">104.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> 
			に書かれています。<a href="keyboard.html#キーボード配列定義">図示したものは、こちら。</a></font></p>
		  
		  <dl>
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_key">キー定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">キーボードの物理的なキーを定義します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def key <em>キー名</em>… = <em>スキャンコード</em>…
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">キーが発生する</font><code><em><font face="ＭＳ Ｐゴシック">スキャンコード</font></em></code><font face="ＭＳ Ｐゴシック">を記述していきます。</font><code><em><font face="ＭＳ Ｐゴシック">スキャンコード</font></em></code><font face="ＭＳ Ｐゴシック">は数字で書き、</font><code><font face="ＭＳ Ｐゴシック">E0-</font></code><font face="ＭＳ Ｐゴシック"> 
				や  
				</font> <code><font face="ＭＳ Ｐゴシック">E1-</font></code><font face="ＭＳ Ｐゴシック"> 
				という拡張キーフラグをつけることができます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def key Pause = E1-0x1d 0x45
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">このように一連の<em>スキャンコード</em>を発生させるキーにはスキャンコードを書き並べます。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_mod">モディファイヤ定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">キーボードの物理的なモディファイヤキーを定義します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def mod <em>モディファイヤ名</em> = <em>キー名</em>…
			  </font>
			  </p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">モディファイヤ名</font></em></code><font face="ＭＳ Ｐゴシック">には、</font><code><font face="ＭＳ Ｐゴシック">shift 
				(S)</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">alt</font></code><font face="ＭＳ Ｐゴシック"> 
				(</font><code><font face="ＭＳ Ｐゴシック">meta</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">menu, A, M</font></code><font face="ＭＳ Ｐゴシック">), 
				</font> <code><font face="ＭＳ Ｐゴシック">control</font></code><font face="ＭＳ Ｐゴシック"> 
				(</font><code><font face="ＭＳ Ｐゴシック">ctrl, C</font></code><font face="ＭＳ Ｐゴシック">), 
				</font> <code><font face="ＭＳ Ｐゴシック">windows</font></code><font face="ＭＳ Ｐゴシック"> 
				(</font><code><font face="ＭＳ Ｐゴシック">win, W</font></code><font face="ＭＳ Ｐゴシック">)が記述できます。括弧の中の名前も使用できます。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_sync">同期定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">&amp;Sync</font></code><font face="ＭＳ Ｐゴシック"> 
				に使用する</font><code><em><font face="ＭＳ Ｐゴシック">スキャンコード</font></em></code><font face="ＭＳ Ｐゴシック">を定義します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def sync = <em>スキャンコード</em>…
			  </font>
			  </p>
			  
			  <p><code><font face="ＭＳ Ｐゴシック">&amp;Sync</font></code><font face="ＭＳ Ｐゴシック"> 
				が実行されるとき、「のどか」はこの</font><code><em><font face="ＭＳ Ｐゴシック">スキャンコード</font></em></code><font face="ＭＳ Ｐゴシック">を 
				Windows 
				に送ります。そして、各ウィンドウがこのキーが入力されたことを「のどか」へ連絡してくるまで処理を中断します。このようにして同期をとるので、この</font><code><em><font face="ＭＳ Ｐゴシック">スキャンコード</font></em></code><font face="ＭＳ Ｐゴシック">が不正に設定されていると、同期がとれず「のどか」が 
				5 秒ほど固まります (つまり 5 秒ほど何も入力できなくなります)。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_alias">別名定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">キーの別名を定義します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def alias <em>別名</em> = <em>キー名</em>
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">別名が既存のキー名と同じだった場合は、別名のほうが優先されます。</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_subst">代用定義</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">あるキーを別のキーとして代用します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def subst <em>KEY</em> = <em>KEY</em> や <em>
				キーシーケンス</em> …
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">
				キーが入力されると、まずこの代用定義によって入力されたキーが置き換えられます。その後、<a href="#key">キー割り当ての変更</a>に従って変換されます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def subst A = B<br>
			  &nbsp;key B = C<br>
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">上記の例では、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、まず代用定義で  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されたことになって、</font><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力された場合は  
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が最終的に Windows へ入力されるので、結局  
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと  
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が押されたことになります。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">代用定義は、キーマップでキーが変更されるより前に実行されます。例えば、109 
				キーボード上で 104 キーボードや Dvorak のエミュレートをしたいときに使用します。</font></p>
			  
			  <p><code><font face="ＭＳ Ｐゴシック">=</font></code><font face="ＭＳ Ｐゴシック"> 
				の左右は<a href="#key">キー割り当ての変更</a>のものと同じものが指定でき意味も同じになりますが、右側は先頭が  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				ではなく  
				</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				でなければならず、先頭の  
				</font> <code><em><font face="ＭＳ Ｐゴシック">KEY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				しか意味を持ちません。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">以下色々な例。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def subst A = C-B<br>
			  &nbsp;key *B = S-*C<br>
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">上記の例では </font> <kbd>
				<font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、最終的に  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が Windows へ出力されます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def subst A = B C D $Hoge &amp;Toggle(Lock0)<br>
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">上記の例では </font> <kbd>
				<font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、</font><kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が Windows へ出力されます。</font><code><font face="ＭＳ Ｐゴシック">C D $Hoge 
				&amp;Toggle(Lock0)</font></code><font face="ＭＳ Ｐゴシック"> は無視されます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keyseq $COLON = ~S-*Colon<br>
			  def subst S-*Semicolon = $COLON<br>
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">上記の例では </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> + 
				</font> <kbd><font face="ＭＳ Ｐゴシック">;</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、</font><kbd><font face="ＭＳ Ｐゴシック">:</font></kbd><font face="ＭＳ Ｐゴシック"> 
				になり、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">;</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">:</font></kbd><font face="ＭＳ Ｐゴシック"> 
				になります。</font></p>
			</div>

		    <dt class="h3"><a name="def_option_KL"><font face="ＭＳ Ｐゴシック">オプション 
			カナロック(</font><code><font face="ＭＳ Ｐゴシック">KL-</font></code><font face="ＭＳ Ｐゴシック">)</font></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">ローマ字かな変換入力では無い かな直接入力の状態であるカナロック </font> <code>
				<font face="ＭＳ Ｐゴシック">KL-</font></code><font face="ＭＳ Ｐゴシック"> 
				を正しく 取得するように します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option KL- = enable </font>
			  </p>

			  <p><font face="ＭＳ Ｐゴシック">このオプションを設定しない場合、カナロックの状態は正しく取得できません。</font></p>

			  <p><font face="ＭＳ Ｐゴシック">109 キーボードでは </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Alt</font></kbd><font face="ＭＳ Ｐゴシック"> + 
				</font> <kbd><font face="ＭＳ Ｐゴシック">ひらがな</font></kbd><font face="ＭＳ Ｐゴシック"> 
				でカナロックとなります。104キーボードでは、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">CapsLock</font></kbd><font face="ＭＳ Ｐゴシック"> 
				でカナロックとなります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">例えば、カナロック時に、&quot;a&quot;キーを押すと通常、&quot;ち&quot; 
				が入力されますが、&quot;こ&quot; が入力されるようにするには、次のように記述します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">key IL-*IC-KL-A = <a href="#function_SendText">
				&amp;SendText</a>(&quot;こ&quot;)</font></p>

			  <p><font face="ＭＳ Ｐゴシック">かな入力時には、&quot;こ&quot;が、ローマ字入力時には&quot;あ&quot;が入力されるようになります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				もし、ローマ字かな変換入力モードと、かな直接入力モードを 他のキーで切り替えたい場合には、<a href="#function_VK">&amp;VK</a>(0x15)を 
				お使いください。<br>
				　下記では、Shift-F5キーで、ローマ字かな変換入力モードと、かな直接入力モードを切り替えます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">key S-F5 = &amp;VK(0x15) </font>
			  </p>

			  <p><font face="ＭＳ Ｐゴシック">
				また、半角カタカナや、全角英数、全角ひらがな、全角カタカナなどの入力モードに切り替えたい場合には、<a href="#function_SetImeConvStatus">&amp;SetImeConvStatus()</a>をお使いください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">なお、カナロックおよび &amp;VK(0x15)について、IME 2007, IME 
				2003, IME 2002&nbsp; にて動作確認出来ていますが、環境によっては、うまく動作しません。</font></p>
			  
			</div>
		    </dd>
			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_delay_of_oneShotRepeatableModifier">オプション </a>
			キーリピートが始まるまでの時間指定</font><a name="def_option_delay_of_oneShotRepeatableModifier"><font face="ＭＳ Ｐゴシック"> 
			(</font><code><font face="ＭＳ Ｐゴシック">delay-of !!!</font></code><font face="ＭＳ Ｐゴシック">)</font></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><a href="#oneShotRepeatableModifier"><font face="ＭＳ Ｐゴシック">
				キーリピート有 One Shot (</font><code><font face="ＭＳ Ｐゴシック">!!!</font></code><font face="ＭＳ Ｐゴシック">)</font></a><font face="ＭＳ Ｐゴシック"> 
				のキーリピートが始まるまでの時間を指定します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option delay-of !!! = <em>DELAY</em>
			  </font>
			  </p>

			  <p><font face="ＭＳ Ｐゴシック">最初の </font> <code><em>
				<font face="ＭＳ Ｐゴシック">DELAY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				回のキーリピートを無視するように、します。</font></p>

			  <p><font face="ＭＳ Ｐゴシック">デフォルトでは </font> <code><em>
				<font face="ＭＳ Ｐゴシック">DELAY</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は 0 です。</font></p>
			</div>
		    </dd>

		    <dt class="h3"><a name="def_option_ts4nodoka"><font face="ＭＳ Ｐゴシック">
			オプション タッチパッドサポート(</font><code><font face="ＭＳ Ｐゴシック">sts4nodoka, 
			cts4nodoka</font></code><font face="ＭＳ Ｐゴシック">, ats4nodoka)</font></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				■ ThumbSense 対応 (AlpsおよびSynapticsのタッチパッドはx86/x64環境対応ですが、Cirque 
				GlidePointは、x86環境のみ対応です。ただし何れも実環境がなく、ほとんどテストできていません。)</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				キーボードのホームポジションを維持したまま、タッチパッドと併用することで、マウスの操作を実現する 
				ThumbSense(サムセンス)をオプション扱いですが、サポートしています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">もともと、「窓使いの憂鬱」の Sourceforge.net 
				で公開されていたソースコードを取り込んで、実現しています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">ちなみに 
				<a target="_blank" href="http://www.sonycsl.co.jp/person/rekimoto/tsense/soft/indexj.html">
				ThumbSense(サムセンス)のオリジナル紹介ページはこちら。</a> </font></p>
				<p><font face="ＭＳ Ｐゴシック">具体的には、設定ファイルにおいて、モディファイヤ </font> <code>
				<font face="ＭＳ Ｐゴシック">T-, TS-</font></code><font face="ＭＳ Ｐゴシック"> 
				のサポートを有効にし 
				、たとえば、タッチパッドに指を置いたまま、Jキーで、左ボタンクリック。Kキーで、右ボタンクリック。などが利用可能です。<br>
				　また、タッチパッドの領域を左右二つに割って、後述するように、2個のモディファイヤキーとしても利用可能です。</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック"> 別途 下記に示すように、DLLファイル(</font><code><font face="ＭＳ Ｐゴシック">sts4nodoka.dll/sts4nodoka64.dll</font></code><font face="ＭＳ Ｐゴシック">, </font>
				<code><font face="ＭＳ Ｐゴシック">cts4nodoka.dll, ats4nodoka.dll/ats4nodoka64.dll</font></code><font face="ＭＳ Ｐゴシック">)が必要です。インストール先フォルダ 
				（通常 32bit OSの場合 C:\Program Files\nodoka )の 
				ts4nodokaフォルダにコピーされているので、</font><code><font face="ＭＳ Ｐゴシック">nodoka.exe</font></code><font face="ＭＳ Ｐゴシック"> 
				と同じフォルダに コピーしてください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">サンプルの設定ファイル  
				<a target="_self" href="./thumbsense.nodoka.txt">
				thumbsense.nodoka</a> が 
				ts4nodokaフォルダにあるので、必要であれば、DLLファイル同様にコピーして、下記 def 
				option行の次の行で、include &quot;thumbsense.nodoka&quot; されると良いでしょう。
				</font></p>
				<p><font face="ＭＳ Ｐゴシック">なお、実際に Synaptics あるいは 
				GlidePointのドライバが、インストールされていないと、エラーとなります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">また、作者の環境では、sts4nodoka.dll/sts4nodoka64.dll, 
				ats4nodoka.dll しか動作確認ができていません。cts4nodoka.dll,ats4nodoka64.dll 
				の動作が確認できた方がいらしたら、ご連絡いただければ幸いです。</font></p>
				<p>　</p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Synaptics のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">sts4nodoka.dll(x64環境では 
			  sts4nodoka64.dll)</font></code><font face="ＭＳ Ｐゴシック"> 
				を、お使いください。その場合 </font> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック">ファイルにて、次のように記述してください。</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option sts4nodoka = enable
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Cirque GlidePoint のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">cts4nodoka.dll 
				</font><font face="ＭＳ Ｐゴシック" color="#000000">を、お使いください。その場合 
				</font>
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font><font face="ＭＳ Ｐゴシック" color="#000000">ファイルにて、次のように記述してください。</font></code></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option cts4nodoka = enable
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Alps のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">ats4nodoka.dll(x64環境では 
				ats4nodoka64.dll)</font><font face="ＭＳ Ｐゴシック" color="#000000">を、お使いください。その場合 
				</font>
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font><font face="ＭＳ Ｐゴシック" color="#000000">ファイルにて、次のように記述してください。</font></code></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option ats4nodoka = enable
			  </font>
			  </p>
			  
			  <p>　</p>
				<p><font face="ＭＳ Ｐゴシック">
				<a href="./thumbsense.nodoka.txt">thumbsense.nodoka</a> 
				で定義されている機能は以下の通りです。</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック"># F,J,Space を左ボタンのクリックに割り当てる。<br>
				key TS-*F TS-*J TS-*Space = &amp;VK(LButton)<br>
				# クリックがリピートされるのを防ぐ<br>
				key D-R-TS-*F D-R-TS-*J D-R-TS-*Space = &amp;Ignore<br>
				<br>
				# D,K を右ボタンのクリックに割り当てる。<br>
				key TS-*D TS-*K = &amp;VK(RButton)<br>
				# クリックがリピートされるのを防ぐ<br>
				key D-R-TS-*D D-R-TS-*K = &amp;Ignore<br>
				<br>
				# V を左ボタンのダブルクリックに割り当てる。<br>
				key D-T-*V = &amp;VK(LButton) &amp;Wait(10) &amp;VK(LButton)<br>
				# クリックがリピートされるのを防ぎ、キー離したときは無視する。<br>
				key D-R-T-*V U-T-*V = &amp;Ignore<br>
				<br>
				# G を第4ボタンのクリックに割り当てる。<br>
				key TS-*G = &amp;VK(XButton1)<br>
				# クリックがリピートされるのを防ぐ<br>
				key D-R-TS-*G = &amp;Ignore<br>
				<br>
				# H を第5ボタンのクリックに割り当てる。<br>
				key TS-*H = &amp;VK(XButton2)<br>
				# クリックがリピートされるのを防ぐ<br>
				key D-R-TS-*H = &amp;Ignore<br>
				<br>
				# S,L を押しながらの上下方向ドラッグをホイール回転にする。<br>
				key D-TS-*S D-TS-*L = &amp;MouseHook(Wheel, -5)<br>
				# リピートは無視。<br>
				key D-R-TS-*S D-R-TS-*L = &amp;Ignore<br>
				# キーを離したら解除する。<br>
				key U-TS-*S U-TS-*L = &amp;MouseHook(None, 0)<br>
				<br>
				# A を押しながらドラッグするとアクティブウィンドウが移動する。<br>
				key D-TS-*A = &amp;MouseHook(WindowMove, 1)<br>
				# リピートは無視。<br>
				key D-R-TS-*A = &amp;Ignore<br>
				# キーを離したら解除する。<br>
				key U-TS-*A = &amp;MouseHook(None, 0)<br>
				<br>
				# R でウィンドウの最大化/解除をトグルする。<br>
				key T-R = &amp;WindowMaximize<br>
				<br>
				# W,B でウィンドウを閉じる。<br>
				key T-W T-B = &amp;WindowClose<br>
				<br>
				# M で My Document を開く。<br>
				key T-M = &amp;ShellExecute(&quot;open&quot;, &quot;C:\\WINDOWS\\explorer.exe&quot;, 
				&quot;::{450D8FBA-AD25-11D0-98A8-0800361B1103}&quot;,, ShowNormal)<br>
				<br>
				# O で Outlook Express を起動する。<br>
				key T-O = &amp;ShellExecute(&quot;open&quot;, &quot;C:\\Program Files\\Outlook 
				Express\\msimn.exe&quot;,,, ShowNormal)<br>
				<br>
				# I で Internet Explorer を起動する。<br>
				key T-I = &amp;ShellExecute(&quot;open&quot;, &quot;C:\\Program Files\\Internet 
				Explorer\\iexplore.exe&quot;,,, ShowNormal)<br>
				<br>
				# P でコマンドプロンプトを起動する。<br>
				key T-P = &amp;ShellExecute(&quot;open&quot;, &quot;C:\\WINDOWS\\system32\\cmd.exe&quot;,,, 
				ShowNormal)<br>
　</font></p>
			  <p>　</p>
				<p><font face="ＭＳ Ｐゴシック">
				■ タッチパッド左右モディファイヤー化</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				タッチパッドの領域を、左右に割って、認識することで、2個のモディファイヤーキーとして利用可能です。<br>
				　左右判定の境界値を、CenterVal に設定します。任意の値が使用可能なので、お使いの環境に合わせて、変更してください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">ログウィンドウに、 touchpad: Z:1 X:3439 Y:3108<br>
				　と表示されている場合、一番真ん中の値　3439が、X座標の値です。<br>
				　Z:は、押したか、押していないかを1/0で示しています。また Y:の値は実際には評価に用いていません。<br>
				<br>
				　以下の制限事項があります。<br>
				　・GlidePointのタッチパッドは、テスト出来ていませんので挙動は不明です。<br>
				　・左右同時押しの認識は、Alpsのタッチパッドでは出来ません。<br>
				　・Synapticsの場合には、左右同時に押した場合、片方を離したときに、もう片方が押されたように認識します。<br>
				　・タッチパッドが押されたままという認識になることがあります。<br>
				　・タッチパッドの機能を生かしたままとなるので、ダブルタップすると、マウス左クリックするような機能が有効だと使いにくいです。<br>
　</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Synaptics のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">sts4nodoka.dll</font></code><font face="ＭＳ Ｐゴシック"><code><font face="ＭＳ Ｐゴシック">(x64環境では 
			  sts4nodoka64.dll)</font></code> を、お使いください。その場合 </font> <code> 
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック">ファイルにて、次のように記述してください。</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option sts4nodoka = enable<br>
				def option CenterVal = 3200
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Cirque GlidePoint のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">cts4nodoka.dll 
				</font><font face="ＭＳ Ｐゴシック" color="#000000">を、お使いください。その場合 
				</font>
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font><font face="ＭＳ Ｐゴシック" color="#000000">ファイルにて、次のように記述してください。</font></code></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option cts4nodoka = enable<br>
				def option CenterVal = 500
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">Alps のタッチパッドを使用される場合は、</font><code><font face="ＭＳ Ｐゴシック">ats4nodoka.dll<code><font face="ＭＳ Ｐゴシック">(x64環境では 
			  ats4nodoka64.dll)</font></code> 
				</font><font face="ＭＳ Ｐゴシック" color="#000000">を、お使いください。その場合 
				</font>
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font><font face="ＭＳ Ｐゴシック" color="#000000">ファイルにて、次のように記述してください。</font></code></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option ats4nodoka = enable<br>
				def option CenterVal = 500</font></p>
			  
			  <p>　</p>
				<p><code><font face="ＭＳ Ｐゴシック" color="#000000">モディファイヤーとして、TL-, 
				TLS-, TR-, TRS- が使用可能です。例えば下記のように記述します。</font></code></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">key TR-D = S-D # タッチパッド右側を押したまま Dキーを押すと D 
				が入力される。<br>
				key TRS-F = S-F # タッチパッド右側を押して離したあとで Fキーを押すと F が入力される。<br>
				<br>
				key TL-J = S-J # タッチパッド左側を押したまま Jキーを押すと J が入力される。<br>
				key TLS-K = S-K # タッチパッド左側を押して離したあとで Kキーを押すと K が入力される。
			  </font>
			  </p>
			  
			</div>
		    </dd>
			<dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="def_option_gamepad">
			オプション ゲームパッドサポート (実験実装)</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">プラグイン gamepad.dll 
				を用いて、ゲームパッドからの入力をキーボードやマウス操作にバインドします。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option gamepad = <em>enable</em> 10000 
				5000 2500 40 3 50 0xffff 0xffff 0xffff</font></p>

			  <p><font face="ＭＳ Ｐゴシック">引数は、enable, 
				ゲームパッドのアナログスティックの最大値、閾値、デッドゾーン値、リピートまでの最初の遅延量、繰り返しの遅延量、入力ループのWait[ms]、スティックやトリガー、ハットキー、ボタンのリピートフラグ(abit, 
				bbit, cbit の各1bit、1でリピート有り、LSB)です。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				上記の例では、入力ループのWait指定に50msとしていますが、CPUリソースを消費する場合には、より大きな値にしてください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">プラグイン gamepad.dll は、DirectX 
				8互換で実装しています。詳しくはソースコードを ご覧ください。gamepad.dll 
				を改造して、任意のデバイスからの入力を受けれるようにすると、のどか 
				のキーボードハンドラーにて、キーを押したと判断させることが可能です。仮想キーは、E1- を用いています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				ゲームパッドが複数接続された環境では、最初に見つかったデバイスが有効となります。<br>
				　Windows Vista や Windows 7 
				では、ユーザアカウント制御による確認ダイアログが出ているときには、操作不能となります。<br>
				　また、高DPI に対応していないので、高い解像度のディスプレイをお使いの場合では、のどか(nodoka.exe あるいは 
				nodoka64.exe)のプロパティの互換性タブにおいて、高DPI設定では画面のスケーリングを無効にする。にチェックしてください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">ゲームパッドからの入力は、下記に示すキー入力イベントに変更されます。</font></p>
				<table border="1" width="82%">
					<tr>
						<td width="85">イベント</td>
						<td width="161">キー名称</td>
						<td width="138">スキャンコード</td>
						<td>リピートフラグ</td>
						<td width="320">備考</td>
					</tr>
					<tr>
						<td width="85">X軸増</td>
						<td width="161">GP_X0</td>
						<td width="138">E1-0x20</td>
						<td>abit0</td>
						<td width="320">Xbox360 コントローラー 左スティック 右</td>
					</tr>
					<tr>
						<td width="85">X軸減</td>
						<td width="161">GP_X1</td>
						<td width="138">E1-0x21</td>
						<td>abit1</td>
						<td width="320">Xbox360 コントローラー 左スティック 左</td>
					</tr>
					<tr>
						<td width="85">Y軸減</td>
						<td width="161">GP_Y0</td>
						<td width="138">E1-0x22</td>
						<td>abit2</td>
						<td width="320">Xbox360 コントローラー 左スティック 下</td>
					</tr>
					<tr>
						<td width="85">Y軸増</td>
						<td width="161">GP_Y1</td>
						<td width="138">E1-0x23</td>
						<td>abit3</td>
						<td width="320">Xbox360 コントローラー 左スティック 上</td>
					</tr>
					<tr>
						<td width="85">Z軸増</td>
						<td width="161">GP_Z0</td>
						<td width="138">E1-0x24</td>
						<td>abit4</td>
						<td width="320">Xbox360 コントローラー LTボタン</td>
					</tr>
					<tr>
						<td width="85">Z軸減</td>
						<td width="161">GP_Z1</td>
						<td width="138">E1-0x25</td>
						<td>abit5</td>
						<td width="320">Xbox360 コントローラー RTボタン</td>
					</tr>
					<tr>
						<td width="85">X回転増</td>
						<td width="161">GP_RX0</td>
						<td width="138">E1-0x26</td>
						<td>abit6</td>
						<td width="320">Xbox360 コントローラー 右スティック 右</td>
					</tr>
					<tr>
						<td width="85">X回転減</td>
						<td width="161">GP_RX1</td>
						<td width="138">E1-0x27</td>
						<td>abit7</td>
						<td width="320">Xbox360 コントローラー 右スティック 左</td>
					</tr>
					<tr>
						<td width="85">Y回転減</td>
						<td width="161">GP_RY0</td>
						<td width="138">E1-0x28</td>
						<td>abit8</td>
						<td width="320">Xbox360 コントローラー 右スティック 下</td>
					</tr>
					<tr>
						<td width="85">Y回転増</td>
						<td width="161">GP_RY1</td>
						<td width="138">E1-0x29</td>
						<td>abit9</td>
						<td width="320">Xbox360 コントローラー 右スティック 上</td>
					</tr>
					<tr>
						<td width="85">　</td>
						<td width="161">GP_RZ0</td>
						<td width="138">E1-0x2a</td>
						<td>abit10</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">　</td>
						<td width="161">GP_RZ1</td>
						<td width="138">E1-0x2b</td>
						<td>abit11</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">　</td>
						<td width="161">GP_S0</td>
						<td width="138">E1-0x2c</td>
						<td>abit12</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">　</td>
						<td width="161">GP_S1</td>
						<td width="138">E1-0x2d</td>
						<td>abit13</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_UP</td>
						<td width="138">E1-0x2e</td>
						<td>bbit0</td>
						<td width="320">Xbox360コントローラー ハットキー 上</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_UPRIGHT</td>
						<td width="138">E1-0x2f</td>
						<td>bbit1</td>
						<td width="320">Xbox360コントローラー ハットキー 右上</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_RIGHT</td>
						<td width="138">E1-0x30</td>
						<td>bbit2</td>
						<td width="320">Xbox360コントローラー ハットキー 右</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_DOWNRIGHT</td>
						<td width="138">E1-0x31</td>
						<td>bbit3</td>
						<td width="320">Xbox360コントローラー ハットキー 右下</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_DOWN</td>
						<td width="138">E1-0x32</td>
						<td>bbit4</td>
						<td width="320">Xbox360コントローラー ハットキー 下</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_DOWNLEFT</td>
						<td width="138">E1-0x33</td>
						<td>bbit5</td>
						<td width="320">Xbox360コントローラー ハットキー 左下</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_LEFT</td>
						<td width="138">E1-0x34</td>
						<td>bbit6</td>
						<td width="320">Xbox360コントローラー ハットキー 左</td>
					</tr>
					<tr>
						<td width="85">POV</td>
						<td width="161">GP_UPLEFT</td>
						<td width="138">E1-0x35</td>
						<td>bbit7</td>
						<td width="320">Xbox360コントローラー ハットキー 左上</td>
					</tr>
					<tr>
						<td width="85">ボタン1</td>
						<td width="161">GP_B0</td>
						<td width="138">E1-0x40</td>
						<td>cbit0</td>
						<td width="320">Xbox360 コントローラー Aボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン2</td>
						<td width="161">GP_B1</td>
						<td width="138">E1-0x41</td>
						<td>cbit1</td>
						<td width="320">Xbox360 コントローラー Bボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン3</td>
						<td width="161">GP_B2</td>
						<td width="138">E1-0x42</td>
						<td>cbit2</td>
						<td width="320">Xbox360 コントローラー Xボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン4</td>
						<td width="161">GP_B3</td>
						<td width="138">E1-0x43</td>
						<td>cbit3</td>
						<td width="320">Xbox360 コントローラー Yボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン5</td>
						<td width="161">GP_B4</td>
						<td width="138">E1-0x44</td>
						<td>cbit4</td>
						<td width="320">Xbox360 コントローラー LBボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン6</td>
						<td width="161">GP_B5</td>
						<td width="138">E1-0x45</td>
						<td>cbit5</td>
						<td width="320">Xbox360 コントローラー RBボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン7</td>
						<td width="161">GP_B6</td>
						<td width="138">E1-0x46</td>
						<td>cbit6</td>
						<td width="320">Xbox360 コントローラー BACKボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン8</td>
						<td width="161">GP_B7</td>
						<td width="138">E1-0x47</td>
						<td>cbit7</td>
						<td width="320">Xbox360 コントローラー STARTボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン9</td>
						<td width="161">GP_B8</td>
						<td width="138">E1-0x48</td>
						<td>cbit8</td>
						<td width="320">Xbox360 コントローラー 左スティックボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン10</td>
						<td width="161">GP_B9</td>
						<td width="138">E1-0x49</td>
						<td>cbit9</td>
						<td width="320">Xbox360 コントローラー 右スティックボタン</td>
					</tr>
					<tr>
						<td width="85">ボタン11</td>
						<td width="161">GP_BA</td>
						<td width="138">E1-0x4a</td>
						<td>cbit10</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">ボタン12</td>
						<td width="161">GP_BB</td>
						<td width="138">E1-0x4b</td>
						<td>cbit11</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">ボタン13</td>
						<td width="161">GP_BC</td>
						<td width="138">E1-0x4c</td>
						<td>cbit12</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">ボタン14</td>
						<td width="161">GP_BD</td>
						<td width="138">E1-0x4d</td>
						<td>cbit13</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">ボタン15</td>
						<td width="161">GP_BE</td>
						<td width="138">E1-0x4e</td>
						<td>cbit14</td>
						<td width="320">　</td>
					</tr>
					<tr>
						<td width="85">ボタン16</td>
						<td width="161">GP_BF</td>
						<td width="138">E1-0x4f</td>
						<td>cbit15</td>
						<td width="320">　</td>
					</tr>
				</table>
				<p>　</p>

			  <p><font face="ＭＳ Ｐゴシック">実際の使い方の例ですが、設定ファイル  
				<a href="gamepad.nodoka.txt">gamepad.nodoka</a>, 
				<a href="gamepad-mouse.nodoka.txt">gamepad-mouse.nodoka</a> (Xbox360コントローラ用), 
				<a href="gamepad2-mouse.nodoka.txt">gamepad2-mouse.nodoka</a> 
				(ELECOM JC-U2410TBK用) を ご覧頂き、参考にしてください。それぞれの定義内容は下記となります。</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック"><a href="gamepad.nodoka.txt">gamepad.nodoka</a> では、各ボタンやスティックの操作をキー 0〜9 
				W,X,Y,X,Z,- や A〜V 
				に割り当ててあり、テスト用に、どのボタンやスティックが使えるか判断するために、お使いになれます。各ボタンやスティックのリピートはオフです。</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック">また 
				<a href="gamepad-mouse.nodoka.txt">gamepad-mouse.nodoka</a>では、Xbox360コントローラ用に定義しており、マウスの操作(右側のスティックで移動。LT,RTでポインタ移動の倍速と減速のモディファイヤー。LB, 
				RBをそれぞれ右ボタンクリック、左ボタンクリック、左側のスティックの上下をホイール、ボタンA,B,X,Y にそれぞれ 
				Enter, Esc, BS, LCtrl 
				)に割り当てています。ドラッグを可能にするために、ボタンのみリピートをオフにしています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				Xbox360コントローラの場合、公式ドライバと非公式ドライバが存在しますが、公式ドライバにて動作確認しています。なおワイヤレスタイプでは、無操作のまま放置して、接続が切れた時に、gamepad.dllでの処理も終了するため、再度
				、設定ファイルをロードしてください。</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック"><a href="gamepad2-mouse.nodoka.txt">gamepad2-mouse.nodoka</a> 
				では、ELECOMのUSBゲームパッド用の定義としており、マウスを左側のアナログパッドで移動させ、ボタン1=Enter, 
				ボタン2=Esc, 
				ボタン3,4がホイール、ボタン5,6がマウスの左右ボタン、ボタン7,8をマウス移動量加速と減速のモディファイヤーとしています。ボタンのみリピートをオフにしています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">ELECOM 
				USBゲームパッドでは、ハードウェアでの各ボタンの連射機能がありますが、遅いので、オフの方が良いようです。</font></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_mouse-event">オプション　マウスイベントフック</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">マウスによる入力イベントをキー入力として扱います。これは、YAMY 
				によるマウスイベントフック機能を、のどか に取り込んだものです。<a href="#function_MouseHook">&amp;MouseHook</a>も 
				ご覧ください。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option mouse-event = true</font></p>

			  <p><font face="ＭＳ Ｐゴシック">この設定を行うと、次に示すマウスイベントが、キー入力として扱われます。 
				なお、あらかじめ nodoka.exe, nodoka64.exe の起動時引数として、 -m 
				が設定されている必要があります。-m指定されて起動しているかどうかは、ログウィンドウの先頭で、「use Mouse LL 
				Hook」が表示されているか御確認ください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">例えば key MButton = LButton LButton 
				と記述すれば、中ボタンクリックが、左ボタンのダブルクリックになります。</font></p>
				<table border="1" width="82%">
					<tr>
						<td width="85">イベント</td>
						<td width="161">キー名称</td>
						<td width="138">スキャンコード</td>
						<td>備考</td>
					</tr>
					<tr>
						<td width="85">マウスドラッグ</td>
						<td width="161">Drag</td>
						<td width="138">E1-0x00</td>
						<td>def option drag-threshold 
						により設定されたピクセル移動量の閾値に達すると、Downが発生し、ドラッグをやめると、Upが発生します。</td>
					</tr>
					<tr>
						<td width="85">左ボタン</td>
						<td width="161">LButton</td>
						<td width="138">E1-0x01</td>
						<td>　</td>
					</tr>
					<tr>
						<td width="85">右ボタン</td>
						<td width="161">RButton</td>
						<td width="138">E1-0x02</td>
						<td>　</td>
					</tr>
					<tr>
						<td width="85">中ボタン</td>
						<td width="161">MButton</td>
						<td width="138">E1-0x03</td>
						<td>　</td>
					</tr>
					<tr>
						<td width="85">ホイール前進</td>
						<td width="161">WheelForward</td>
						<td width="138">E1-0x04</td>
						<td>注1. Down後すぐにUpが発生します。モディファイヤーキーにすることはできません。</td>
					</tr>
					<tr>
						<td width="85">ホイール後退</td>
						<td width="161">WheelBackward</td>
						<td width="138">E1-0x05</td>
						<td>注1</td>
					</tr>
					<tr>
						<td width="85">Xボタン1</td>
						<td width="161">XButton1</td>
						<td width="138">E1-0x06</td>
						<td>　</td>
					</tr>
					<tr>
						<td width="85">Xボタン2</td>
						<td width="161">XButton2</td>
						<td width="138">E1-0x07</td>
						<td>　</td>
					</tr>
					<tr>
						<td width="85">横スクロールライト(チルト)</td>
						<td width="161">TiltRight</td>
						<td width="138">E1-0x08</td>
						<td>注1、注2</td>
					</tr>
					<tr>
						<td width="85">横スクロールレフト(チルト)</td>
						<td width="161">TiltLeft</td>
						<td width="138">E1-0x09</td>
						<td>注1、注2</td>
					</tr>
				</table>
				<p>注1. Down後すぐにUpが発生します。モディファイヤーキーにすることはできません。</p>
				<p>注2. Windows Vista以降。</p>
				<p>注3. Windows 
				Vista以降において、ユーザアカウント制御を有効にしている場合、UACによる昇格が発生し、確認ダイアログが表示されたときに、マウスやキーボードによるイベントが、そのダイアログに届かないことがあります。その場合には、のどかを終了か一時停止する必要があります。</p>
				<p>注4. キー定義は<font face="ＭＳ Ｐゴシック">、<a href="add-mouse-gamepad.nodoka.txt">add-mouse-gamepad.nodoka</a> 
				で定義されています。</font></p>
				<p><font face="ＭＳ Ｐゴシック">注5. 
				調査ウィンドウを用いて、マウスイベントのコード調査を実施できますが、キー入力イベントとは異なり、実際にマウスイベントが入力されます。<br>
				　　　これは、調査ウィンドウを閉じれなくなることの回避策です。</font></p>
				<p><font face="ＭＳ Ｐゴシック">注6. 
				YAMYとは異なり、標準権限で動作させたときに、管理者権限で実行しているアプリにも、マウスイベントは届きます。<br>
　</font></p><p class="sample">
			  <font face="ＭＳ ゴシック"><a name="def_option_drag-threshold">def 
				option drag-threshold</a> = 50</font></p>

			  <p><font face="ＭＳ Ｐゴシック">
				この設定は上記表のマウスドラッグにおいて、ドラッグを開始してから、Downを発生させるまでのマウス移動量を示すピクセル値を指定します。</font></p>
				<p><font face="ＭＳ Ｐゴシック">0もしくは、記述がない場合には、Dragは発生しません。</font></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_caretblinktime">オプション　IME オン/オフ時のキャレット点滅時間指定</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				IMEのオン/オフの状態において、キャレットの点滅時間を指定して、オン/オフのモードを分かりやすくします。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option CaretBlinkTime = enable 500 50</font></p>

			  <p><font face="ＭＳ Ｐゴシック">引数は、enable （固定), </font>
				<span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: 'ms pgothic'; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; ">
				<span class="Apple-style-span" style="color: rgb(51, 51, 51); font-size: 14px; line-height: 21px; text-align: left; ">
				<a class="keyword" style="color: rgb(51, 51, 51); text-decoration: none; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(222, 222, 222); " href="http://d.hatena.ne.jp/keyword/IME">
				IME</a>オフの時の点灯あるいは消灯している時間[ms]、次の数字が<a class="keyword" style="color: rgb(51, 51, 51); text-decoration: none; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(222, 222, 222); " href="http://d.hatena.ne.jp/keyword/IME">IME</a>オンの
				時の</span></span><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: 'ms pgothic'; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><span class="Apple-style-span" style="color: rgb(51, 51, 51); font-size: 14px; line-height: 21px; text-align: left; ">点灯</span></span><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: 'ms pgothic'; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><span class="Apple-style-span" style="color: rgb(51, 51, 51); font-size: 14px; line-height: 21px; text-align: left; ">あるいは消灯している時間[ms]です。</span></span></p>
				<p><span class="Apple-style-span">
				<span style="font-size: 14px; color: #333333; letter-spacing: normal">
				制限事項：Microsoft Office の Wordなど、独自にキャレットを描画しているソフトには効きません。またアプリによっては、IME 
				ON/OFF状態に関係なく、点滅時間が変更されたままとなることがあります。</span></span></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_KeyboardDelay">オプション　キーリピート速度設定</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				コントロールパネル/キーボードでの設定と同様にキー入力してから、リピートするまでの時間、および、リピート開始後のリピート間隔を設定します。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option KeyboardDelay = enable 200 20</font></p>

			  <p><font face="ＭＳ Ｐゴシック">引数は、enable 
				あるいはdisable、キー入力開始してからリピート開始までの時間[ms]、および、キーリピート開始後のリピート間隔[ms]です。<br>
				disableにすると機能しません。リピート開始までの時間の値域は 
				100から3000msec、リピート間隔は、5msecから500ms 
				ですが、PCの性能に依存し、滑らかなキーリピートにならないことがあります。
				またキー入力をカスタマイズしているWordやExcelなどでは、まとめてリピートしたり、リピートし続けるという問題が出ることがあります。</font></p>
				<p><font face="ＭＳ Ｐゴシック"><br>
				　Pause/Breakキーなどリピートしないキーでは機能しません。またマウスイベントフックしたキーでは機能しませんが、GamePadでリピート入力にしたボタンのリピート速度は変更可能です。<br>
				<br>
&nbsp;最大リピート時間設定</font></p>
			</div>
		    <p class="sample">
			  <font face="ＭＳ ゴシック">def option KeyboardDelayMax = enable 20000</font></p>

			  <p><font face="ＭＳ Ｐゴシック">引数は、enable あるいは disable と リピート最大時間[ms] 
				です。disableの時には、機能しません。キー入力後、リピートが続いた場合、設定したリピート最大時間になると、そのキーによるリピートを取りやめるために、そのキーのUpを実際に、キーがアップされていなくても入力したことにします。<br>
				　実際に、キーが押されている場合でも、Upが挿入されるので、キーリピートは、そこで不連続となりますが、それ以外の弊害はありません。<br>
				　また、def option KeyboardDelay が enable でない場合には、無効です。<br>
				　なお、モディファイヤーキー押しっぱなしなどの不具合事例には、対応できません。<br>
				<br>
&nbsp;キーごとのリピート設定</font></p><p class="sample">
			  <font face="ＭＳ ゴシック">def option KeyboardDelayKey = 0x00 200 20 0 0</font></p>

			  <p><font face="ＭＳ Ｐゴシック">第1引数は、scan 
				code、第2引数は、リピート開始までの時間[ms]、第3引数は、リピート間隔[ms]です。第4引数は、キー入力遅延時間[ms]ですが、未実装です。0を指定してください。第5引数は、0〜7であり、複数キーボード接続時に用います。
				複数キーボード対応オプション未使用の場合には、0を指定してください。<br>
&nbsp; def 
				option KeyboardDelayでは、すべてのキーのリピート速度を設定しますが、こちらは、キー個別に設定するものです。<br>
				　例えばカーソルキーやスペースキーだけ、他のキーよりもリピート速度を変更することなどが可能となります。<br>
				　第1引数の scan code定義については、<a href="109.nodoka.txt">109.nodoka</a>などのキー定義ファイルを 
				御覧頂くか、調査ウィンドウでスキャンコードの調査を御利用ください。scan 
				codeには、無し、E0-、E1-、E0E1- を付けて、すべてのキーを表現可能です。例えば、スペースは 0x39、カーソルUP 
				E0-0x48、カーソルDOWN E0-0x50、カーソルLEFT E0-0x4b、カーソルRIGHT E0-0x4d 
				となります。 <br>
				　この定義は、キーごとに複数行記述可能ですが、先に def option KeyboardDelay の記述が必要で、かつ 
				enable で無いと機能しません。 </font></p>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_FocusChange">オプション　ウィンドウのフォーカス変更検出</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				各アプリケーションのウィンドウが最前面になるなどしてフォーカス変更されたときに、キーイベントを発行します。</font><p class="sample">
			  <font SIZE="2" face="ＭＳ ゴシック">def option FocusChange = enable</font></p>

			  <p>発行されるキーイベントは、FocusChange (E1-0x1f)の 
				Upイベントです。Downは発行されず、通常のキーとして、そのアプリケーションに入力されることは無いでしょう。</p>
				<p>
				<br>
				　例えば、次に示すように記述すると、メモ帳がフォーカスされるたびに、指定したHelpMessageが通知領域に表示されます。</p>
				<p class="sample">
			  <font SIZE="2" face="ＭＳ ゴシック">def option FocusChange = enable<br>
				window notepad /notepad\.exe/ : Global<br>
				key U-FocusChange = &amp;HelpMessage(&quot;nodoka&quot;, &quot;メモ帳です&quot;)</font></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_UseTSF">オプション　TSF使用/未使用の設定</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				IMEの状態取得の際、デフォルトでは、Text Services Framework:TSF 
				とIMM32を併用しますが、IMM32のみ使用するモードに変更します。</font><p class="sample">
			  <font SIZE="2" face="ＭＳ ゴシック">def option UseTSF = false</font></p>

			  <p>
				なお<font face="ＭＳ Ｐゴシック">制限事項がいくつかありますが例えば、def option UseTSF = false の場合、<a href="#modifier">モディファイヤー 
				IH-, IK-, IJ-</a>は認識できなくなります。</font><br>
				　また、ウィンドウごとに設定したい場合には、<a href="#function_UseTSF">&amp;UseTSF()</a> も 
				ご覧ください。</p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_UnitID">オプション　複数キーボード対応</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">def option UnitIDを使用すると複数キーボードに対応し、モディファイヤーK0-からK7-が使用可能となります。</font><p>
				<font face="ＭＳ Ｐゴシック">使用する場合、設定ファイル上で、まず最初は、</font></p>
				<p class="sample">
			  <font SIZE="2" face="ＭＳ ゴシック">def option UnitID = K1 0 0 0</font></p>

			  <p>
				と記述して、設定を再読み込みさせてください。</p>
				<p>
				すると、複数のキーボードが接続されている場合、下記のように、ログウィンドウ上で検出したキーボードのデバイスネームと、def 
				option UnitID で記述すべき雛形def option UnitID = Kx として表示されます。</p><p class="sample">
			  current device 
				name:\\?\HID#VID_0709&amp;PID_9137&amp;MI_00#7&amp;2373d6f3&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1801 37175 0<br>
				current device 
				name:\\?\HID#VID_05A4&amp;PID_1700&amp;MI_00#7&amp;1cec52f0&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1444 5888 0<br>
				current device 
				name:\\?\HID#VID_045E&amp;PID_0773&amp;MI_00#8&amp;1bfd2041&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1118 1907 0<br>
				current K1 0 0 0<br>
				def option UnitID = K1 0 0 0<br>
				successfully loaded.</p>

			  <p>
				この例では、3個のキーボードが検出出来たので、def option UnitID行をコピーして、次に示すように順にK1からK3を割り当てるよう設定ファイルを編集し、保存してください。</p><p class="sample">
			  def option UnitID = K1 1801 37175 0<br>
				def option UnitID = K2 1444 5888 0<br>
				def option UnitID = K3 1118 1907 0 # ms mouse</p>

			  <p>
				保存した設定ファイルを再度読み込ませると、次のようにログウィンドウ上に表示されます。</p><p class="sample">
			  current device 
				name:\\?\HID#VID_0709&amp;PID_9137&amp;MI_00#7&amp;2373d6f3&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1801 37175 0<br>
				current device 
				name:\\?\HID#VID_05A4&amp;PID_1700&amp;MI_00#7&amp;1cec52f0&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1444 5888 0<br>
				current device 
				name:\\?\HID#VID_045E&amp;PID_0773&amp;MI_00#8&amp;1bfd2041&amp;0&amp;0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}<br>
				def option UnitID = Kx 1118 1907 0<br>
				current K1 1801 37175 0<br>
				def option UnitID = K1 1801 37175 0<br>
				current K2 1444 5888 0<br>
				def option UnitID = K2 1444 5888 0<br>
				current K3 1118 1907 0<br>
				def option UnitID = K3 1118 1907 0<br>
				successfully loaded.</p>

			  <p>
				無事設定出来たようです。現在接続されているキーボードからキー入力してみて、指定したK1-からK7-のモディファイヤーが付いているか御確認ください。<br>
　</p>
				<p>
				<b>注意事項</b></p>
				<p>
				・<font color="#FF0000">デバイスドライバ使用モードのみサポートとなります。キーボードLLフック時には正しく機能
				しません。</font></p>
				<p>
				・最初の引数で指定可能なUnitIDは、K1からK7となります。これはdef option 
				UnitIDを使用した場合で、関連付けが見つからないキーボードはK0-とするためです。残りの引数はキーボードのVender 
				IDやProduct IDですが、ログウィンドウ上でdef option UnitID = Kx行で表示されたものを使用してください。</p>
				<p>
				・モディファイヤー 
				K0-からK7-は原理上、キーを押した(D-の)ときではなく、キーを離した(U-)ときからとなります。従って、異なるキーボードから入力した場合、最初のD-のところで、キーバインディングの変更は出来ません。こうなってしまう理由は、キーボードからキー入力があった場合、のどかのデバイスドライバを含むキーボードドライバ
				よりも、上のレイヤー(WM_INPUT/raw 
				input)にて、初めて入力されたキーの発行元キーボードが判明するためです。実際WM_INPUTが発生するのは、のどか側でキーバインディングを変更した後となるため、そのような動きとなります。<br>
				　なお本制限事項を改善する<a target="_self" href="#def_option_FakeUp">def option FakeUp</a>の項もご覧ください。</p>
				<p>
				・キーボードを新たにPCに接続した場合において、K1からK7のいずれかに割り当てる場合には、def option 
				UnitIDの行を追加してください。</p>
				<p>
				・キーボードを抜き差しした場合には、再度設定ファイルを読み込み直してください。Kx-モディファイヤー指定が異なる可能性があります。<br>
				　また、def option UnitID指定が有っても見つからないキーボードは、K0扱いとなります。</p>
				<p>
				・キーボードを検索していますが、実際には、マウスやリモコンなども検出されます。リモコンを操作して、実際にログウィンドウ上で、指定したKx-モディファイヤーが付いたものが入力されているならば、使用可能となります。</p>
				<p>
				・PS/2キーボードも識別可能ですが、PS/2キーボードが複数接続された環境はテスト出来ていません。</p>
				<p>
				・Ver.4.27からUSBではなくBluetoothキーボードに対応しました。また一部のUSBキーボードで、0 0 
				0となってしまうキーボードにも対応しました。</p>
				<p>
				　</p>
				<p>
				<b>サンプル</b></p>
				<p>
				<b>・<a name="BadUSB">BadUSBと呼ばれる悪意を持ったUSBキーボードデバイスからのキー入力を抑止</a></b><br>
				　設定ファイル<a target="MANUAL" href="no_badusb.nodoka.txt">no_badusb.nodoka</a>を用意しました。
				設定方法は以下となります。設定されていないキーボードは、すべてK0扱いとなり、キー入力が無効となるので、BadUSBによる悪意を持ったUSBキーボードからのキー入力はすべて抑止されます。<br>
				　実際に使用していないUSBキーボードなどが存在する場合には、USBに接続してみて、キー入力が全くできないことを確認しておけば、BadUSBによる悪意を持ったUSBキーボードデバイスが挿されるようなことがあっても安心ですが、離席時にはWindows側で画面のロックをするなどされた方が、より効果的です。<font color="#FF0000">なお画面のロック中はスクリーンキーボード以外からの入力は禁止されます。指紋スキャン認証によるログインなどがお勧めです。</font><br>
				<br>
				　デフォルトの<a target="MANUAL" href="dot.nodoka.txt">dot.nodoka</a>ファイル上で、サンプルへのinclude指定がコメントアウトされているので、有効にするには
				行頭の#(コメント指定)を削除してください。<br>
				　その後、設定ダイアログから、「再読み込み」ボタンを押して、設定ファイルを反映させるとキー入力できな
				くなった場合は、機能し始めています。<br>
				　その場合は、<a href="MANUAL-ja.html#pause">のどかを一時停止してください</a>。<font color="#FF0000">なお一時停止中は、BadUSBキーボードを含む全てのキーボードの入力が許可された状態となります。</font><br>
				<br>
				　　<a target="MANUAL" href="dot.nodoka.txt">dot.nodoka</a>の31行目</p><p class="sample">
			  #include &quot;contrib\\no_badusb.nodoka&quot; # (11) BadUSBによる悪意を持ったキーボードからの入力を抑止します</p>

			  <p>
				&nbsp;<br>
				　<a target="MANUAL" href="no_badusb.nodoka.txt">no_badusb.nodoka</a> 
				のデフォルト記述では、3行目と5行目において、PS/2接続の
				キーボードをK1(英語キーボード)あるいはK2(日本語キーボード)に設定しているので、多くのノートPCでは、このままの設定で大丈夫です。<br>
				　変更が必要ならば、本節 <a href="#def_option_UnitID">オプション 複数キーボード対応</a>の冒頭をご覧いただき、使用許可を与えるキーボードが設定されるよう修正してください。<br>
				　10行目では、<a href="#def_option_FakeUp">複数キーボード認識タイミングの変更</a>を実施しています。<font color="#FF0000"><br>
				　デフォルトでは20msを指定していますが、ときどき判別に失敗して抑止したキーボードからのキー入力が出来る/抑止していないキーボードからのキー入力が出来ないようならば、
				調整してください。<br>
				　またダミーキーのキーコードの変更が必要となる場合があります。</font><br>
				<br>
				　　<a target="MANUAL" href="no_badusb.nodoka.txt">contrib\\no_badusb.nodoka</a> 
				の冒頭</p><p class="sample">
			  &nbsp;# no_badusb.nodoka 2014-11-11 by G.K.Applet<br>
				<br>
				def option UnitID = K1 0 771 0 # 初めて読み込んだ時に御使いのキーボードの設定が 
				K1になるよう引数を変更してください。<br>
				# この設定は PS/2接続の英語キーボード PNP0303が有効になっています。<br>
				def option UnitID = K2 0 800 0 # この設定では、PS/2接続の日本語キーボード 
				PNP0320です。<br>
				<br>
				# なお、この no_badusb.nodokaを読み込むと 
				K0扱いになったキーボードからはキー入力できないので編集される場合には必ず、他の設定を選択するか一時停止にしてください。<br>
				<br>
				def option FakeUp = enable 20 84 # 0x54=84 SysRqをダミーキーに設定しています。<br>
				<br>
				key K0-*A = &amp;Ignore</p>
				<p>
				<br>
　</p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_FakeUp">オプション　複数キーボード認識タイミングの変更</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">def option UnitIDによる複数キーボード認識のタイミングを変更できるようダミーのキー出力を行います。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option FakeUp = enable 20 00</font></p>

			  <p><font face="ＭＳ Ｐゴシック"><br>
				　第1引数 enableあるいはdisable 機能の有効無効を切り替えます。<br>
				　第2引数 ダミーキーを送った後での待ち時間 0-100[ms]<br>
				　　キー入力が遅くなるので、あまり大きくない方が良いですが、短いとキーを押したとき(D-)のタイミングにならないことがあります。20[ms]程度推奨となり、<font color="#FF0000">実際には調整が必要です。</font><br>
&nbsp; 第3引数 ダミーキーのキーコード<br>
&nbsp;&nbsp; 00すなわち0x00は、キー定義が存在しないキーであり、拡張キーE1-が付けられたキーコードとなります。<br>
&nbsp;&nbsp; SysRqキー(0x54)を指定する場合には、84になります。多くのアプリケーションで無視されるキーに拡張キーE1-を付けたことになります。<br>
&nbsp;&nbsp; 拡張キーE1を用いたキーコードは、<a href="add-mouse-gamepad.nodoka.txt">add-mouse-gamepad.nodoka</a> 
				で多く使っているので、ぶつからないコードにしてください。<br>
				<br>
				　制限あるいは注意事項</font></p>
				<p><font face="ＭＳ Ｐゴシック">・<a href="#def_option_UnitID">def 
				option UnitID</a>と同様に、キーボードLLフック時には機能しません。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・キー入力ごとに、最初に指定したダミーキーのキーコードを用いて、キーのダウン、アップをデバイスドライバに送り、その後、指定した時間だけ待ちます。WM_INPUT/raw 
				inputから見れば正式なキー入力となるために、<a href="#def_option_UnitID">def option 
				UnitID</a>とdef option FakeUpを併用した場合、うまく、キーを離したタイミングではなく、キーを押したタイミングに、モディファイヤーK0-がK7-が切り替わります。ダミーキー出力は、ログウィンドウには表示されません。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・のどか起動時、あるいは設定ファイル再読み込み時、最初のキー入力の際、UnitIDが確定せず、K0モディファイヤー
				になることがあります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">・待ち時間が短いと全く効果が無いことがあります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・待ち時間があるために、キーを押し続けて、キーリピートさせたときに、キーを離してもキーリピートが終わらず入力し続けることがあります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・アプリケーションプログラムによっては、拡張キー指定E1が付いているキーとは認識せずに、E1が無いキーとして認識し実際に入力されることがあります。その場合には、異なるキーコード
				にしてください。<br>
				　　例えば、0x0a〜0x18、すなわち10から24あたりが未使用なので使えますが、のどかの将来のバージョンや他のアプリで未使用とは限りませんのでご注意ください。<br>
				　　<a target="MANUAL" href="CUSTOMIZE-ja.html#def_option_FocusChange">ウィンドウのフォーカス変更検出 
					( def option FocusChange )</a>や<a href="CUSTOMIZE-ja.html#option_checkmodifier" target="MANUAL">モディファイヤーキー押しっ放し検出、解除機能 ( def option CheckModifier )</a>でも、拡張キーE1付きのキーコードを送っていますが、同様な制限事項とならないのは、def 
				option FakeUpとは異なり、キーのアップだけを送っているためとなります。</font></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_UseDoublePress">オプション　キー2回押し検出</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">同じキーを2回続けて押した状態を検出し、モディファイヤーDP-が使用可能となります。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option UseDoublePress = enable 300 10</font></p>
				<p><font face="ＭＳ Ｐゴシック"><br>
				　第1引数 enable/disable 機能の有効無効<br>
				　第2引数 最初のキー入力から2回目のキー入力があったと判断する時間<br>
				　　　キーのダウン/アップ/ダウン/アップが連続してあったことを検出するために、300[ms]程度が適切ですが、ログウィンドウで詳細表示にしてみて、うまくDP-モディファイヤが付くか、ご確認ください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">第3引数 DP-モディファイヤーがキーアップの際に付くための待ち時間 
				0-100[ms]。20ms前後ぐらい必要です。<br>
　</font></p>
				<p><font face="ＭＳ Ｐゴシック">制限あるいは注意事項</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・キーを押した時ではなく、キーを離したときに発生するため、モディファイヤーU-と併用することになります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・第2引数は別スレッドで検出しているため、キー入力に影響は、ほぼありませんが、第3引数は、その時間だけキー処理を待つので、キー入力の遅延となります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・その結果、キー入力に待ち時間を挿入するため、キーを押し続けて、キーリピートさせたときに、キーを離してもキーリピートが終わらず入力し続けることがあります。なお、<a href="#def_option_FakeUp">def 
				option FakeUp</a>を併用している場合には、お互いの待ち時間を短く指定することが可能です。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				・1回だけ押したときの機能は、そのままなので、必要に応じて定義する必要があります。<br>
　</font></p>
				<p><font face="ＭＳ Ｐゴシック">使用例</font></p>
				<p><font face="ＭＳ Ｐゴシック">1. Aキーを2回押すと、初めて入力される。</font></p>
				<p class="sample">
			  <font face="ＭＳ ゴシック">def option UseDoublePress = enable 300 10<br>
				<br>key U-DP-A = A<br>
				key ~DP-A = &amp;Ignore</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック">2. 右シフトを2回押しで、バルーンヘルプを表示させます。</font></p>
				<p class="sample">
			  <font face="ＭＳ ゴシック">def option UseDoublePress = enable 300 10<br>
				<br>key U-DP-LShift = &amp;HelpMessage(&quot;のどか&quot;, &quot;DoublePress!!&quot;)</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック">3. 日本語キーボードにおいて、英数キー2回でIME ONにして、1回でIME 
				OFFにします。最初の行で、英数キーを無効(&amp;Ignore)にしていますが、これはお使いのIMEによっては状態が変化することを抑止するためです。2行目でIME 
				ON、3行目でIME OFFの記述となります。</font></p>
				<p class="sample">
			  <font face="ＭＳ ゴシック">def option UseDoublePress = enable 300 10<br>
				<br>key 英数 = &amp;Ignore<br>
				key U-DP-~IL-英数 = $ToggleIME<br>
				key IL-~DP-英数 = $ToggleIME</font></p>
				<p>　</p>
				<p><font face="ＭＳ Ｐゴシック">4. 英語キーボードにおいて、CapsLockキー2回でIME 
				ONにして、1回でIME OFFにします。最初の行で、CapsLockキーを無効(&amp;Ignore)にしています。これをせずに無効にしない場合には、2行目のShift-CapsLockを押したら初めてCapsLockになる記述は不要でしょう。</font></p>
				<p class="sample">
			  <font face="ＭＳ ゴシック">def option UseDoublePress = enable 300 10<br>
				<br>key Caps = &amp;Ignore<br>
				key S-Caps = Caps<br>
				key U-DP-~IL-Caps = $ToggleIME<br>
				key IL-~DP-Caps = $ToggleIME</font></p>
				<p><br>
　</p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="def_option_DesktopListView">オプション　デスクトップ上のアイコン表示状態の変更</a></font><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">デスクトップ上のアイコンの表示状態を変更します。</font><p class="sample">
			  <font face="ＭＳ ゴシック">def option DesktopListView = 2</font></p>

			  <p><font face="ＭＳ Ｐゴシック">引数は、0から4です。0: 通常表示、1: 詳細表示、2: 
				小さなアイコン表示、3: リスト表示、4: タイル表示</font></p>
				<p><font face="ＭＳ Ｐゴシック">Windows 
				2000では機能しません。2の小さなアイコン表示を用いると、デスクトップを広く使うことが可能です。</font></p>
				<p><font face="ＭＳ Ｐゴシック">Windows 
				Vista以降で、デスクトップのアイコンが大きなままの場合には、デスクトップ上で、Ctrlキーを押しながら、マウスホイールを操作することで、アイコンサイズを変更してください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">本機能はキーバィンディング入れ替え機能とは無関係です。</font></p>
			</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="option_keyboardLLhook">オプション　キーボードLLフック</a></font><dd class="d3">
			<div>
			  　<p><b><font face="ＭＳ Ｐゴシック">引数 -k 解説と使い方</font></b></p>
				<p><font face="ＭＳ Ｐゴシック">def option で指定する機能ではなく、nodoka.exe あるいは 
				nodoka64.exe の起動時コマンドライン引数に -k 
				をつけた時に、デバイスドライバによるキーフィルタ動作ではなく、ローレベルキーボードフック(WH_KEYBOARD_LL)を用います。</font></p>
				<p><font face="ＭＳ Ｐゴシック">キーボードLLフックで動作している場合には、ログウィンドウの先頭に「use 
				Keyboard LL Hook」が表示されます。またバージョンダイアログ上でも、デバイスドライバのバージョン表示の代わりに、 
				(nodokad: Keyboard LL Hook Mode)　が右上に表示されます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				キーボードLLフックで動作させると、デバイスドライバがインストールされていない環境でも実行可能です。
				セットアップでは、<a target="_self" href="MANUAL-ja.html#デバイスドライバをインストールしない">デバイスドライバをインストールしない</a>を選択した場合、キーボードLLフックを選択することになります。もし、のどかをインストールせずに、バイナリだけをセットアップから、取り出す場合には、</font><font SIZE="2">nodoka-4.30_setup.exe 
				/C をコマンドプロンプトから実行してください(この時の場合でも管理者権限が必要となります)。</font></p>
				<p><font size="2">最小限必要なファイルは、x86環境では nodoka.exe, nodoka.dllと、109.nodokaなどの設定ファイルです。またx64環境では、nodoka64.exe, nodoka64.dll, 
				nodoka_helper.exe が必要となります。</font></p>
				<p><font size="2">x86環境では nodoka.exe -k を、またx64環境では、nodoka64.exe 
				-k を実行してください。
				なお引数を付けなくても、リモートデスクトップ環境であることを検出したら、キーボードLLフックモードで動作するよう4.18から改善致しました。</font></p>
				<p>　</p>
				<p><b><font size="2">制限事項</font></b></p>
				<ul>
					<li><font size="2">次に示すdef 
					option設定は機能しません。これはローレベルキーボードフックは、イベントドリブンなのに対し、フィルタドライバはポーリング動作によるため、デバイスドライバのキー入力の空き時間に、これらのdef 
					option設定を機能させているからです。def option KeyboardDelay, def option 
					KeyboardDelayKey, def option KeyboardDelayMax, def option 
					FocusChage, def option UnitID, def option FakeUp</font></li>
				</ul>
				<p>　</p>
				<ul>
					<li><font size="2">次に示すキーは正常に認識できません（キー入力そのものを検出できなかったり、キーのUpが認識できないこともあります。キーのUpが認識できないと、モディファイヤーキーが押されたままとなることの原因となります。）、これを解消するには、レジストリ設定で</font>ScancodeMapを変更するなどが必要です。<a href="MANUAL-ja.html#YAMY">YAMY</a>では、これに対応するワークアラウンド
					を準備されていますが、のどかでもVer4.24から対応しました。<a target="_self" href="#起動時オプション-n">オプション 起動時引数 -n
					</a>をご覧ください。</li>
				</ul>
				<blockquote>
					<p><font size="2">E1プレフィックスキーが付いたキー　Pauseキーなど</font></p>
					<p><font size="2">半角・全角キー(英語キーボードでは`キー　BackQuoteあるいはGraveAccent)</font></p>
					<p><font size="2">英数あるいはCpasLockキー</font></p>
					<p><font size="2">ひらがなキー</font></p>
					<p><font size="2">無変換キー</font></p>
					<p><font size="2">右シフトキー</font></p>
				</blockquote>
				<p>なお、右シフトキーが使えないことは致命的なので、ホスト側の のどか設定ファイルでは、window 
				RemoteDesktop /mstsc\.exe/ 
				を記述し、ホスト側でのキー入れ替えは無いことにして、リモート側のどかの設定ファイルでは、下記のような設定をすると良いでしょう。</p>
				<blockquote>
					<p><font size="2">def key E0RightShift E0RShift = E0-0x36</font></p>
					<p><font size="2">mod shift += E0RShift</font></p>
					<p><font size="2">key *E0RShift = *LShift</font></p>
					<p><font size="2"># 以下は、def option CheckModifier 
					を使う場合に記述してください。</font></p>
					<p><font size="2">def option CheckModifier = enable 5</font></p>
					<p><font size="2">key U-*ShiftDownOver = &amp;HelpMessage(&quot;nodoka&quot;, 
					&quot;Shift&quot;) U-LShift U-RShift U-E0RShift</font></p>
				</blockquote>
				<ul>
					<li><font size="2">UAC確認ダイアログなどが表示されたときなど、画面のロック時にキー入力できなくなります。</font></li>
					<li><font size="2">スクリーンセーバーによる画面のロックのあとでキーリピートすることがあります。</font></li>
					<li><font size="2">インストールせずにファイルコピーして実行させた場合、.nodokaファイルへのメモ帳への関連付けが実行されていないために、設定ダイアログから設定ファイルを開くことが出来ません。その場合には、実行ファイルと同じフォルダにおいたdot.nodokaファイルを直接、編集してください。</font></li>
					<li><font size="2">また、Program Files (x86)あるいは、Program 
					Filesフォルダ以下にインストールしなかった場合、権限の異なるアプリケーションの情報が取得できません。</font></li>
					<li><font size="2">その他、他の</font><font face="ＭＳ Ｐゴシック">キーボードLLフック(WH_KEYBOARD_LL)を用いたアプリケーションプログラムと同時に動作させた場合の挙動は不明です。</font></li>
				</ul>
				</div>
		    </dd>

			<dt class="h3"><font face="ＭＳ Ｐゴシック">
			<a name="option_WIN8WA">オプション Windows 8用ワークアラウンド　</a></font><dd class="d3">
			<div>
			  　<p><b><font face="ＭＳ Ｐゴシック">引数 -w 解説と使い方</font></b></p>
				<p><font face="ＭＳ Ｐゴシック">def option で指定する機能ではなく、nodoka.exe あるいは 
				nodoka64.exe の起動時コマンドライン引数です。Windows 8, 8.1向けで -w 
				をつけた時に、Alt-Tabキーと、Win-Xキーを押したとき、キーカスタマイズ対象から外すことで、Windowsに送られるようになります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">デバイスドライバモードではない</font>キーボード<font face="ＭＳ Ｐゴシック">LLフック利用時に、
				高整合性(High IL)版である nodoka_hil.exeあるいはnodoka64_hil.exeを用いて管理者権限で起動するのではなく、Alt-TabやWin-Xキーを、キーカスタマイズ対象にしなくても問題が無い場合には、こちらの起動時オプションを御使い下さい。<br>
　</font></p>
				</div>
		    </dd>

			<dt class="h3"><a name="option_checkmodifier">オプション　モディファイヤーキー押しっ放し検出、解除機能</a><dd class="d3">
			<div>
			  　<p><b><font face="ＭＳ Ｐゴシック">解説と使い方</font></b></p>
				<p class="auto-style1">モディファイヤーキーであるWindows, Shift, Ctrl, 
				AltキーとEnterキーが、押されたままとなることがあります。そのことを検出するために、下記のオプションを準備しました。</p>
				<p class="sample">
			  <font face="ＭＳ ゴシック">def option CheckModifier = </font>
				<span class="auto-style5">enable 5</span></p>

			    <p class="auto-style1">　</p>
				<p class="auto-style1">第1引数は、enable あるいは disable 
				です。enable時に機能します。第2引数は、検出する時間となります。上記の例では、5秒間押されたままであることを検出することになります。値域は1から30であり、最大30秒を指定可能です。上記の例のように5秒間程度で良いと考えます。なお、物理的に、モディファイヤーキーを押したままの操作をした場合にも検出します。</p>
				<p class="auto-style1">
				Enterキーは、モディファイヤーキーではありませんが、Enterキーが押されたままとなったという報告もあったために、追加してあります。また、左右に存在するモディファイヤーキーの個々を検出する機能はありません。</p>
				<p class="auto-style1">
				実際に検出すると、特別なキーのUpを送ります。具体的に使用する場合には、設定ファイル上で次のように記述します。</p>
				<p class="sample">
			    <font face="ＭＳ ゴシック">def key WinDownOver = E1-0x19<br>def key 
				ShiftDownOver = E1-0x1a<br>def key CtrlDownOver = E1-0x1b<br>def 
				key AltDownOver = E1-0x1c<br>def key EnterDownOver = E1-0x1e<br>
				<br>key U-*WinDownOver = &amp;HelpMessage(&quot;nodoka&quot;, &quot;Win&quot;) U-LWin 
				U-RWin<br>key U-*ShiftDownOver = &amp;HelpMessage(&quot;nodoka&quot;, &quot;Shift&quot;) 
				U-LShift U-RShift<br>key U-*CtrlDownOver = 
				&amp;HelpMessage(&quot;nodoka&quot;, &quot;Ctrl&quot;) U-LCtrl U-RCtrl<br>key 
				U-*AltDownOver = &amp;HelpMessage(&quot;nodoka&quot;, &quot;Alt&quot;) U-LAlt U-RAlt<br>
				key U-*EnterDownOver = &amp;HelpMessage(&quot;nodoka&quot;, &quot;Enter&quot;) U-Enter</font></p>
				<p class="auto-style1">上記では、def key 定義が5行ありますが、この5行は、<font face="ＭＳ Ｐゴシック"><a href="add-mouse-gamepad.nodoka.txt">add-mouse-gamepad.nodoka</a> 
				で定義されています。</font></p>
				<p class="auto-style1">
				キーの入れ替え定義の5行が文末にありますが、この例では、&amp;HelpMessageを用いて、通知領域に、検出したことを表示して、その後、各モディファイヤーキーのUｐを送ることで、押されたままとなる状態の解除を実施しています。</p>
				<p class="auto-style1">
				また、上記の設定ファイルでは、検出したことの表示と解除を実現していますが、&amp;HelpMessage()だけを使って通知だけとすることや、あるいは、表示させずにキーのアップだけ実施するなども、用途に応じて、使い分け可能です。また例えば、それらのことは実施せずに、&amp;ShellExecute()などを用いて、5秒間長押ししたときに、プログラムを実行するような使い方も可能です。</p>
				<blockquote>
					<p class="h4" style="width: 629px">■モディファイヤーキーが押されたままとなる原因</p>
					<p>
					キーのUpが認識できなかったときに、モディファイヤーキーの入れ替えを伴うような記述によるキー入れ替えを実行した際、発生することが確認できています。それ以外の原因については特定できていません。<br>
					　例えば、キーボードLLフック状態で起動した「のどか」で、英数キーを押すと、Downは入力されますが、Upが入力されないことがあります。</p>
					<p class="sample">
			  <font face="ＭＳ ゴシック">key W-_1 = C-C</font></p>

					<p>そのとき、上記のような 
					Windowsキーと数字の1キーを押したときに、Ctrl-Cが押されたようなキー入れ替えを行うと、その後、Ctrlキーが押されたままとなります。内部的には、キーが押された個数を数えていますが、Upが来ていないために、押された個数が0になっておらず、まだキーが押されたままであると判断し、上記のような入れ替え設定が実行されると、Ctrlキーが押されたままとなります。</p>
					<p>
					この状態が発生していることを認識できるように、ログの詳細表示の際、下記のようなキーが押された個数を意味する表示を追加しました。</p>
					<p class="sample">
			  	  m_currentKeyPressCount:0<br>* No key is pressed</p>

			  	  <p>
				  上記は、全てのキーが離れた場合に表示される正常な状態です。異常状態では、全てのキーを離した場合でも、m_currentKeyPressCountは、1以上となり、* 
				  No Key is pressed はログに出力されません。</p>
				</blockquote>
				<p>　</p>
			  </div>
		    </dd>

			<dt class="h3"><a name="option_arg">オプション　起動時引数</a><dd class="d3">
			<div>
			  　<p><b><font face="ＭＳ Ｐゴシック">解説と使い方</font></b></p>
				<p class="auto-style1">nodoka.exe あるいは nodoka64.exe 
				には引数を列挙することで、使用する機能を指定したり、動作を指示したりすることが可能です。以下は nodoka.exe 
				に対して説明を行いますが、nodoka64.exe でも同様です。<br>
				　　なお、インストール時にsetupプログラムは、マウスフックが指定されたならば、マウスフックが使えるように、-m 
				を付けます。引数を設定するには、スタートアップやスタートメニューに登録された「のどか」のプロパティに設定するか、コマンドプロンプトから、c:\Program 
				Files\nodoka\nodoka.exe -m のように指定することになります。<br>
				　なお、x64(64bit環境)では、nodoka64.exe をお使いください。誤って 
				nodoka.exeを起動しても機能しますが、すでに起動していなかった場合に、32bit版の「のどか」を動かしたことになります。</p>
				<blockquote>
					<p>-y 　　二重起動時に、引数を何もつけないと設定ダイアログが開くよう 
					4.21から挙動が変更されているので、下記各引数において、必要であれば -y を付けてください。</p>
					<p>　</p>
					<p>-L, -l　
					ログウィンドウを起動時に開きます。-Lでは詳細がチェックされた状態となります。二重起動あるいは、すでにログウィンドウが開いている場合、詳細チェックは実行されません。</p>
					<p><a name="-m">-m</a>　　<a href="#def_option_mouse-event">マウスフック</a>を使用可能にします。すでに「のどか」が起動している場合に変更することはできません。</p>
					<p><a name="-k">-k</a>　　<a target="_self" href="#option_keyboardLLhook">キーボードLLフックモード</a>で動作させます。すでに「のどか」が起動している場合に変更することはできません。</p>
					<p>
					-p　　　設定をロード後、すぐに一時停止状態に移行します。すでに「のどか」が起動している場合には、一時停止状態と実行状態を切り替えます。</p>
					<p>-r　　　すでに「のどか」が起動している場合、メニューを表示します。-y 
					を付けないと、正しく動作せず、設定ダイアログが表示されます。 </p>
					<p>-c0 から 
					-c7　通知領域のアイコンの色を変更します。すでに「のどか」が起動している場合には、色の変更のみが実施されます。<font face="ＭＳ Ｐゴシック"><a target="_self" href="CUSTOMIZE-ja.html#function_IconColor">関数 
		&amp;IconColor </a>の項も、ご覧ください。</font></p>
					<p><a name="起動時オプション-n">-n<font face="ＭＳ Ｐゴシック">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					下記キーのScancodeMapの変更を実施します。</font></a><font face="ＭＳ Ｐゴシック">既にレジストリ上ScancodeMapで変更済であれば置き換えられません。<a target="_self" href="#option_keyboardLLhook">オプション 
					キーボードLLフック機能(<b>-k</b>)機能</a>利用時に、キーアップが送られてこないキーに対する対応となります。設定ファイル<a target="_self" href="read-keyboard-define.nodoka.txt">read-keyboard-define.nodoka</a>に、
					設定ダイアログのシンボルにて<b>-DUSEFIXNLS</b>を指定したときにキー定義されるよう記述を追加しています。変更されるキーのスキャンコード置き換え前と後の値を下記に示します。<br>
					<br>
						0x29 → E0-0x29 半角/全角, `<br>
					0x3a → E0-0x3a 英数, CapsLock<br>
						0x70 → E0-0x70 ひらがな<br>
						0x7b → E0-0x7b 無変換<br>
					<br>
					　-nを付ける場合、起動には<b>管理者権限が必要となります</b>。管理者権限が無い場合、「ScancodeMapの変更に失敗しました(エラーコード=1026)」が表示されます。
					その他の注意事項として、のどかの起動時にScancodeMap変更機能が有効にされたあと、のどかの終了時、一時停止時に無効化されます。Windowsのユーザの切り替え時、リモートデスクトップにて接続された時にも、一時的に無効化されますが、キーの押しっぱなしが発生しやすいので、画面のロック時やスリープ時には無効化されません(YAMYでは
					、どちらも無効化されます)。<br>
					　リモートデスクトップ環境で用いる場合、リモートデスクトップ側のキーボード配列に関係なく、ローカルのキーボード配列でキー入力したい場合には、日本語配列の場合には、<b>-DUSEFIXNLS</b>だけでも良いですが、英語配列の場合には、<b>-DUSEFIXNLS;-DUSE104</b>を設定ダイアログのシンボルにて指定してください。</font></p>
					<p>-w　　　Windows 
					8以降において、-kを用いてキーボードLLフックモードで動作させているときに、うまくキー入力できなくなってしまうAlt-TabとWin-Xを、<font face="ＭＳ Ｐゴシック">高整合性(High 
					IL)版である nodoka_hil.exeあるいはnodoka64_hil.exeを用いて管理者権限で起動するのではなく、通常権限で用いる場合において、キーカスタマイズ対象から外すことで、Alt-TabとWin-XをWindowsに入力できるようにするものです。</font> </p>
					<p><a name="起動時オプション-g">-g　　　整合性レベルを指定します。</a><br>
					　　-g 2 では整合性レベルHighとなります。管理者権限での起動が必要となります。ただしWindows 8以降での 
					-wの代わりとなるhil版と同等になりません。<br>
					　　-g 1 は整合性レベルMediumです。省略時のデフォルトとなります。<br>
					　　-g 0 だと整合性レベルLowとなります。なお権限が不足してまともに動作しません。&nbsp; </p>
					<p><font face="ＭＳ Ｐゴシック"><br>
　</font></p>
				</blockquote>
				<p>　</p>
			  </div>
		    </dd>

			<dt class="h3"><a name="option_limitversion">オプション　機能制限版のどかについて</a><dd class="d3">
			<div>
			  　<p><b><font face="ＭＳ Ｐゴシック">解説と使い方</font></b></p>
				<p class="auto-style1">
				インストール時に、のどかセットアップダイアログにおいて、機能制限版にチェックを入れると、マクロ機能を動作しないようにした機能制限版のどかがインストールされます。具体的には、スタートメニューなどに登録されるショートカットの実行ファイル名が、<span class="auto-style6">nodoka64_limit.exe</span> 
				あるいは <span class="auto-style6">nodoka_limit.exe</span> となります。</p>
				<p class="auto-style1">
				購入された場合には、機能制限版と言っても、試用版(サンプル版)とは異なり、起動後、30分で終了するようなことはありませんが、マクロ的機能が一切動作しません。実際、次に示すような機能制限が、存在します。誤って機能制限版をインストールした場合、設定ファイルの読み込み時にエラーとなったり、設定ファイルに記述された機能が一部動作しなくなるので、元に戻す場合には、再インストールを試みるか、ショートカットファイルのプロパティにて実行ファイル名を 
				 
				<span class="auto-style6">nodoka64.exe</span>　あるいは  
				<span class="auto-style6">nodoka.exe</span> に変更してください。</p>
				<blockquote>
					<p>■ <strong>制限される機能の一覧</strong></p>
					<p>(1) key文、seqkey文</p>
					<p>
					設定ファイル上で、キーの入れ替え定義を行う、<a href="#key" target="_self">key文</a>、<a href="#keyseq" target="_self">keyseq文</a>は、通常版と異なり、ひとつのキー設定しか機能しません。</p>
					<p>もし、複数キー設定を連続して記載した場合、文末の最後のキー定義だけ設定されますので、ご注意ください。</p>
					<p>例えば、インストール時に設定されるデフォルトの設定ファイル群(例えばdefault.nodoka, 
					default2.nodoka, 
					emacsedit.nodokaやdot.nodoka)では、まともに動作しないキーシーケンスが存在します。</p>
					<p>例えば、key C-_1 = _1 _2 _3 &amp;SetIcon(2) 
					などと記載されている場合、Ctrl-1を押すと　通常版では、123が出力され、のどかアイコンの色が変更されますが、機能制限版では、123は出力されず、最後のFunctionである&amp;SetIcon(2)のみが機能することになります。</p>
					<p>
					もし、<a href="#function_DescribeBindings" target="_self">&amp;DescribeBindings</a>を定義したキーがあれば、そのキーを押すことで、設定されているキー入れ替え情報が、ログウィンドウ上に表示されるので、それで設定状況を、ご確認ください。</p>
					<p>　</p>
					<p>(2) def key定義について</p>
					<p><a href="#def_key" target="_self">def key 
					定義</a>も1個のキーしか定義できません。しかしながら、下記に示すように、PCでは、Pauseキーだけは2個必要なので、それのみ定義可能です。</p>
					<p>Pause E1-0x1d 0x45</p>
					<p>　</p>
					<p>(3) Functionについて</p>
					<p>
					次に示すFunctionは、設定ファイルで記述されてもエラーにはなりませんが、機能しません。ログウィンドウ上は、詳細をチェックした状態では、is 
					not working. が表示されます。</p>
					<p><a href="#function_PlugIn" target="_self">&amp;PlugIn</a></p>
					<p><a href="#function_Repeat" target="_self">&amp;Repeat</a></p>
					<p><a href="#function_ShellExecute" target="_self">&amp;ShellExecute</a></p>
					<p><a href="#function_SendText" target="_self">&amp;SendText</a></p>
					<p><a href="#function_SetImeString" target="_self">&amp;SetImeString</a></p>
					<p><a href="#function_Wait" target="_self">&amp;Wait</a></p>
					<p><a href="#function_WaitKey" target="_self">&amp;WaitKey</a></p>
					<p>　</p>
					<p>(4) def optionについて<br>　次に示すdef 
					option機能は、設定ファイルに記述するとエラーとなります。</p>
					<p><a href="#def_option_KeyboardDelay" target="_self">def option KeyboardDelay</a></p>
					<p><a href="#def_option_KeyboardDelay" target="_self">def option KeyboardDelayMax</a></p>
					<p><a href="#def_option_KeyboardDelay" target="_self">def option KeyboardDelayKey</a></p>
					<p><a href="#function_SendText" target="_self">def option SendTextDelay</a></p>
					<p><u><a href="#def_option_UseDoublePress">def option 
					UseDoublePress</a></u></p>
				</blockquote>
				<p>　なお、この機能制限版は、キーボードマクロ機能を持ったソフトウェアを排除するようなゲームに対する解決策となるよう準備されたものですが、実際にお使いのゲームなどで、排除されないよう認めてもらうには、そのゲームのユーザサポートなどと交渉される必要があります。</p>
			  </div>
		    </dd>

		  </dl>
		</div><dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="include">
		vii. ファイル読み込み</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p class="sample">
		  <font face="ＭＳ ゴシック">include <em>&quot;ファイル名&quot;</em>
		  </font>
		  </p>
		  
		  <p><font face="ＭＳ Ｐゴシック">と書くことによって、その行に<em>ファイル名</em> で示されるファイルを挿入し、設定ファイルとして使用することができます。<em>ファイル名</em>は<a href="#HOME">ホームディレクトリ</a>から検索されます。<br>
			　 include文では、フルパス指定は使用できませんが、相対指定は可能であり、例えば include &quot;contrib\\keitai.nodoka&quot; 
			と記述すれば、ホームディレクトリに存在する contrib ディレクトリのkeitai.nodokaファイルをインクルードすることになります。</font></p>
		  
		  <dl>
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="HOME">ホームディレクトリ</a>
		    </font>
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">ホームディレクトリとは、
				設定ファイル格納先ディレクトリのことであり、そう呼びます。include文で指定した設定ファイルが存在するフォルダとしても用います。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">下記の順に検索します。
			    検索状況を確認するには、ログウィンドウを開いて、詳細をチェックした状態で、再読み込みを実施してください。not 
				foundと表示された場合、その設定ファイルは読み込まれていません。loadingと表示された場合、その設定ファイルを読み込み、エラーなく読み込まれたならば、successfully 
				loaded.と表示されます。</font></p>
			  
			  <ul>
			    <li><font face="ＭＳ Ｐゴシック">
				設定ダイアログにおいて設定ファイルをフルパス指定した場合、その設定ファイルが置かれたフォルダ</font><li><code>
				<font face="ＭＳ Ｐゴシック">%NODOKA%</font></code><font face="ＭＳ Ｐゴシック"><br>
				環境変数 NODOKA で指定したフォルダです。 一か所にまとめたい場合に、定義してお使いください。
				のどかインストール時や、Windowsのコントロールパネルから、システム/システムの詳細設定/詳細設定/環境変数で設定可能です。</font><li><code><font face="ＭＳ Ｐゴシック">
				%HOME%</font></code><font face="ＭＳ Ｐゴシック"><br>
				環境変数 HOME で指定したフォルダです。
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">%USERPROFILE%</font></code><font face="ＭＳ Ｐゴシック"><br>
				環境変数 USERPROFILE で指定されているフォルダです。Windowsでは、デフォルトで設定されています。</font><li><code><font face="ＭＳ Ｐゴシック">
				%HOMEDRIVE%%HOMEPATH%</font></code><font face="ＭＳ Ｐゴシック"><br>
				環境変数 HOMEDRIVE と HOMEPATH 
				によって指定されているフォルダです。Windowsでは、デフォルトで設定されています。
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">実行したnodoka.exe</font></code><font face="ＭＳ Ｐゴシック"> 
				が存在するディレクトリ<br>
				ほとんどの場合、インストール先となります。</font></ul>
			  
			</div>
		  </dl>
		</div>
		
	    <dt class="h2"><font face="ＭＳ Ｐゴシック"><a name="cond">viii. 条件分岐</a>
		
	    </font>
		
	    <dd class="d2">
		<div>
		  <p><font face="ＭＳ Ｐゴシック">シンボルを定義して、そのシンボルによって条件分岐させることができます。</font></p>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">define <em>シンボル</em><br>
		  if ( <em>シンボル</em> )<br>
		  〜<br>
		  else<br>
		  〜<br>
		  endif
		  </font>
		  </p>
		  
		  <font face="ＭＳ Ｐゴシック">例えば次のように記述すると、
		  
		  </font>
		  
		  <p class="sample">
		  <font face="ＭＳ ゴシック">if ( SwapAB )<br>
		  &nbsp;key *A = *B<br>
		  &nbsp;key *B = *A<br>
		  endif
		  </font>
		  </p>
		  
		  <p class="continue"><code><font face="ＭＳ Ｐゴシック">SwapAB</font></code><font face="ＭＳ Ｐゴシック"> 
			というシンボルが  
			</font> <code><font face="ＭＳ Ｐゴシック">define</font></code><font face="ＭＳ Ｐゴシック"> 
			されている場合に、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
			と  
			</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
			を入れ替えます。</font></p>
		  
		  <p><font face="ＭＳ Ｐゴシック">「<a href="MANUAL-ja.html#menu-s">設定(<u>S</u>)...</a>」で  
			</font> <code><font face="ＭＳ Ｐゴシック">-Dシンボル名</font></code><font face="ＭＳ Ｐゴシック"> 
			を書くことでシンボルを定義することができます。</font></p>
		</div>
		
	    <dt class="h2"><a name="function"><font face="ＭＳ Ｐゴシック">ix. </font> <code><em>
		<font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
		リファレンス</font></a><font face="ＭＳ Ｐゴシック">
		</font>
		
	    <dd class="d2">
		<div>
		  <dl class="function">
			
		    <dt class="h3"><a name="function_CancelPrefix"><code>
			<font face="ＭＳ Ｐゴシック">&amp;CancelPrefix</font></code></a><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">現在、Prefixキーが押されている状態を、解除します。<br>
				One Shotモディファイヤーに指定しているキーを離した際に、Prefixを解除することなどに使用可能です。<br>
　</font></div>
			
		    <dt class="h3"><a name="function_ClipboardCopy"><code>
			<font face="ＭＳ Ｐゴシック">&amp;ClipboardCopy(<em>text</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><code><em><font face="ＭＳ Ｐゴシック">text</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a>をクリップボードへコピーします。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key S-F3 = &amp;ClipboardCopy(文字列)
				</font>
			  </p>
				もし、そうではなくて、現在選択されているものをクリップボードにコピーしたい場合には、C-C を お使いください。<br>
				<font face="ＭＳ Ｐゴシック">
				
				<br>
				また次のようにすると、クリップボード経由で、指定した任意の文字列を入力します。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key S-F3 = &amp;ClipboardCopy(文字列) &amp;Sync C-V</font></p>
				クリップボード経由にしたくない場合には、<a href="#function_SetForegroundWindow">&amp;SendText()</a>も任意の文字列入力に使用可能です。<br>
				<br>
			</div>
			
		    <dt class="h3"><a name="function_ClipboardUpcaseDowncaseWord"><code>
			<font face="ＭＳ Ｐゴシック">&amp;ClipboardDowncaseWord</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;ClipboardUpcaseWord</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">それぞれ、クリップボードの中身の文字を大文字化又は小文字化します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Default"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Default</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">入力されたキーをそのまま Windows 
				へ入力します。そのため、「のどか」を起動してない時と同じ動作が期待できます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_DescribeBindings"><code>
			<font face="ＭＳ Ｐゴシック">&amp;DescribeBindings</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><code><font face="ＭＳ Ｐゴシック">&amp;DescribeBindings</font></code><font face="ＭＳ Ｐゴシック"> 
				は、現在のキーマップでどのようなキー操作をするとどのような動作が起こるかをログウィンドウに表示します。<br>
				　デフォルトの </font><code>
		<font face="ＭＳ Ｐゴシック"><a href="dot.nodoka.txt">dot.nodoka</a></font></code><font face="ＭＳ Ｐゴシック"> 
				では、Ctrl-Alt-D に定義しています。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_DirectSSTP"><code>
			<font face="ＭＳ Ｐゴシック">&amp;DirectSSTP(/<em>name</em>/, <em>protocol</em> <em>
			[</em>, <em>header ...]</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック"><a href="http://sakura.mikage.to/directsstp.html" target="_top">
				Direct</a> <a href="http://sakura.mikage.to/sstp.html" target="_top">
				SSTP</a> プロトコルをしゃべります。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">/name/</font></em></code><font face="ＭＳ Ｐゴシック"> 
				にマッチする名前のゴーストへリクエストを Direct SSTP を使用して送ります。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">protocol</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> を省略すると  
				</font> <code><font face="ＭＳ Ｐゴシック">NOTIFY SSTP/1.1</font></code><font face="ＭＳ Ｐゴシック"> 
				になります。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">header</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> にカンマで区切ってヘッダを書き並べます。</font><code><font face="ＭＳ Ｐゴシック">Sender</font></code><font face="ＭＳ Ｐゴシック"> 
				ヘッダを省略すると「のどか」の名前が挿入されます。</font><code><font face="ＭＳ Ｐゴシック">HWnd</font></code><font face="ＭＳ Ｐゴシック"> 
				ヘッダと  
				</font> <code><font face="ＭＳ Ｐゴシック">Charset</font></code><font face="ＭＳ Ｐゴシック"> 
				ヘッダは「のどか」が適切に指定するので引数として指定してはいけません。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">
				選択肢などを表示しても答えを受け取ることはできませんが、「のどか」はゴーストから返事を 5 秒間待ちます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key F12 = \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&amp;DirectSSTP(/カレン/, \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SEND SSTP/1.2&quot;, \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Script: &quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\1こんにちわ&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\_w[1000]\\0\\s3カレンのこと呼んだ？&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\_w[1000]\\1＞みんな&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\_w[1000]\\0\\s4\\n\\n……。&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\e&quot; ) \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&amp;DirectSSTP(/双葉/, \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SEND SSTP/1.2&quot;, \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Sender: まゆ&quot;, \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Script: &quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\_w[1000]\\0よばれてますよただきちさん。&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\_w[1000]\\1きにするな。&quot; \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\\e&quot; )<br>
			  </font>
			  </p>
			</div>
			
		    <dt class="h3"><a name="function_EditNextModifier"><code>
			<font face="ＭＳ Ｐゴシック">&amp;EditNextModifier(<em>モディファイヤ</em>)</font></code></a><font face="ＭＳ Ｐゴシック">と 
			Sticky-Shift
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">次にユーザーがキーを入力した時に、</font><code><em><font face="ＭＳ Ｐゴシック">モディファイヤ</font></em></code><font face="ＭＳ Ｐゴシック"> 
				が押されていることにします。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key ESC = &amp;EditNextModifier(M-)
				</font>
			  </p>
			</div>
			
			<p class="continue"><font face="ＭＳ Ｐゴシック">とすると、</font><kbd><font face="ＭＳ Ｐゴシック">Alt</font></kbd><font face="ＭＳ Ｐゴシック"> 
			+ 
			</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
			などを  
			</font> <kbd><font face="ＭＳ Ｐゴシック">ESCAPE</font></kbd><font face="ＭＳ Ｐゴシック">
			</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
			などで代用することが可能になります。<br>
			<br>
			　例えば、Sticky-Shift と呼ばれる任意のキーを押したときに、次のキーはシフト有りとするには、以下の記述となります。</font></p>
			
			<div>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key Space = &amp;EditNextModifier(S-)
				</font>
			  </p>
			</div>
			
			<p class="continue"><font face="ＭＳ Ｐゴシック">
			　この例では、スペースを押すと、次に入力するキーは、シフト有りとなります。</font></p>
			
		    <dt class="h3"><a name="function_EmacsEditKillLine"><code>
			<font face="ＭＳ Ｐゴシック">&amp;EmacsEditKillLineFunc</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;EmacsEditKillLinePred</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">エディットコントロールで emacs の kill-line 
				のような機能を実現します。使い方は 
				</font> <a href="./emacsedit.nodoka.txt"><code>
				<font face="ＭＳ Ｐゴシック">emacsedit.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を参照のこと。</font></p>
			  <p><font face="ＭＳ Ｐゴシック">kill-line は非常にややこしい処理をしています。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">まず、</font><code><font face="ＭＳ Ｐゴシック">C-k</font></code><font face="ＭＳ Ｐゴシック"> 
				の期待される動作は、</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(C-k-1)</strong> 
				カーソルが行末にある場合、クリップボードに改行を追加してテキストからは改行を削除する。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(C-k-2)</strong> 
				カーソルが行末以外の場合、行末までをクリップボードに追加して行末までのテキストを削除。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">です。「のどか」での定義は、</font><a href="./emacsedit.nodoka.txt"><code><font face="ＭＳ Ｐゴシック">emacsedit.nodoka</font></code></a><font face="ＭＳ Ｐゴシック"> 
				では、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keyseq $EmacsEdit/kill-line = \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&amp;EmacsEditKillLineFunc S-End C-X &amp;Sync \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&amp;EmacsEditKillLinePred((Delete), (Return Left))
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">こうなってるはずです。</font><p>
			  
			  <p><a href="#function_EmacsEditKillLine"><code>
				<font face="ＭＳ Ｐゴシック">&amp;EmacsEditKillLineFunc</font></code></a><font face="ＭＳ Ｐゴシック"> 
				は初回だけ、クリップボードの中身をクリアします。初回でない場合は、クリップボードの中身を「のどか」内部に保存 <strong>
				(※)</strong> します。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">その後 </font> <code><font face="ＭＳ Ｐゴシック">
				S-End C-X</font></code><font face="ＭＳ Ｐゴシック"> 
				で行末までを選択し「切り取り」ます。ここで、クリップボードに行末までがコピーされたわけですが、クリップボードの中身には幾つか可能性があります。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">EDIT コントロールの場合</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(EDIT-1)</strong> 
				カーソルが行末にあると、「」(からっぽ)</font></p>
			  <p><font face="ＭＳ Ｐゴシック"><strong>(EDIT-2)</strong> 
				カーソルが行末以外だと、「行末までの文字列」</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">です。IE の中のエディットボックスの場合、</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(IE-1)</strong> カーソルが行末にあると、「改行」</font></p>
			  <p><font face="ＭＳ Ｐゴシック"><strong>(IE-2)</strong> 
				カーソルが行末以外だと、「行末までの文字列＋改行」</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">です。</font></p>
			  
			  <p><a href="#function_EmacsEditKillLine"><code>
				<font face="ＭＳ Ｐゴシック">&amp;EmacsEditKillLinePred</font></code></a><font face="ＭＳ Ｐゴシック"> 
				は、クリップボードの中身を調べて、</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(EDIT-1)</strong> の場合は、<strong>※</strong>で保存したデータに「改行」を追加してクリップボードへ書き戻します。その後、第一引数、つまり  
				</font> <code><font face="ＭＳ Ｐゴシック">Delete</font></code><font face="ＭＳ Ｐゴシック"> 
				を実行します。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(EDIT-2)</strong> の場合は、<strong>※</strong>で保存したデータに「行末までの文字列」を追加してクリップボードへ書き戻します。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(IE-1)</strong> の場合は、<strong>※</strong>で保存したデータに「改行」を追加してクリップボードへ書き戻します。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック"><strong>(IE-2)</strong> の場合は、<strong>※</strong>で保存したデータに「行末までの文字列(改行は除く)」を追加してクリップボードへ書き戻します。その後、第二引数、つまり  
				</font> <code><font face="ＭＳ Ｐゴシック">Return Left</font></code><font face="ＭＳ Ｐゴシック"> 
				を実行します。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">このように動作することで <strong>(EDIT-1)</strong> と <strong>
				(IE-1)</strong> は <strong>(C-k-1)</strong> 相当、<strong>(EDIT-2)</strong>  
				と <strong>(IE-2)</strong> は <strong>(C-k-2)</strong> 相当になります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_HelpMessage"><code>
			<font face="ＭＳ Ｐゴシック">&amp;HelpMessage(<em>title</em>, <em>message</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				通知領域(タスクトレイ、タスクバー)の、のどかのアイコン付近にメッセージを表示します。</font><code><em><font face="ＭＳ Ｐゴシック">title</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> と  
				</font> <code><em><font face="ＭＳ Ｐゴシック">message</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> を省略すると、表示されているメッセージを消します。</font></p>
				<p><font face="ＭＳ Ｐゴシック">インストールされている Internet Explorer 
				のバージョンによっては、挙動が異なります。Windows 2000では、表示した後、消えないようですが、Vista 
				では表示後、３０秒程度で何もしなくても消えます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_HelpVariable"><code>
			<font face="ＭＳ Ｐゴシック">&amp;HelpVariable(<em>title</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">通知領域(タスクトレイ、タスクバー)の、のどかのアイコン付近に </font> <a href="#function_Variable"><code>
				<font face="ＭＳ Ｐゴシック">&amp;Variable</font></code></a><font face="ＭＳ Ｐゴシック"> 
				で設定された値が  
				</font> <code><em><font face="ＭＳ Ｐゴシック">title</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> と共に表示されます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_IconColor"><code>
			<font face="ＭＳ Ｐゴシック">&amp;IconColor(<em>color</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				通知領域（タスクトレイ）における「のどか」のアイコンの色を指定します。colorには、下記 表の0から7が指定可能です。<br>
				<br>
					<img border="0" src="icon0.png"></font><p>
				<font face="ＭＳ Ｐゴシック">
				注1. Windows 2000では、アイコンの色数が16色のため、異なる色となります。<br>
				<br>
				nodoka.exe の引数( -c0〜-c7 )でも、アイコンの色を指定可能です。既に起動済みの場合にも、色だけ変更指示することが可能です。<br>
				コマンドプロンプトで、のどかインストールディレクトリに移動し、nodoka -c2[enter] 
				を実行すると、アイコンの色が赤色に変更されます。<br>
				<br>
				引数を付けなければ、アイコンの色は変更されません。4.03以前では、二重起動のエラーダイアログ 
				が表示されましたが、4.04以降では表示されません。<br>
				<br>
				スタートアップなどのショートカットでは、プロパティでのリンク先に、&quot;C:\Program 
				Files\nodoka\nodoka.exe&quot; -c2 のように指定することで、指定の色で起動するようになります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Ignore"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Ignore</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">なにも起こりません。なにも実施しないがベルを鳴らしたい場合には、</font><a href="#function_Undefined"><code><font face="ＭＳ Ｐゴシック">&amp;Undefined</font></code>
				</a>を お使いください。</p>
			</div>
			
		    <dt class="h3"><a name="function_InvestigateCommand"><code>
			<font face="ＭＳ Ｐゴシック">&amp;InvestigateCommand</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">ウィンドウへ送られてくる </font> <code>
				<font face="ＭＳ Ｐゴシック">WM_COMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <code><font face="ＭＳ Ｐゴシック">WM_SYSCOMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
				を調べ ログに出力します。トグルになっていますので、調査が終わったらもう一度この  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を実行してください。さもないとアプリケーションの実行速度が遅くなる可能性があります。ログの出力は  
				</font> <a href="#function_PostMessage"><code>
				<font face="ＭＳ Ｐゴシック">&amp;PostMessage</font></code></a><font face="ＭＳ Ｐゴシック"> 
				や <a href="#function_SendPostMessage">&amp;SendPostMessage</a> 
				で使用することが出来ます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Keymap"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Keymap(<em>キーマップ名</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">別のキーマップのキーを指定します。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap sub : Global<br>
			  &nbsp;key C-A = &amp;WindowMinimize<br>
			  window EditControl /:Edit$/ : Global<br>
			  &nbsp;key C-A = &amp;Keymap(sub) </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				というように利用します。この場合、エディットコントロールで  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、最小化されます。あまり実用的な機能はないかもしれません。ループしないように気をつけて利用してください。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_KeymapParent"><code>
			<font face="ＭＳ Ｐゴシック">&amp;KeymapParent</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック"><a href="#parentKeymap">親キーマップ</a>参照。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_KeymapPrevPrefix"><code>
			<font face="ＭＳ Ｐゴシック">&amp;KeymapPrevPrefix</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在のキーマップ (仮に </font> <code>
				<font face="ＭＳ Ｐゴシック">CURRENT</font></code><font face="ＭＳ Ｐゴシック"> 
				という名前とする) が二段階キーマップの場合、</font><a href="#function_Prefix"><code><font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><code><font face="ＭＳ Ｐゴシック">(CURRENT</font><font face="ＭＳ Ｐゴシック">)</font></code><font face="ＭＳ Ｐゴシック"> 
				を実行したキーマップで定義されているキーを指定します。引数が無いと 1 
				段階前のキーマップになりますが、引数に数字を書くとその段階数前のキーマップになります。たとえば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap E<br>
			  &nbsp;key A = &amp;KeymapPrevPrefix(2)<br>
			  keymap D<br>
			  &nbsp;key X = &amp;Prefix(E)<br>
			  &nbsp;key A = D<br>
			  keymap C<br>
			  &nbsp;key X = &amp;Prefix(D)<br>
			  &nbsp;key A = C<br>
			  &nbsp;key Y = &amp;Prefix(E)<br>
			  keymap B<br>
			  &nbsp;key X = &amp;Prefix(C)<br>
			  &nbsp;key A = B<br>
			  keymap Global<br>
			  &nbsp;key X = &amp;Prefix(B)<br>
			  &nbsp;key A = A
			  </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">ここで </font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と入力すると  
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が、</font><kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">Y</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と入力すると  
				</font> <kbd><font face="ＭＳ Ｐゴシック">B</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_KeymapWindow"><code>
			<font face="ＭＳ Ｐゴシック">&amp;KeymapWindow</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在のウィンドウに定義されたキーマップのキーを入力します。プレフィックスキーの入力中に使用すると便利です。例えば</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap2 NotepadC-X<br>
			  &nbsp;key A = &amp;KeymapWindow<br>
			  window Notepad /:Notepad:Edit$/ : Global<br>
			  &nbsp;key C-X = &amp;Prefix(NotepadC-X)<br>
			  &nbsp;key A = T E S T
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">この場合、メモ帳で </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押した後に  
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、</font><code><font face="ＭＳ Ｐゴシック">&amp;KeymapWindow</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <code><font face="ＭＳ Ｐゴシック">Nodepad</font></code><font face="ＭＳ Ｐゴシック"> 
				キーマップに定義されているキーを入力しようとします。従って、</font><code><font face="ＭＳ Ｐゴシック">TEST</font></code><font face="ＭＳ Ｐゴシック"> 
				が入力されます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_LoadSetting"><code>
			<font face="ＭＳ ゴシック">&amp;LoadSetting</font><font face="ＭＳ Ｐゴシック">(<em>&quot;設定名&quot;</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">設定ファイルを再読み込みします。&quot;</font><code><font face="ＭＳ Ｐゴシック"><em>設定名</em></font></code><font face="ＭＳ Ｐゴシック">&quot;</font><code><font face="ＭＳ Ｐゴシック"><em> </em></font></code><font face="ＭＳ Ｐゴシック"> &nbsp;<a href="#string">文字列</a> は「設定(I)...」で設定した「名前」
				を &quot;で囲みます。</font><code><em><font face="ＭＳ Ｐゴシック">設定名</font></em></code><font face="ＭＳ Ｐゴシック">を省略すると現在の設定を再読み込みします。</font></p>
			</div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック"><a name="function_MouseHook">
			<font face="ＭＳ ゴシック">&amp;MouseHook</font>(<em>type, parameter</em>)</a></font></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  　マウスイベントをフックし <b><i>type</i></b> で指定されるアクションに変換します。<b><i>parameter</i></b> 
				は整数値で、<i><b>type</b></i> ごとに意味が異なります。指定できる <i><b>type parameter
				</b></i>は以下の通りです。<ul>
				<li>None [初期値]<br>
				変換しません。<i><b>parameter</b></i> は無視されます。他の <i><b>type</b></i> 
				から元に戻す場合に使用します。</li>
				<li>Wheel<br>
				マウスの垂直方向の移動をホイールの回転に変換します。変換中でもマウスカーソルは移動しません。<br>
				<i><b>parameter </b></i>は、変換時の倍率であり、正あるいは負の値を記述することで逆回転を指定できます。</li>
				<li>WindowMove<br>
				マウスの移動をウィンドウの移動に変換します。変換中でもマウスカーソルは動きます。<br>
				<i><b>parameter</b></i> は、移動するウィンドウの指定で、1 
				はアクティブウィンドウ、2はマウスカーソル位置のウィンドウを示します。また符号をつけて負の値にすると、対応するMDI子ウィンドウを移動します。<br>
				<br>
				例えば、下記の設定例では、Ctrl-Shift-A 
				を押したら、現在アクティブなウィンドウを、マウスで移動させ、キーを押すのをやめたら終了します。</li>
				</ul>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option mouse-event = enable<br>
				<br>
				key D-C-S-A = &amp;MouseHook(WindowMove, 1)<br>
				key U-C-S-A = &amp;MouseHook(None, 0)<br>
			  　</font></p>
				<p>　その他の使用例は、<a href="thumbsense.nodoka.txt">thumbsense.nodoka</a> 
				あるいは、<a href="#def_option_ts4nodoka">def_option_ts4nodoka</a> 
				を御覧ください。</p>
				<p>　</p>
			</div>
			
		    <dt class="h3"><code>
			<a name="function_MouseMonitor">
			<font face="ＭＳ ゴシック">&amp;MouseMonitor</font><font face="ＭＳ Ｐゴシック">(<em>monitor</em>)</font></a></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				複数のディスプレイを用いたマルチモニタ環境において、マウスポインタを、指定したモニタに移動させます。<br>
				マウスポインタ位置は、移動先のディスプレイの中心位置となります。<br>
				<br>
				引数の</font><a name="function_MouseWheel2"><code><font face="ＭＳ Ｐゴシック"><em>monitor</em></font></code></a>は、数字で指定します。<code><font face="ＭＳ Ｐゴシック">0</font></code><font face="ＭＳ Ｐゴシック"> 
				が基準(primary)となるモニタ、</font><code><font face="ＭＳ Ｐゴシック">1</font></code><font face="ＭＳ Ｐゴシック">: 
				次のモニタ、</font><code><font face="ＭＳ Ｐゴシック">2</font></code><font face="ＭＳ Ｐゴシック">: 
				次の次のモニタ…、</font><code><font face="ＭＳ Ｐゴシック">-1</font></code><font face="ＭＳ Ｐゴシック">: 
				前のモニタ、</font><code><font face="ＭＳ Ｐゴシック">-2</font></code><font face="ＭＳ Ｐゴシック">: 
				前の前のモニタ…、を意味します。<br>
				<a name="3monitor">モニターの数が3個以上となったとき</a>に、Windowsのコントロールパネル/ディスプレイ/画面の解像度で設定した各ディスプレイの位置と一致せず、次のモニターあるいは前のモニターがどれになるか不定でしたが、Ver4.27からprimaryから見て右側にあるモニタが次のモニター、左側にあるモニタが前のモニタになるよう修正しました。</font></div>
			
		    <dt class="h3"><code>
			<a name="function_MouseMonitorTo">
			<font face="ＭＳ ゴシック">&amp;MouseMonitorTo</font><font face="ＭＳ Ｐゴシック">(<em>from</em></font></a><a name="function_MouseMoveTo0"><font face="ＭＳ Ｐゴシック">, </font></a></code>
			<a name="function_MouseWheel3"><code>
			<font face="ＭＳ Ｐゴシック"><em>monitor</em></font></code></a><a name="function_MouseWheel1"><code><font face="ＭＳ Ｐゴシック">)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				複数のディスプレイを用いたマルチモニタ環境において、マウスポインタを、</font><code><em><font face="ＭＳ Ｐゴシック">from</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を基準としてモニタ </font><code><em><font face="ＭＳ Ｐゴシック">monitor</font></em></code><font face="ＭＳ Ｐゴシック"> 
				へ移動します。<br>
				なおポインタ位置は、移動先のディスプレイの中心位置となります。<br>
				</font><code><em><font face="ＭＳ Ｐゴシック">　from</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、次のものが指定できます。</font><ul>
			    <li><code><font face="ＭＳ Ｐゴシック">primary</font></code><font face="ＭＳ Ｐゴシック"> 
				: プライマリモニタを基準とします</font></li>
			    <li><code><font face="ＭＳ Ｐゴシック">current</font></code><font face="ＭＳ Ｐゴシック"> 
				: 現在マウスポインタがあるモニタを基準とします</font></li>
			  </ul>

			  <p><code><em><font face="ＭＳ Ｐゴシック">monitor</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、数字が指定できます。</font><code><font face="ＭＳ Ｐゴシック">0</font></code><font face="ＭＳ Ｐゴシック"> 
				が基準となるモニタ、</font><code><font face="ＭＳ Ｐゴシック">1</font></code><font face="ＭＳ Ｐゴシック">: 
				次のモニタ、</font><code><font face="ＭＳ Ｐゴシック">2</font></code><font face="ＭＳ Ｐゴシック">: 
				次の次のモニタ…、</font><code><font face="ＭＳ Ｐゴシック">-1</font></code><font face="ＭＳ Ｐゴシック">: 
				前のモニタ、</font><code><font face="ＭＳ Ｐゴシック">-2</font></code><font face="ＭＳ Ｐゴシック">: 
				前の前のモニタ…、を意味します。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				モニターの数が3個以上となったときに、Windowsのコントロールパネル/ディスプレイ/画面の解像度で設定した各ディスプレイの位置と一致せず、次のモニターあるいは前のモニターがどれになるか不定でしたが、Ver4.27からprimaryから見て右側にあるモニタが次のモニター、左側にあるモニタが前のモニタになるよう修正しました。</font></p>
			  </div>
			
		    <dt class="h3"><a name="function_MouseMove"><code>
			<font face="ＭＳ ゴシック">&amp;MouseMove</font><font face="ＭＳ Ｐゴシック">(<em>dx</em>, <em>dy</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			<dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">マウスポインタを、水平に </font> <code><em>
				<font face="ＭＳ Ｐゴシック">dx</font></em></code><font face="ＭＳ Ｐゴシック">、垂直に  
				</font> <code><em><font face="ＭＳ Ｐゴシック">dy</font></em></code><font face="ＭＳ Ｐゴシック"> 
				移動します。</font></p>
			</div>
			
		    <dt class="h3"><code>
			<a name="function_MouseMoveTo">
			<font face="ＭＳ ゴシック">&amp;MouseMoveTo</font><font face="ＭＳ Ｐゴシック">(<em>gravity</em></font><font face="ＭＳ Ｐゴシック">, 
			<em>dx</em>, <em>dy [</em>, <em>true]</em>)</font></a></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <pre>現在マウスポインタが存在するモニターのデスクトップ内で、マウスポインタを基準位置から水平方向に <code><em><font face="ＭＳ Ｐゴシック">dx</font></em></code>、垂直方向に <code><em><font face="ＭＳ Ｐゴシック">dy</font></em></code> 移動します。
<code><em><font face="ＭＳ Ｐゴシック">true</font></em></code> を引数の最後に追加指定すると、デスクトップ内ではなく、現在アクティブなアプリケーションのウィンドウ内での移動となります。
基準位置として<code><em><font face="ＭＳ Ｐゴシック">gravity</font></em></code> には、次のものが指定できます。</pre>
				<ul>
			    <li><code><font face="ＭＳ Ｐゴシック">C</font></code><font face="ＭＳ Ｐゴシック"> 
				: 中心位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">N</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向はデスクトップの上からの相対位置、左右方向は現在位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">E</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向は現在位置からの相対位置、左右方向はデスクトップの右からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">W</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向は現在位置からの相対位置、左右方向はデスクトップの左からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">S</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向はデスクトップの下からの相対位置、左右方向は現在位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">NE</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ右上からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">NW</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ左上からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">SE</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ右下からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">SW</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ左下からの相対位置に移動。
			   
				</font>
			  </ul>
			  
			  </div>
			
		    <dt class="h3"><a name="function_MouseWheel0"><code>
			<font face="ＭＳ ゴシック">&amp;MouseWheel</font><font face="ＭＳ Ｐゴシック">(<em>delta</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">ホイールを回します。</font><code><em><font face="ＭＳ Ｐゴシック">delta</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を  
				</font> <code><font face="ＭＳ Ｐゴシック">-120</font></code><font face="ＭＳ Ｐゴシック"> 
				にするとホイールを手前に 1 単位まわしたことになります。逆に  
				</font> <code><font face="ＭＳ Ｐゴシック">120</font></code><font face="ＭＳ Ｐゴシック"> 
				にするとホイールを奥へ 1 単位まわしたことになります。</font></div>
			
		    <dt class="h3"><code>
			<a name="function_NodokaDialog">
			<font face="ＭＳ Ｐゴシック">&amp;NodokaDialog(<em>dialog</em>, <em>
			show_command</em>)</font></a><font face="ＭＳ Ｐゴシック">,
			<font color="#FFFFFF">&amp;MayuDialog(</font></font><a name="function_NodokaDialog0"><font face="ＭＳ Ｐゴシック"><em>dialog</em>, <em>
			show_command</em>)</font></a></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">「のどか」のダイアログボックスを表示したり隠したりします。</font><code><em><font face="ＭＳ Ｐゴシック">dialog</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には  
				</font> <code><font face="ＭＳ Ｐゴシック">Investigate</font></code><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <code><font face="ＭＳ Ｐゴシック">Log</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定できます。それぞれ「調査」ダイアログと「ログ」ダイアログです。</font><code><em><font face="ＭＳ Ｐゴシック">show_command</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、</font><code><font face="ＭＳ Ｐゴシック">HIDE</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">SHOW</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">SHOWNA</font></code><font face="ＭＳ Ｐゴシック"> 
				などが指定できます。&amp;MayuDialog()表記でも使用可能です。</font></div>
			
		    <dt class="h3"><a name="function_OtherWindowClass"><code>
			<font face="ＭＳ Ｐゴシック">&amp;OtherWindowClass</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><a href="#matchManyClasses"><code><font face="ＭＳ Ｐゴシック">window</font></code><font face="ＭＳ Ｐゴシック"> 
				に複数該当する場合</font></a><font face="ＭＳ Ｐゴシック">参照。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_PlugIn"><code>
			<font face="ＭＳ Ｐゴシック">&amp;PlugIn(<em>DLLNAME</em>, <em>FUNCNAME</em>, <em>
			FUNCPARAM</em>, <em>runAsThread</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">プラグインを実行します。</font><code><font face="ＭＳ Ｐゴシック">nodoka.exe</font></code><font face="ＭＳ Ｐゴシック"> 
				のあるディレクトリの中の  
				</font> <code><font face="ＭＳ Ｐゴシック">Plugins</font></code><font face="ＭＳ Ｐゴシック"> 
				というディレクトリにプラグイン DLL を置いておくとそのプラグインの中の関数を「のどか」から直接呼ぶことが出来ます。</font></p>

			  <p><code><em><font face="ＭＳ Ｐゴシック">DLLNAME</font></em></code><font face="ＭＳ Ｐゴシック"> 
				はプラグイン DLL 名です。</font><code><font face="ＭＳ Ｐゴシック">Plugins\<em>DLLNAME</em>.dll</font></code><font face="ＭＳ Ｐゴシック"> 
				が使用されます。</font></p>

			  <p><code><em><font face="ＭＳ Ｐゴシック">FUNCNAME</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は DLL 中の関数名です。DLL 
				は、以下の関数のうちのどれか実装していなければなりません。この引数は省略することができます。省略すると空文字列になります。</font></p>

			  <p class="sample">
			  <font face="ＭＳ ゴシック">void WINAPI nodoka<em>FUNCNAME</em>W(const 
				wchar_t *<em>FUNCPARAM</em>);<br>
			  void WINAPI nodoka<em>FUNCNAME</em>A(const char *<em>FUNCPARAM</em>);<br>
			  void WINAPI nodoka<em>FUNCNAME</em>(const char *<em>FUNCPARAM</em>);<br>
			  void WINAPI mayu<em>FUNCNAME</em>W(const wchar_t *<em>FUNCPARAM</em>);<br>
			  void WINAPI mayu<em>FUNCNAME</em>A(const char *<em>FUNCPARAM</em>);<br>
			  void WINAPI mayu<em>FUNCNAME</em>(const char *<em>FUNCPARAM</em>);<br>
			  void WINAPI <em>FUNCNAME</em>(const char *<em>FUNCPARAM</em>);
			  </font>
			  </p>

			  <p><code><em><font face="ＭＳ Ｐゴシック">FUNCPARAM</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は DLL の関数を呼び出すときに渡される引数です。省略すると空文字列 (</font><code><font face="ＭＳ Ｐゴシック">NULL</font></code><font face="ＭＳ Ｐゴシック"> 
				ではない) になります。</font></p>

			  <p><code><em><font face="ＭＳ Ｐゴシック">runAsThread</font></em></code><font face="ＭＳ Ｐゴシック"> 
				に  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定すると指定の関数をスレッドの中で実行します。省略すると  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されたことになります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				「窓使いの憂鬱」用のプラグインも、読み込める状態に修正しましたが、動作未確認です。 なお、<a href="MANUAL-ja.html#REFERENCES">いくつかの著名なプラグインについて</a>は、リビルドして、<a target="_blank" href="http://www.appletkan.com/nodoka.htm">こちらで 
				配布しています。 </a></font></p>
			</div>
			
		    <dt class="h3"><a name="function_PostMessage"><code>
			<font face="ＭＳ Ｐゴシック">&amp;PostMessage(<em>window</em>, <em>message</em>, <em>
			wParam</em>, <em>lParam</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブとなっているウィンドウへメッセージを送ることができます。高度な機能なので完全に理解してから利用してください。 
				任意のウィンドウへメッセージを送るには、<a href="#function_SendPostMessage">&amp;SendPostMessage()</a>を 
				お使いください。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keyseq $WM_CUT = &amp;PostMessage(ToItself, 
				0x0300, 0, 0)<br>
			  window EditControl /:Edit$/ : Global<br>
			  &nbsp;key C-W = $WM_CUT </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と書くと、一部のウィンドウで </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">W</font></kbd><font face="ＭＳ Ｐゴシック"> 
				でカットできるようになります。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">window</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、メッセージを送る先のウィンドウを指定します。以下の種類があります。</font></p>
			  
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">ToItself</font></code><font face="ＭＳ Ｐゴシック"> 
				はそのウィンドウ自身へ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">ToMainWindow</font></code><font face="ＭＳ Ｐゴシック"> 
				は最も親のウィンドウへ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">ToOverlappedWindow</font></code><font face="ＭＳ Ｐゴシック"> 
				は子でない最初のウィンドウへ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">ToParentWindow</font></code><font face="ＭＳ Ｐゴシック"> 
				は親ウィンドウへ。
			     
				</font>
			    <li><code><em><font face="ＭＳ Ｐゴシック">正の数</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <code><font face="ＭＳ Ｐゴシック">1</font></code><font face="ＭＳ Ｐゴシック">:親ウィンドウ、</font><code><font face="ＭＳ Ｐゴシック">2</font></code><font face="ＭＳ Ｐゴシック">:親の親、</font><code><font face="ＭＳ Ｐゴシック">3</font></code><font face="ＭＳ Ｐゴシック">:親の親の親…
			  	</font>
			  </ul>
			  
			  <p><font face="ＭＳ Ｐゴシック">どのようなメッセージを送ればよいかは Spy++ などで調べられますが、</font><code><font face="ＭＳ Ｐゴシック">WM_COMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
				(0x0111) と  
				</font> <code><font face="ＭＳ Ｐゴシック">WM_SYSCOMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
				(0x0112) については</font><a href="#function_InvestigateCommand"><code><font face="ＭＳ Ｐゴシック">&amp;InvestigateCommand</font></code></a><font face="ＭＳ Ｐゴシック"> 
				で調べることもできます。<br>
				　Spy++が手元にない場合には、<a target="_blank" href="http://www.windows-spy.com/">Winspector 
				(http://www.windows-spy.com/</a>) でも、同様の機能を備えているので、調査に使えます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Prefix"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Prefix(<em>キーマップ名</em>, <em>ignore_modifiers</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">プレフィックスキーを指定します。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">keymap2 NotepadC-X<br>
			  &nbsp;key C-C = &amp;WindowClose<br>
			  window Notepad /:Notepad:Edit$/ : Global<br>
			  &nbsp;key C-X = &amp;Prefix(NotepadC-X) </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">というように記述しておくと、メモ帳で  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
				</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">C</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と続けて入力するとメモ帳を終了することができます。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">ignore_modifiers</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は省略可能な引数で  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				か  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定します。省略すると  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されたとみなされます。</font><code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定された場合、</font><code><em><font face="ＭＳ Ｐゴシック">キーマップ名</font></em></code><font face="ＭＳ Ｐゴシック"> 
				で指示されるキーマップは</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;mod !shift !alt !control !windows \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!mod0 !mod1 !mod2 !mod3 !mod4 \<br>
			  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!mod5 !mod6 !mod7 !mod8 !mod9
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">
				が指定されたものとして扱われます。つまり、全てのモディファイヤが<a href="#trueModifier">真のモディファイヤ</a>として扱われるようになります。</font></p>

			  <p><a href="#keymap2"><code><font face="ＭＳ Ｐゴシック">keymap2</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を利用しているときには、デフォルトキーが  
				</font> <a href="#function_Undefined"><code>
				<font face="ＭＳ Ｐゴシック">&amp;Undefined</font></code></a><font face="ＭＳ Ｐゴシック"> 
				になっているので、モディファイヤを入力した時にもベルが鳴るはずですが、このように  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定しておけば鳴らなくなります。(</font><a href="#mod"><code><font face="ＭＳ Ｐゴシック">mod</font></code></a><font face="ＭＳ Ｐゴシック"> 
				を参照)</font></p>

			  <p><code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定すれば、2 
				ストローク目にモディファイヤキーそのものを使用することができる可能性がありますが、通常はそのような使用方法はしないと思われます。また、さまざまな問題により  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				の指定にはバグがありますので使用はオススメしません。</font></p>
			  
			  <blockquote>
			  <ol>
			    <li><font face="ＭＳ Ｐゴシック">キーの押す・離す、が順番に来ない場合
				</font>
				<div>
				  <p><font face="ＭＳ Ｐゴシック">例えば </font> <kbd>
					<font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
					+ 
					</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
					</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
					+ 
					</font> <kbd><font face="ＭＳ Ｐゴシック">L</font></kbd><font face="ＭＳ Ｐゴシック"> 
					という入力をユーザーがした場合、</font><code><font face="ＭＳ Ｐゴシック">D-C-X 
					U-C-X D-C-L U-C-L</font></code><font face="ＭＳ Ｐゴシック"> 
					という順序で入力されるのが正しいのですが、</font><kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
					は左手、</font><kbd><font face="ＭＳ Ｐゴシック">L</font></kbd><font face="ＭＳ Ｐゴシック"> 
					は右手で入力するため、  
					</font> <code><font face="ＭＳ Ｐゴシック">D-C-X D-C-L U-C-X U-C-L</font></code><font face="ＭＳ Ｐゴシック"> 
					という順序で入力されてしまうことがしばしばあります。</font></p>
				  
				  <p><font face="ＭＳ Ｐゴシック">ですから、現在の実装では </font> <a href="#function_Prefix"><code>
					<font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> 
					はキーダウン (</font><code><font face="ＭＳ Ｐゴシック">D-</font></code><font face="ＭＳ Ｐゴシック">) 
					部分でしか正しく動作しないようになっています。入力されるキーの順序が入れ替わるため、</font><code><font face="ＭＳ Ｐゴシック">U-</font></code><font face="ＭＳ Ｐゴシック"> 
					部分で  
					</font> <a href="#function_Prefix"><code>
					<font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> 
					が動作してしまうとおかしなことになるからです。(現在は中途半端に動作しているので、バグかもしれません。要調査)</font></p>
				</div>

			    <li><font face="ＭＳ Ｐゴシック">キーリピート
				</font>
				<div>
				  <p><font face="ＭＳ Ｐゴシック">キーリピートは、キーダウン (</font><code><font face="ＭＳ Ｐゴシック">D-</font></code><font face="ＭＳ Ｐゴシック">) 
					がたくさん入力されたあとに、キーアップ (</font><code><font face="ＭＳ Ｐゴシック">U-</font></code><font face="ＭＳ Ｐゴシック">) 
					が一度だけ入力されます。この場合に  
					</font> <a href="#function_Prefix"><code>
					<font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> 
					がどのように動作すべきかは自明ではありません。</font></p>
				</div>
				
			    <li><font face="ＭＳ Ｐゴシック">モディファイヤキーのキーマップ
				</font>
				<div>
				  <p><code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
					を指定した時に  
					</font> <kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
					+ 
					</font> <kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック">
					</font> <kbd><font face="ＭＳ Ｐゴシック">F</font></kbd><font face="ＭＳ Ｐゴシック"> 
					と入力したとします。</font><code><font face="ＭＳ Ｐゴシック">D-C-Control 
					D-C-X U-C-X U-Control D-F U-F</font></code><font face="ＭＳ Ｐゴシック"> 
					このような順序でキーが入力されますが、</font><code><font face="ＭＳ Ｐゴシック">U-Control</font></code><font face="ＭＳ Ｐゴシック"> 
					はどのキーマップで解釈されるべきでしょうか？</font></p>

				  <p><font face="ＭＳ Ｐゴシック">現在は、</font><a href="#function_Prefix"><code><font face="ＭＳ Ｐゴシック">&amp;Prefix</font></code></a><font face="ＭＳ Ｐゴシック"> 
					先のキーマップで解釈されていますが、モディファイヤを真のモディファイヤへ自動的に変換するため、</font><code><font face="ＭＳ Ｐゴシック">U-Control</font></code><font face="ＭＳ Ｐゴシック"> 
					は何の機能ももたないので、うまく動作しているように見えます。ですが、本来ならば元のキーマップで解釈されるべきなのでこれはバグなのですが、修正する予定はありません。</font></p>
				</div>
			  </ol>
			  </blockquote>

			</div>
			
		    <dt class="h3"><a name="function_Recenter"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Recenter</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				エディットコントロールかリッチエディットコントロールでのみ動作し、カレットの位置を縦方向の中央に移動させます。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Repeat"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Repeat(<em>キーシーケンス</em>, <em>最大回数</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <a href="#function_Variable"><code><font face="ＭＳ Ｐゴシック">&amp;Variable</font></code></a><font face="ＭＳ Ｐゴシック"> 
				で設定した回数だけ  
				</font> <code><em><font face="ＭＳ Ｐゴシック">キーシーケンス</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を実行します。ただし、実行しすぎると危険なので<em>最大回数</em>を指定できます。<em>最大回数</em>は省略することができ、その場合 
				10 回が最大になります。</font><p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key A = &amp;Variable(0, 10) &amp;Repeat((X))
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">上の例では、</font><kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を押すと、</font><kbd><font face="ＭＳ Ｐゴシック">X</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が 10 回入力されます 。</font></p>
			  
			</div>
			
		    <dt class="h3"><a name="function_SendPostMessage"><code>
				<font face="ＭＳ Ｐゴシック">&amp;SendPostMessage(<em>&quot;Send/Post/PostTray&quot;, 
			window class name, [window title name], message</em>, <em>wParam</em>, <em>
			lParam</em>)</font></code><font face="ＭＳ Ｐゴシック">
				</font></a>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">任意のウィンドウや、通知領域（タスクトレイ）のアイコンに、メッセージを送ります。 
				お試し版であり、将来仕様は変更されることがあります。また、複雑な機能のため、完全に理解してから お使いください。<br>
				なお、アクティブなウィンドウに、メッセージを送る場合には、<a href="#function_PostMessage">&amp;PostMessage()</a>を 
				お使いください。<br>
				<br>
				Windows 
				7において、通知領域のアイコンに、メッセージを送る場合、アイコンの表示と通知を行うよう、設定されていないと、操作できません。<br>
　</font><blockquote>
					<p><font face="ＭＳ Ｐゴシック">最初の引数に</font><code><em><font face="ＭＳ Ｐゴシック">&quot;Send&quot;
					</font></em></code><font face="ＭＳ Ｐゴシック">あるいは</font><code><em><font face="ＭＳ Ｐゴシック">&quot;Post&quot;
					</font></em></code><font face="ＭＳ Ｐゴシック">を指定すると、Win32 SDK の 
					SendMessage(), PostMessage() と同等の機能となります。通常は、終了を待たない </font><code><em><font face="ＭＳ Ｐゴシック">
					&quot;Post&quot;
					</font></em></code><font face="ＭＳ Ｐゴシック">&nbsp;を指定することになると考えます。</font></p>
					<p><code><em><font face="ＭＳ Ｐゴシック">window class name, window 
					title name&nbsp; </font></em></code>
					<font face="ＭＳ Ｐゴシック">には、メッセージを送る先のウィンドウクラス名やウィンドウタイトル名を 
					文字列で指定します。 Win32 SDK の FindWindow() の第１引数や第２引数と同じです。</font></p>
					<p><code><em><font face="ＭＳ Ｐゴシック">window title name </font>
					</em></code><font face="ＭＳ Ｐゴシック">は、省略可能です。</font></p>
					<p><code><em><font face="ＭＳ Ｐゴシック">message </font></em>
					</code><font face="ＭＳ Ｐゴシック">には、送りたいウィンドウメッセージID番号を、また <i>
					<b>wParam</b></i>,
					<i><b>lParam</b></i> には、適切な引数を指定する必要があります。これらは、Win32 SDK の 
					SendMessage() あるいは PostMessage() の第2,3,4引数と同じです。</font></p>
					<p class="sample"><font face="ＭＳ ゴシック">key S-F3 = 
					&amp;SendPostMessage(&quot;Post&quot;, &quot;nodokaTasktray&quot;,, 0x0010, 0, 0) </font></p>
					<p><font face="ＭＳ Ｐゴシック">
					上の例では、「のどか」の通知領域（タスクトレイ）上のアイコンに対し、WM_CLOSE (0x0010) 
					を送り、「のどか」を正常終了させます。</font></p>
					<p class="sample"><font face="ＭＳ ゴシック">key S-F3 = 
					&amp;SendPostMessage(Post, &quot;HWND_BROADCAST&quot;,, 0x0112, 0xf140, 0)</font></p>
					<p><font face="ＭＳ Ｐゴシック">上の例では、スクリーンセーバーを起動します。</font></p>
					<p><font face="ＭＳ Ｐゴシック">どのようなメッセージを送ればよいかは 
					Microsoft社の開発ツールである Visual Studio (Express版を除く) に付属してる Spy++ 
					などで調べられますが、</font><code><font face="ＭＳ Ｐゴシック">WM_COMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
					(0x0111) と  
				</font><code><font face="ＭＳ Ｐゴシック">WM_SYSCOMMAND</font></code><font face="ＭＳ Ｐゴシック"> 
					(0x0112) については  
				</font><a href="#function_InvestigateCommand"><code>
					<font face="ＭＳ Ｐゴシック">&amp;InvestigateCommand</font></code></a><font face="ＭＳ Ｐゴシック"> 
					で調べることもできます。<br>
					　 Spy++が手元にない場合には、<a target="_blank" href="http://www.windows-spy.com/">Winspector 
					(http://www.windows-spy.com/</a>) でも、同様の機能を備えているので、調査に使えます。</font></p>
				</blockquote>
				<blockquote>
					<p><font face="ＭＳ Ｐゴシック">最初の引数に</font><code><em><font face="ＭＳ Ｐゴシック">&quot;PostTray&quot;
					</font></em></code><font face="ＭＳ Ｐゴシック">
					を指定すると、通知領域（タスクトレイ）上のアイコンに対して、ウィンドウメッセージを送ります。</font></p>
					<p><font face="ＭＳ Ｐゴシック">この指定を行った場合、引数の与え方が変わり、３番目の</font><code><em><font face="ＭＳ Ｐゴシック">window 
					title name </font></em></code><font face="ＭＳ Ｐゴシック">
					にアイコンのタイトル名を指定します。部分一致で検索します。このタイトル名称は、ログウィンドウ 
					の詳細にチェックして、この機能を実行した際に、そのとき通知領域にあるアイコンごとにログに表示されますので、参考にしてください。</font></p>
					<p><code><em><font face="ＭＳ Ｐゴシック">message </font></em>
					</code><font face="ＭＳ Ｐゴシック">には、送りたいウィンドウメッセージID番号、<i><b>wParam</b></i>,
					<i><b>lParam</b></i> には、0 を指定します。</font></p>
					<p><font face="ＭＳ Ｐゴシック">2番目の引数 </font><code><em>
					<font face="ＭＳ Ｐゴシック">window class name </font></em></code><font face="ＭＳ Ｐゴシック">
					に実行ファイル名のフルパスを記述すると、通知領域 
					のアイコンが検出できなかったときに、その実行ファイルを実行します。なお記述しなければ、実行されません。</font></p>
					<p><font face="ＭＳ Ｐゴシック">以下は設定例となります。</font></p>
					<p class="sample"><font face="ＭＳ ゴシック"># 
					Tweenというアプリのウィンドウを開く。なお通知領域に居ない場合には、起動する。<br>key S-F2 = W-M 
					&amp;Sync &amp;SendPostMessage(&quot;PostTray&quot;,&quot;C:\\Program 
					Files\\Tween\\Tween.exe&quot;,&quot;Tween&quot;, 0x0202, 0, 0)<br>key S-F3 
					= &amp;SendPostMessage(&quot;PostTray&quot;, &quot;C:\\Program 
					Files\\Tween\\Tween.exe&quot;,&quot;Tween&quot;, 0x0202, 0, 0)<br>　</font></p>
					<p class="sample"><font face="ＭＳ ゴシック"># 
					のどかのログウィンドウを開く。<br>key S-F4 = 
					&amp;SendPostMessage(&quot;PostTray&quot;,,&quot;のどか&quot;, 0x0201, 0, 0)</font></p>
					<p class="sample"><font face="ＭＳ ゴシック"># のどかのメニューを開く<br>
					key F1 = &amp;SendPostMessage(&quot;PostTray&quot;,,&quot;のどか&quot;, 0x0205, 0, 0)</font></p>
					<p class="sample"><font face="ＭＳ ゴシック"># USBメモリの取り外しのためのウィンドウを開く。カーソルキーで選んでEnterで取り外せる。<br>key 
					S-F5 = &amp;SendPostMessage(&quot;PostTray&quot;,,&quot;ハードウェアの安全な取り外し&quot;, 
					0x0201, 0, 0)<br>
					#key S-F5 = 
					&amp;SendPostMessage(&quot;PostTray&quot;,,&quot;ハードウェアの取り外しまたは取り出し&quot;, 0x0201, 
					0, 0)&nbsp;&nbsp; # for W2K<br>
					#key S-F5 = &amp;SendPostMessage(&quot;PostTray&quot;,,&quot;Unplug or Eject 
					Hardware&quot;, 0x0201, 0, 0) # for W2K US</font></p>
					<p><code><em><font face="ＭＳ Ｐゴシック"><br>
					message </font></em>
					</code><font face="ＭＳ Ｐゴシック">
					に記述するウィンドウメッセージID番号において、マウスのクリックによるものは、次に示す番号となります。</font></p>
					<p><font face="ＭＳ Ｐゴシック">WM_LBUTTONDOWN 0x0201、WM_LBUTTONUP 
					0x0202、WM_LBUTTONDBLCLK 0x0203</font></p>
					<p><font face="ＭＳ Ｐゴシック">WM_RBUTTONDOWN 0x0204、WM_RBUTTONUP 
					0x0205、WM_RBUTTONDBLCLK 0x0206</font></p>
					<p><font face="ＭＳ Ｐゴシック">WM_MBUTTONDOWN 0x0207、WM_MBUTTONUP 
					0x0208、WM_MBUTTONDBLCLK 0x0209</font></p>
					<p>　</p>
					<p><font face="ＭＳ Ｐゴシック">
					アプリケーションによっては、マウスのボタンクリックに対する動作が実装されていない 
					場合、機能しないことがあります。例えば、左ボタンによるシングルクリックを試そうと送ってみても 
					WM_LBUTTONDOWN(0x0201) では無反応だが WM_LBUTTONUP(0x0202) 
					で動作するものもあります。<br>
					　また、Windowsの仕様により、例えば左ボタンクリックで、ダイアログやウィンドウが開くアプリケーションでも、最前面に表示されずに、タスクバーで点滅するのみとなることがあ 
					るので ご注意ください。</font></p>
				</blockquote>
			  
			</div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック"><a name="function_SendText">&amp;SendText(<em>text</em>)</a></font></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  	<font face="ＭＳ Ｐゴシック">　WinAPI SendInput()を用いて、<code><em>text</em></code> <a href="#string">
				文字列</a> を入力します。
				 
				<br>
				　例えば、次のように設定します。シフトキーを押しながらF5キーを押したときに、ab漢字 と入力。</font><p class="sample">
			  <font face="ＭＳ ゴシック">key S-F5 = &amp;SendText(&quot;ab漢字&quot;)
				</font>
			  </p>
				<p><font face="ＭＳ Ｐゴシック"> 
				制限事項として、IMEがオフの場合にオンになり、オフに自動的には戻りません。また 
				お使いのIMEによっては、確定済みのキー入力となります。</font></p>
				<p><font face="ＭＳ Ｐゴシック"> <br>
				　文字入力が高速に行われるため、一文字ごとにウェイトを入れる場合には、def option SendTextDelay 
				にて設定できます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option SendTextDelay = <em>DELAY</em>
			  </font>
			  </p>
				<p>未設定のときには、20msが設定されています。値域は 0〜32767です。</p>
			</div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック"><a name="function_SetForegroundWindow">
			&amp;SetForegroundWindow(<em>Window Class [&amp;&amp; or || Window Title]</em>)</a></font></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  	<font face="ＭＳ Ｐゴシック">　指定したウィンドウクラス名とウィンドウタイトル名を持つウィンドウを最前面にします。
				 
				<br>
				　例えば、次のように設定すると、メモ帳を最前面に表示します。</font><p class="sample">
			  <font face="ＭＳ ゴシック">key S-F5 = &amp;SetForegroundWindow(/Notepad/)</font></p>
				<p><font face="ＭＳ Ｐゴシック"> ウィンドウクラス名とウィンドウタイトル名を同時に指定する場合には、<a href="#windowClass">ウィンドウクラス/タイトル名</a>を 
				ご覧ください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				制限事項として、Windowsの仕様により、最前面に表示されずに、タスクバーで点滅するのみとなることがあるので ご注意ください。</font></p>
			</div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック"><a name="function_SetImeConvStatus">
			&amp;SetImeConvStatus(<em>status</em>)</a></font></code><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  	<font face="ＭＳ Ｐゴシック">　IME オン中の入力モードを変更します。
				 
				<br>
				　例えば、次のように設定すると、半角英数、半角カタカナ、全角英数、全角ひらがな、全角カタカナに切り替えます。<br>
				　なお、半角英数に切り替えると IMEはオフとなります。</font><p class="sample">
			  <font face="ＭＳ ゴシック">key S-C-H = &amp;SetImeConvStatus(0x0010)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
				# 半角英数<br>
				key S-C-J = &amp;SetImeConvStatus(0x0013)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
				# 半角カタカナ<br>
				key S-C-K = &amp;SetImeConvStatus(0x0018)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
				# 全角英数<br>
				key S-C-L = &amp;SetImeConvStatus(0x0019)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
				# 全角ひらがな<br>
				key S-C-Semicolon = &amp;SetImeConvStatus(0x001B) # 全角カタカナ</font></p>
				<p><font face="ＭＳ Ｐゴシック"><a href="#def_option_KL">カナロックの項</a>も御覧ください。</font></p>
				<p><font face="ＭＳ Ｐゴシック">
				制限事項として、IME 2007, IME 2003, IME 2002 にて動作確認出来ていますが、環境 
				によっては、うまく動作しません。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_SetImeStatus"><code>
			<font face="ＭＳ Ｐゴシック">&amp;SetImeStatus(<em>status</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">IME の ON/OFF を切り替えます。</font><code><em><font face="ＭＳ Ｐゴシック">status</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <code><font face="ＭＳ Ｐゴシック">on</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">off</font></code><font face="ＭＳ Ｐゴシック">, 
				</font> <code><font face="ＭＳ Ｐゴシック">toggle</font></code><font face="ＭＳ Ｐゴシック"> 
				のいずれかで、省略時は  
				</font> <code><font face="ＭＳ Ｐゴシック">toggle</font></code><font face="ＭＳ Ｐゴシック"> 
				として扱われます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">例えば、変換キーと無変換キーで、それぞれ IME ON とIME 
				OFFを実現するには、次のようになります。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">key *IC-変換 = &amp;SetImeStatus(on)<br>
				key *IC-無変換 = &amp;SetImeStatus(off)
				</font>
			  </p>
			  <p><font face="ＭＳ Ｐゴシック">MS-IME2002/2003 と一部のアプリケーション (例えば MS 
				Word2002/2003) の組み合わせでは「詳細なテキストサービス」を無効にしない限り機能しません。 
				なおVistaや7では「詳細なテキストサービス」を無効にすることは出来ませんが、XPよりも挙動が安定しており、ある程度使えます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">なお、104.nodoka や 109.nodoka では、keyseq 
				$ToggleIME が定義されているので、トグル操作で、&amp;SetImeStatus(toggle) の代わりに 
				$ToggleIME が使用可能です。 
				また操作対象となるウィンドウによっては、&amp;SetImeStatus(status)が、うまく機能しないことがあり 、その場合でも 
				$ToggleIME 
				が有効な場合があります。例えば、IEには、&amp;SetImeStatus()が、うまく効かない場合、下記の様な記述で、IEだけ、$ToggleIMEを使うことが可能です。</font></p>
			  
			  <p class="sample">
			  key *CapsLock = &amp;SetImeStatus(toggle) <br>
				window InternetExplorer /iexplore\.exe/ : Global<br>
				key *CapsLock = $ToggleIME</p>
				<p><font face="ＭＳ Ｐゴシック">もし、$ToggleIME で、トグルではなく ON あるいは OFF 
				を実現させる場合、例えば、変換キーで IME ON、無変換キーで IME OFFを実現させるには、次のような記述となります。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">key ~IL-変換 = $ToggleIME<br>
				key IL-*IC-無変換 = $ToggleIME
				</font>
			  </p>
				<p><font face="ＭＳ Ｐゴシック">なお、IME ON/OFFに関しては、IME自身のかな漢字入力 
				ON/OFFキーの設定でも、使いたいキーにもよりますが、実現可能なので、お使いの環境に合わせて、一番、安定して正しく動く設定を、お使いになるのが一番でしょう。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_SetImeString"><code>
			<font face="ＭＳ Ｐゴシック">&amp;SetImeString(<em>text</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">IME を経由して </font> <code><em>
				<font face="ＭＳ Ｐゴシック">text</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> を入力します。 実際の動作については、使用されているIMEによって挙動は異なります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_ShellExecute"><code>
			<font face="ＭＳ Ｐゴシック">&amp;ShellExecute(<em>operation</em>, <em>file</em>, <em>
			parameters</em>, <em>directory</em>, <em>show_command</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">プログラムを実行します。</font></p>
			  
			  <ul>
			    <li><code><em><font face="ＭＳ Ｐゴシック">operation</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> にはファイルに対してどのような操作をするかを指示し、通常</font><code><font face="ＭＳ Ｐゴシック">open</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定します。</font><code><font face="ＭＳ Ｐゴシック">open</font></code><font face="ＭＳ Ｐゴシック"> 
				以外も指定可能ですが、どのように動作するかについては、指定した実行ファイルに依存します。
			    </font>
			    <li><code><em><font face="ＭＳ Ｐゴシック">file</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> には 文書ファイルか実行ファイル名を書きます。
			    \\を用いてフルパス指定が一番高速に起動します。</font><li><code><em><font face="ＭＳ Ｐゴシック">parameters</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> には  
				</font> <code><em><font face="ＭＳ Ｐゴシック">file</font></em></code><font face="ＭＳ Ｐゴシック"> 
				に実行ファイルを書いたとき に渡す引数を記述します。直接記述する他に、<a href="#arg_subst">引数置換変数</a> 
				を用いて、現在アクティブなウィンドウの Class名やTitle名を渡せます。</font><li><code><em><font face="ＭＳ Ｐゴシック">
				directory</font></em></code><font face="ＭＳ Ｐゴシック"> <a href="#string">
				文字列</a> は作業ディレクトリを指定します。
			     
				</font>
			    <li><code><em><font face="ＭＳ Ｐゴシック">show_command</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には  
				</font> <code><font face="ＭＳ Ｐゴシック">ShowNormal</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定します。</font><code><font face="ＭＳ Ｐゴシック">ShowNormal</font></code><font face="ＭＳ Ｐゴシック"> 
				以外にも、</font><code><font face="ＭＳ Ｐゴシック">hide maximaize minimize 
				restore show showDefault showMaximized showMinimized 
				showMinNoActive showNA showNoActivate </font> </code><font face="ＭＳ Ｐゴシック">
				が指定可能ですが、その挙動は実行ファイルに依存します。</font><code><font face="ＭＳ Ｐゴシック">
				</font> </code>
			  </ul>
			  
			  <p><font face="ＭＳ Ｐゴシック">コントロールパネルを開く例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-B = &amp;ShellExecute(&quot;open&quot;, 
				&quot;C:\\WINDOWS\\system32\\Control.exe&quot;,,, ShowNormal)
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">システムのプロパティを開く例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-C = &amp;ShellExecute(&quot;open&quot;, 
				&quot;C:/WINDOWS/system32/Control.exe&quot;, &quot;sysdm.cpl&quot;,, ShowNormal)
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">インターネットエクスプローラで「のどか」のホームページを開く例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-I = &amp;ShellExecute(&quot;open&quot;, &quot;C:\\Program 
				Files\\Internet Explorer\\iexplore.exe&quot;, 
				&quot;http://appletkan.com/&quot;,, ShowNormal)<br>
			  &nbsp;key M-H = &amp;ShellExecute(&quot;open&quot;, &quot;http://appletkan.com/&quot;,,, 
				ShowNormal)
				</font>
			  </p>
			  
			  <p><code><font face="ＭＳ Ｐゴシック">flourish.mid</font></code><font face="ＭＳ Ｐゴシック"> 
				を演奏する例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-R = &amp;ShellExecute(&quot;play&quot;, 
				&quot;C:\\WINDOWS\\Media\\flourish.mid&quot;,,, ShowNormal)
				</font>
			  </p>
			</div>
			
		    <dt class="h3"><a name="function_Sync"><code><font face="ＭＳ Ｐゴシック">
			&amp;Sync</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">基本的に、ウィンドウへのキー入力と </font> <code><em>
				<font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は非同期に実行されます。つまりキー入力と  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の実行順序は不明です。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key C-A = A &amp;WindowMinimize </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">　　このように記述して </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				+ 
				</font> <kbd><font face="ＭＳ Ｐゴシック">A</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力すると、Windows へ  
				</font> <code><font face="ＭＳ Ｐゴシック">A</font></code><font face="ＭＳ Ｐゴシック"> 
				が入力されるのが先か、</font><code><font face="ＭＳ Ｐゴシック">&amp;WindowMinimize</font></code><font face="ＭＳ Ｐゴシック"> 
				が実行されるのが先かは不明です。そこで、以下のように記述すればちゃんと順序が守られることを保証できます。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key C-A = A &amp;Sync &amp;WindowMinimize
				</font>
			  </p>
			</div>
			<p><font face="ＭＳ Ｐゴシック">　なお、<b><i>FUNCTION</i></b>の終了は、&amp;Syncでは、同期が取れないために、<a href="#function_Wait">&amp;Wait()</a>の使用が必要となるケースがあります。また 
			FireFoxなど特定のアプリでは、&amp;Syncを複数使用しても、おかしな入力となることがあります。<br>
			<br>
			また、</font><code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
			には<a href="#modifier">モディファイヤ</a>を指定することが可能ですが、</font><code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
			とモディファイヤキー入力が非同期に実行されるため通常は意味がありません。しかし、</font><code><font face="ＭＳ Ｐゴシック">&amp;Sync</font></code><font face="ＭＳ Ｐゴシック"> 
			を使えばモディファイヤキーの指定に意味が出てきます。</font></p>
			<div>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">window Explorer /Explorer\.exe/ : Global<br>
			  &nbsp;key C-S-Z = &amp;Sync &amp;WindowMaximize # ウィンドウの最大化<br>
			  &nbsp;key C-A-Z = C-&amp;Sync *&amp;WindowMaximize # ウィンドウの全画面化 
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">前者の指定では、ウィンドウを最大化するときに </font> <kbd>
				<font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <kbd><font face="ＭＳ Ｐゴシック">Shift</font></kbd><font face="ＭＳ Ｐゴシック"> 
				が入力されません。後者では、</font><kbd><font face="ＭＳ Ｐゴシック">Control</font></kbd><font face="ＭＳ Ｐゴシック"> 
				は入力されるが、</font><kbd><font face="ＭＳ Ｐゴシック">Alt</font></kbd><font face="ＭＳ Ｐゴシック"> 
				は入力されません。</font></p>
			  
			  <p><a href="#def_sync"><code><font face="ＭＳ Ｐゴシック">def sync</font></code></a><font face="ＭＳ Ｐゴシック"> 
				参照。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Toggle"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Toggle(Lock<em>N [, on|off]</em>)</font></code></a><font face="ＭＳ Ｐゴシック"> </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">ロックキーと呼んでいる内部変数の状態を変更し、モディファイヤーとして使用できます。</font><code><font face="ＭＳ Ｐゴシック">&amp;Toggle(Lock0)</font></code><font face="ＭＳ Ｐゴシック">〜</font><code><font face="ＭＳ Ｐゴシック">&amp;Toggle(LockF)</font></code><font face="ＭＳ Ｐゴシック"> 
				が利用できます。<a href="#lock">ロックキーの項</a>もご覧ください。Lock0〜Lock9およびLockA〜LockFの代わりに、L0〜L9およびLA〜LFも表記可能です。その場合 
				&amp;Toggle(L0)や&amp;Toggle(L0, on)などになります。</font></p>
				<p><font face="ＭＳ Ｐゴシック">引数に </font> <code>
				<font face="ＭＳ Ｐゴシック">,on</font></code><font face="ＭＳ Ｐゴシック">
				</font> <code><font face="ＭＳ Ｐゴシック">あるいは,off</font></code><font face="ＭＳ Ｐゴシック"> 
				を追加すると、ロックキーを強制的にオンにしたりオフにしたりできます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">オンには、</font><code><font face="ＭＳ Ｐゴシック">on, 
				true, pressed 
				</font> </code><font face="ＭＳ Ｐゴシック">が、またオフには、</font><code><font face="ＭＳ Ｐゴシック">off, 
				false, released</font></code><font face="ＭＳ Ｐゴシック"> が使えます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">on/off を1bitの状態と考え、複数のロックキーを組み合わせ
				て例えば10個用いると、2^10 = 1024個の状態を表すことが可能です。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Undefined"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Undefined</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">
				キーに何も割り当てられていないことにします。もしそのキーが押されると、ベルが鳴ります。 ベルを鳴らしたくない時には、<a href="#function_Ignore">&amp;Ignore</a> 
				を用います。</font></div>
			
		    <dt class="h3"><a name="function_UseTSF"><code>
			<font face="ＭＳ Ｐゴシック">&amp;UseTSF</font></code><font face="ＭＳ Ｐゴシック">(true|false)</font></a><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">　 IMEの状態取得の際、Text Services Framework: TSFの使用/未使用を指定します。TSF未使用時には、IMM32経由で、IMEの状態を取得します。</font><p>
				<font face="ＭＳ Ｐゴシック">Globalに、未使用設定とするには、def option UseTSF = 
				false が利用可能です。また ウィンドウ単位で設定するには、下記の設定例をご覧ください。</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">def option UseTSF = false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
				# 設定ファイル全体で、TSF未使用状態に設定する場合には、この行だけで良い。<br>
				def option FocusChange = enable　&nbsp;&nbsp;&nbsp; # FocusChangeを有効にし、Windowごとの設定を可能とする。<br>
				key U-FocusChange = &amp;UseTSF(false)&nbsp;&nbsp; # 
				window設定していないアプリの場合のデフォルトを決定する。<br>
				<br>
				window WORD /WINWORD\.EXE/ : Global　# WORDの場合、TSFを有効にする。<br>
				key U-FocusChange = &amp;UseTSF(true)<br>
				<br>
				window InternetExplorer /iexplore\.exe/ : Global&nbsp;&nbsp;&nbsp; 
				# IEの場合、TSFを無効にする。<br>
				key U-FocusChange = &amp;UseTSF(false)
			  </font>
			  </p>
				<p><font face="ＭＳ Ｐゴシック">制限事項として、UseTSF(false)あるいは、<a href="#def_option_UseTSF">def 
				option UseTSF = false</a> の場合、<a href="#modifier">モディファイヤー IH-, 
				IK-, IJ-</a>は認識できなくなります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_VK"><code><font face="ＭＳ Ｐゴシック">
			&amp;VK(<em>virtual_key</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">仮想キーを Windows 
				へ入力します。仮想キーには、物理的なキーボードから入力できないキーも存在しますのでそのようなキーの入力に使用します。仮想キーを調べるには、タスクトレイメニュー</font><a href="MANUAL-ja.html#menu-i" class="menu-item"><font face="ＭＳ Ｐゴシック">調査(I)...</font></a><font face="ＭＳ Ｐゴシック">の「仮想キーの調査」を利用します。例えば、</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key 変換 = &amp;VK(F13)
			  </font>
			  </p>
			  
			  <p class="continue"><font face="ＭＳ Ｐゴシック">と記述すると </font> <kbd>
				<font face="ＭＳ Ｐゴシック">変換</font></kbd><font face="ＭＳ Ｐゴシック"> 
				キーを押すと  
				</font> <kbd><font face="ＭＳ Ｐゴシック">F13</font></kbd><font face="ＭＳ Ｐゴシック"> 
				を入力できます。又、</font><code><font face="ＭＳ Ｐゴシック">E-</font></code><font face="ＭＳ Ｐゴシック"> 
				を付けると拡張キーを表し、</font><code><font face="ＭＳ Ｐゴシック">D-</font></code><font face="ＭＳ Ｐゴシック"> 
				はキーを押す、</font><code><font face="ＭＳ Ｐゴシック">U-</font></code><font face="ＭＳ Ｐゴシック"> 
				はキーを離すことを表します。</font></p>
			  
			  <p><code><em><font face="ＭＳ Ｐゴシック">virtual_key</font></em></code><font face="ＭＳ Ｐゴシック"> 
				に  
				</font> <code><font face="ＭＳ Ｐゴシック">LButton</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">MButton</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">RButton</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">XButton1</font></code><font face="ＭＳ Ｐゴシック">、</font><code><font face="ＭＳ Ｐゴシック">XButton2</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定することによって、マウスのボタンをシミュレートすることができます。</font></p>
			  
			  <p><font face="ＭＳ Ｐゴシック">この </font> <code><em>
				<font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を利用するときは、必ず最後にキーを離していることを確認してください (つまり最後に  
				</font> <code><font face="ＭＳ Ｐゴシック">&amp;VK(U-F13)</font></code><font face="ＭＳ Ｐゴシック"> 
				などを書いておく)。さもないと、そのキーが押されっぱなしになります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Variable"><code>
			<font face="ＭＳ Ｐゴシック">&amp;Variable(<em>mag</em>, <em>inc</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><a href="#function_Repeat"><code><font face="ＭＳ Ｐゴシック">&amp;Repeat</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と  
				</font> <a href="#function_HelpVariable"><code>
				<font face="ＭＳ Ｐゴシック">&amp;HelpVariable</font></code></a><font face="ＭＳ Ｐゴシック"> 
				で使用可能な内部変数です。</font><code><em><font face="ＭＳ Ｐゴシック">mag</font></em></code><font face="ＭＳ Ｐゴシック"> 
				倍してから  
				</font> <code><em><font face="ＭＳ Ｐゴシック">inc</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を加えます。 通常</font><code><em><font face="ＭＳ Ｐゴシック">mag </font></em></code>
				<font face="ＭＳ Ｐゴシック"> には、0を指定することになります。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_Wait"><code><font face="ＭＳ Ｐゴシック">
			&amp;Wait(<em>milli_second</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><code><em><font face="ＭＳ Ｐゴシック">milli_second</font></em></code><font face="ＭＳ Ｐゴシック"> 
				ミリ秒だけ実行を中断します。その間はキーを入力することはできません。値域は、0〜5000であり、単位はmsecです。最大 5秒待つことができます。</font></p>
				<p><span class="auto-style1">例えば次のように記述して、<kbd><font face="ＭＳ Ｐゴシック">Ctrl</font></kbd>キーと</span><kbd><font face="ＭＳ Ｐゴシック">1</font></kbd>キーを押すと、<kbd><font face="ＭＳ Ｐゴシック">A</font></kbd>
				<kbd>
				<font face="ＭＳ Ｐゴシック">B</font></kbd> <kbd>
				<font face="ＭＳ Ｐゴシック">C</font></kbd>のキーが順に100msec間隔で押されたことになります。</p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key C-_1 = A &amp;Wait(100) B &amp;Wait(100) C</font></p>
			  
			</div>
			
		    <dt class="h3"><a name="function_WaitKey"><code><font face="ＭＳ Ｐゴシック">
			&amp;WaitKey(<em>milli_second</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック"> 
				&amp;WaitKey(100) と記述すると、以降の全てのキー出力やファンクションの実行の直前に、指定した時間<span class="auto-style2">1<span class="auto-style3">00</span></span> 
				ミリ秒だけ実行を中断します。中断中はキーを入力することはできません。値域は、0〜5000であり、単位はmsecです。全てのキー出力が遅くなったままになるので、設定が不要になったら、&amp;WaitKey(0) 
			  を記述して、元に戻してください。</font></p>
				<p><span class="auto-style1">例えば次のように記述して、<kbd><font face="ＭＳ Ｐゴシック">Ctrl</font></kbd>キーと</span><kbd><font face="ＭＳ Ｐゴシック">1</font></kbd>キーを押すと、<kbd><font face="ＭＳ Ｐゴシック">A</font></kbd>
				<kbd>
				<font face="ＭＳ Ｐゴシック">B</font></kbd> <kbd>
				<font face="ＭＳ Ｐゴシック">C</font></kbd>のキーが順に100msec間隔で押されたことになります。</p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key C-_1 = A &amp;WaitKey(100) B C &amp;WaitKey(0)</font></p>
			  
			</div>
			
		    <dt class="h3"><a name="function_WindowCling"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowClingToLeft</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToRight</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToTop</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToBottom</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> </a>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウを、それぞれの辺が画面のそれぞれの辺にくっつくように移動させます。</font><code><font face="ＭＳ Ｐゴシック">(MDI)</font></code><font face="ＭＳ Ｐゴシック">を追加すると、MDI 
				子ウィンドウを操作します。</font></p>
			  
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToTop</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowMoveTo"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(N, 0, 0)</font></code></a><font face="ＭＳ Ｐゴシック">と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToRight</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowMoveTo"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(E, 0, 0)</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToLeft</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowMoveTo"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(W, 0, 0)</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowClingToBottom</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowMoveTo"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(S, 0, 0)</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			   
				</font>
			  </ul>
			</div>
			
		    <dt class="h3"><a name="function_WindowClose"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowClose</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウを閉じます。</font><code><font face="ＭＳ Ｐゴシック">(MDI)</font></code><font face="ＭＳ Ｐゴシック">を追加すると、MDI 
				子ウィンドウを操作します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowIdentify"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowIdentify</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウのウィンドウクラス名とタイトルを調査して、ログウィンドウに出力します。又、各種ウィンドウの位置と大きさも出力します。<br>
				　お使いのWindows によっては、正しく取得できないプログラムのウィンドウが存在します。<a href="MANUAL-ja.html#BUGS">バグの項</a>をご覧ください。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowMaxMinHVMax"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMinimize</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowMaximize</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowHMaximize</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowVMaximize</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウを、それぞれ、最小化、最大化、横方向に最大化、縦方向に最大化します。</font><code><font face="ＭＳ Ｐゴシック">(MDI)</font></code><font face="ＭＳ Ｐゴシック">を追加すると、MDI 
				子ウィンドウを操作します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowMonitor"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMonitor(<em>monitor</em>, <em>
			adjust_position</em>, <em>adjust_size</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">複数のディスプレイを用いたマルチモニタ環境の場合において、ウィンドウをモニタ  
				</font> <code><em>
				<font face="ＭＳ Ｐゴシック">monitor</font></em></code><font face="ＭＳ Ｐゴシック"> 
				へ移動します。</font><a href="#function_WindowMonitorTo"><code><font face="ＭＳ Ｐゴシック">&amp;WindowMonitorTo(primary, <em>
				monitor</em>, <em>adjust_position</em>, <em>adjust_size</em>)</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ動作をします。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowMonitorTo"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMonitorTo(<em>from</em>, <em>monitor</em>, <em>
			adjust_position</em>, <em>adjust_size</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">マルチモニタ環境の場合において、現在アクティブなプログラムのウィンドウを </font> <code><em>
				<font face="ＭＳ Ｐゴシック">from</font></em></code><font face="ＭＳ Ｐゴシック"> 
				を基準としてモニタ  
				</font> <code><em><font face="ＭＳ Ｐゴシック">monitor</font></em></code><font face="ＭＳ Ｐゴシック"> 
				へ移動します。</font><code><em><font face="ＭＳ Ｐゴシック">from</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、次のものが指定できます。</font></p>

			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">primary</font></code><font face="ＭＳ Ｐゴシック"> 
				: プライマリモニタを基準とします</font></li>
			    <li><code><font face="ＭＳ Ｐゴシック">current</font></code><font face="ＭＳ Ｐゴシック"> 
				: 現在ウィンドウがあるモニタを基準とします</font></li>
			  </ul>

			  <p><code><em><font face="ＭＳ Ｐゴシック">monitor</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、数字が指定できます。</font><code><font face="ＭＳ Ｐゴシック">0</font></code><font face="ＭＳ Ｐゴシック"> 
				が基準となるモニタ、正の数は  
				</font> <code><font face="ＭＳ Ｐゴシック">1</font></code><font face="ＭＳ Ｐゴシック">: 
				次のモニタ、</font><code><font face="ＭＳ Ｐゴシック">2</font></code><font face="ＭＳ Ｐゴシック">: 
				次の次のモニタ…、負の数は  
				</font> <code><font face="ＭＳ Ｐゴシック">-1</font></code><font face="ＭＳ Ｐゴシック">: 
				前のモニタ、</font><code><font face="ＭＳ Ｐゴシック">-2</font></code><font face="ＭＳ Ｐゴシック">: 
				前の前のモニタ…、を意味します。
				モニターの数が3個以上となったときに、Windowsのコントロールパネル/ディスプレイ/画面の解像度で設定した各ディスプレイの位置と一致せず、次のモニターあるいは前のモニターがどれになるか不定でしたが、Ver4.27からprimaryから見て右側にあるモニタが次のモニター、左側にあるモニタが前のモニタになるよう修正しました。</font></p>
			  <p><code><em><font face="ＭＳ Ｐゴシック">adjust_position</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は省略可能な引数で  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				か  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定します。省略すると  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されたとみなされます。</font><code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定された場合、移動先がモニタからはみ出すときにできる限りモニタ内におさまる位置へ移動します。</font></p>
			  <p><code><em><font face="ＭＳ Ｐゴシック">adjust_size</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は省略可能な引数で  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				か  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定します。省略すると  
				</font> <code><font face="ＭＳ Ｐゴシック">false</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定されたとみなされます。</font><code><em><font face="ＭＳ Ｐゴシック">adjust_position</font></em></code><font face="ＭＳ Ｐゴシック"> 
				が  
				</font> <code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				の場合のみ有効です。</font><code><font face="ＭＳ Ｐゴシック">true</font></code><font face="ＭＳ Ｐゴシック"> 
				が指定された場合、移動先がモニタからはみ出すときにモニタ内におさまるようウィンドウの大きさを調整します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowMove"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMove(<em>dx</em>, <em>dy [,MDI])</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウを水平方向に </font> <code><em>
				<font face="ＭＳ Ｐゴシック">dx</font></em></code><font face="ＭＳ Ｐゴシック">、垂直方向に  
				</font> <code><em><font face="ＭＳ Ｐゴシック">dy</font></em></code><font face="ＭＳ Ｐゴシック"> 
				移動します。</font><code><font face="ＭＳ Ｐゴシック">MDI</font></code><font face="ＭＳ Ｐゴシック"> 
				を引数の最後に追加指定すると、MDI 子ウィンドウを操作します。</font><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(C, <em>
				dx</em>, <em>dy</em>)</font></code><font face="ＭＳ Ｐゴシック"> 
				と同じ動作をします。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowMoveTo"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(<em>gravity</em>, <em>dx</em>, <em>
			dy [,MDI]</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウを、基準位置から相対的にウィンドウを水平方向に </font> <code><em>
				<font face="ＭＳ Ｐゴシック">dx</font></em></code><font face="ＭＳ Ｐゴシック">、垂直方向に  
				</font> <code><em><font face="ＭＳ Ｐゴシック">dy</font></em></code><font face="ＭＳ Ｐゴシック"> 
				移動します。</font><code><font face="ＭＳ Ｐゴシック">MDI</font></code><font face="ＭＳ Ｐゴシック"> 
				を引数の最後に追加指定すると、MDI 子ウィンドウを操作します。</font><code><em><font face="ＭＳ Ｐゴシック">gravity</font></em></code><font face="ＭＳ Ｐゴシック"> 
				には、次のものが指定できます。</font></p>
			  
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">C</font></code><font face="ＭＳ Ｐゴシック"> 
				: 現在位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">N</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向はデスクトップの上からの相対位置、左右方向は現在位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">E</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向は現在位置からの相対位置、左右方向はデスクトップの右からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">W</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向は現在位置からの相対位置、左右方向はデスクトップの左からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">S</font></code><font face="ＭＳ Ｐゴシック"> 
				: 上下方向はデスクトップの下からの相対位置、左右方向は現在位置からの相対位置に移動します。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">NE</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ右上からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">NW</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ左上からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">SE</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ右下からの相対位置に移動。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">SW</font></code><font face="ＭＳ Ｐゴシック"> 
				: デスクトップ左下からの相対位置に移動。
			   
				</font>
			  </ul>
			  
			  <p><font face="ＭＳ Ｐゴシック">また、他の移動 </font> <code><em>
				<font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				とは以下のような関係があります。</font></p>
			  
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(C, <em>dx</em>, <em>
				dy</em>)</font></code><font face="ＭＳ Ｐゴシック"> は  
				</font> <a href="#function_WindowMove"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowMove(<em>dx</em>, <em>dy</em>)</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(N, 0, 0)</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowCling"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowClingToTop</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(E, 0, 0)</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowCling"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowClingToRight</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(W, 0, 0)</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowCling"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowClingToLeft</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">&amp;WindowMoveTo(S, 0, 0)</font></code><font face="ＭＳ Ｐゴシック"> 
				は  
				</font> <a href="#function_WindowCling"><code>
				<font face="ＭＳ Ｐゴシック">&amp;WindowClingToBottom</font></code></a><font face="ＭＳ Ｐゴシック"> 
				と同じ。
			   
				</font>
			  </ul>
			</div>
			
		    <dt class="h3"><a name="function_WindowMoveVisibly"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowMoveVisibly</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウ全体が、画面に入るように表示されるような位置へウィンドウを移動します。</font><code><font face="ＭＳ Ｐゴシック">(MDI)</font></code><font face="ＭＳ Ｐゴシック"> 
				を追加すると、MDI 子ウィンドウを操作します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowRedraw"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowRedraw</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウを強制的に再描画させます。</font></p>
			</div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック" color="#FFFFFF">
			<a name="function_WindowResizeTo">&amp;WindowResizeTo(</a></font><a name="function_WindowResizeTo"><font face="ＭＳ Ｐゴシック" color="#000000"><i>width, 
			height, [,MDI]</i></font><font face="ＭＳ Ｐゴシック" color="#FFFFFF">)</font></a></code><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウの大きさを幅 </font> <code><em>
				<font face="ＭＳ Ｐゴシック">width</font></em></code><font face="ＭＳ Ｐゴシック">、高さ  
				</font> <code><em><font face="ＭＳ Ｐゴシック">height</font></em></code><font face="ＭＳ Ｐゴシック"> 
				に変更します。</font><code><font face="ＭＳ Ｐゴシック">0</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定すると現在の大きさに、負の値を指定するとデスクトップの大きさより指定したピクセル数だけ小さい大きさになります。</font><code><font face="ＭＳ Ｐゴシック">MDI</font></code><font face="ＭＳ Ｐゴシック"> 
				を引数の最後に追加指定すると、MDI 子ウィンドウを操作します。</font></div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック" color="#FFFFFF">
			<a name="function_WindowResizeToPer">&amp;WindowResizeToPer(</a></font><a name="function_WindowResizeTo1"><font face="ＭＳ Ｐゴシック" color="#000000"><i>width, 
			height, [,MDI]</i></font><font face="ＭＳ Ｐゴシック" color="#FFFFFF">)</font></a></code><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウの大きさを、現在の幅 x </font> <code><em>
				<font face="ＭＳ Ｐゴシック">width</font></em></code><font face="ＭＳ Ｐゴシック">[%]、 
				現在の高さ x  
				</font> <code><em><font face="ＭＳ Ｐゴシック">height</font></em></code><font face="ＭＳ Ｐゴシック"> 
				[%]に変更します。</font><code><font face="ＭＳ Ｐゴシック">100</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定すると現在の大きさに、100より小さければ、縮小し、100よりも大きければ拡大します。</font><code><font face="ＭＳ Ｐゴシック">MDI</font></code><font face="ＭＳ Ｐゴシック"> 
				を引数の最後に追加指定すると、MDI 子ウィンドウを操作します。<br>
				<br>
				もしも、現在の画面サイズ全体からのパーセント指定したい場合には、</font><code><font face="ＭＳ Ｐゴシック"><a name="function_WindowMaxMinHVMax0" href="#function_WindowMaxMinHVMax">&amp;WindowMaximize</a>
				<a href="#function_Sync">&amp;Sync</a> を あらかじめ実行してください。</font></code></div>
			
		    <dt class="h3"><a name="function_WindowResizeMoveTo"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowResizeMoveTo(<em>width</em>, <em>
			height, gravity</em>, <em>dx</em>, <em>dy [,MDI])</em>)</font></code></a><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウの大きさの変更と移動を行います。 引数の指定は、<a href="#function_WindowResizeTo">&amp;WindowResieTo()</a>, 
				<a href="#function_WindowMoveTo">&amp;WindowMoveTo(</a>) と同じです。</font></div>
			
		    <dt class="h3"><code>
			<font face="ＭＳ Ｐゴシック"><a name="function_WindowResizeMoveToPer">
			&amp;WindowResizeMoveToPer(<em>width</em>, <em>height, gravity</em>, <em>
			dx</em>, <em>dy [,MDI])</em>)</a></font></code><dd class="d3">
			<div>
			  <font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウの大きさの変更と移動を行います。 引数の指定は、<a href="#function_WindowResizeToPer">&amp;WindowResieToPer()</a>, 
				<a href="#function_WindowMoveTo">&amp;WindowMoveTo(</a>) と同じです。</font></div>
			
		    <dt class="h3"><a name="function_WindowRiseLower"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowRaise</font></code><font face="ＭＳ Ｐゴシック">, 
			</font> <code><font face="ＭＳ Ｐゴシック">&amp;WindowLower</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウを、それぞれ、一番上、一番下へ移動します。</font><code><font face="ＭＳ Ｐゴシック">(MDI)</font></code><font face="ＭＳ Ｐゴシック"> 
				を追加すると、MDI 子ウィンドウを操作します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowSetAlpha"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowSetAlpha(<em>alpha</em>)</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">
				現在アクティブなプログラムのウィンドウを半透明化、又は半透明化解除します。トグルになっています。</font><code><em><font face="ＭＳ Ｐゴシック">alpha</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は半透明の度合いを表し、</font><code><font face="ＭＳ Ｐゴシック">0</font></code><font face="ＭＳ Ｐゴシック"> 
				で透明、</font><code><font face="ＭＳ Ｐゴシック">100</font></code><font face="ＭＳ Ｐゴシック"> 
				で不透明になります。</font><code><font face="ＭＳ Ｐゴシック">-1</font></code><font face="ＭＳ Ｐゴシック"> 
				を指定すると、この  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				で半透明化されたウィンドウを全て不透明状態に戻します。</font></p>
			</div>
			
		    <dt class="h3"><a name="function_WindowToggleTopMost"><code>
			<font face="ＭＳ Ｐゴシック">&amp;WindowToggleTopMost</font></code></a><font face="ＭＳ Ｐゴシック">
			</font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">現在アクティブなプログラムのウィンドウの最前面フラグをトグルします。</font></p>
			</div>
		
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="arg_subst">引数置換</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">引数として </font> <code>
				<font face="ＭＳ Ｐゴシック">$</font></code><font face="ＭＳ Ｐゴシック"> 
				で始まる下記キーワードを指定することにより  
				</font> <code><em><font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の引数に文字列が使えるところで、それぞれが意味する文字列の内容を渡すことができます。値の取り出しは </font> <code><em>
				<font face="ＭＳ Ｐゴシック">FUNCTION</font></em></code><font face="ＭＳ Ｐゴシック"> 
				の実行時に行われます。</font></p>
				<p><font face="ＭＳ Ｐゴシック">$NodokaVal 
				は、お試し機能であり、将来の版では変更される可能性がありますが、$Clipboard, $WIndowClassName, 
				$WindowTitleNameには、展開された文字列が入ります。制限事項として、それぞれの文字列の長さは、最大2058byteであり、展開された文字列に 
				&quot; (ダブルクォーテーション)記号があると、分断されて渡されます。</font></p>
			  
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">$Clipboard </font> </code>
				<font face="ＭＳ Ｐゴシック">: クリップボードの中身
			    </font>
			    <li><code><font face="ＭＳ Ｐゴシック">$WindowClassName </font> </code>
				<font face="ＭＳ Ｐゴシック">: フォーカスされているウィンドウのクラス名
			    </font>
			    <li><code><font face="ＭＳ Ｐゴシック">$WindowTitleName </font> </code>
				<font face="ＭＳ Ｐゴシック">: フォーカスされているウィンドウのタイトル名
			  </font>
			    <li><code><font face="ＭＳ Ｐゴシック">$NodokaVal </font> </code>
				<font face="ＭＳ Ｐゴシック">: /Clipboard:&quot;</font><code><font face="ＭＳ Ｐゴシック">$Clipboard</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				/Class:&quot;</font><code><font face="ＭＳ Ｐゴシック">$WindowClassName</font></code><font face="ＭＳ Ｐゴシック">&quot; 
				/Title:&quot;</font><code><font face="ＭＳ Ｐゴシック">$WindowTitleName</font></code><font face="ＭＳ Ｐゴシック">&quot;&nbsp;
				</font>
			  </ul>
			  
			  <p><font face="ＭＳ Ｐゴシック">クリップボード内の文字列を URL としてブラウザで開く例:</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-C-O = &amp;ShellExecute(&quot;open&quot;, 
				$Clipboard,,, ShowNormal)
				</font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">
				フォーカスされているウィンドウのクラス名やタイトル名をクリップボードにコピーする例:</font></p>
			  
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key M-C-C = &amp;ClipboardCopy($WindowClassName)<br>
			  &nbsp;key M-C-T = &amp;ClipboardCopy($WindowTitleName) </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">$NodokaVal の使用例</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック">&nbsp;key C-S-F = &amp;ShellExecute(&quot;open&quot;, 
				&quot;C:&yen;&yen;Users&yen;&yen;hogehoge&yen;&yen;testNodokaVal.vbs&quot;, $NodokaVal,, 
				ShowNormal) </font>
			  </p>
			  
			  <p><font face="ＭＳ Ｐゴシック">テストスクリプト testNodokaVal.vbs の中身</font></p>
			  <p class="sample">
			  <font face="ＭＳ ゴシック" color="#000000">&nbsp;' $NodokaVal による引数表示<br>
				Option Explicit<br>
				<br>
				Dim ws<br>
				Dim args<br>
				Dim any_string<br>
				Dim program_name<br>
				Dim class_name<br>
				Dim title_name<br>
				<br>
				Set ws = CreateObject(&quot;WScript.Shell&quot;)<br>
				Set args = WScript.Arguments<br>
				<br>
				If args.Named.Exists(&quot;Clipboard&quot;) Then<br>
&nbsp; ws.Popup &quot;/Clipboard:&quot; &amp; args.Named(&quot;Clipboard&quot;) &amp; &quot; ,文字数 &quot; &amp; 
				Len(args.Named(&quot;Clipboard&quot;)), , , vbInformation<br>
				End If<br>
				<br>
				If args.Named.Exists(&quot;Class&quot;) Then<br>
				<br>
&nbsp; any_string = Split(args.Named(&quot;Class&quot;), &quot;:&quot;)<br>
&nbsp; program_name = any_string(0) + &quot;:&quot; + any_string(1)<br>
&nbsp; class_name = Mid(args.Named(&quot;Class&quot;), 1 + Len(program_name))<br>
				<br>
&nbsp; ws.Popup &quot;/Program:&quot; &amp; program_name , , , vbInformation<br>
&nbsp; ws.Popup &quot;/Class:&quot; &amp; class_name &amp; &quot; ,文字数 &quot; &amp; Len(class_name), , , 
				vbInformation<br>
				<br>
				End If<br>
				<br>
				If args.Named.Exists(&quot;Title&quot;) Then<br>
&nbsp; ws.Popup &quot;/Title:&quot; &amp; args.Named(&quot;Title&quot;) &amp; &quot; ,文字数 &quot; &amp; 
				Len(args.Named(&quot;Title&quot;)), , , vbInformation<br>
				End If<br>
				<br>
				If args.Unnamed.Count &gt; 0 Then<br>
&nbsp; ws.Popup &quot;名前なし:&quot; &amp; args.Unnamed(0) &amp; &quot; ,文字数 &quot; &amp; Len(args.Unnamed(0)) , , 
				, vbInformation<br>
				End If<br>
				<br>
				Set ws = Nothing<br>
				Set args = Nothing</font></p>
			</div>
			
		    <dt class="h3"><font face="ＭＳ Ｐゴシック"><a name="string">文字列</a>
			
		    </font>
			
		    <dd class="d3">
			<div>
			  <p><font face="ＭＳ Ｐゴシック">文字列が記述できる箇所には </font> <code>
				<font face="ＭＳ Ｐゴシック">&quot;文字列&quot;</font></code><font face="ＭＳ Ｐゴシック"> 
				と記述することができますが、</font><code><font face="ＭＳ Ｐゴシック">\</font></code><font face="ＭＳ Ｐゴシック"> 
				という文字は、その次にくる文字と組み合わせて特殊な文字を表します。</font></p>
			  <ul>
			    <li><code><font face="ＭＳ Ｐゴシック">\a</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+0007) ベル文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\e</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+001b) ESC 文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\f</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+000c) 改頁文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\n</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+000a) 改行文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\r</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+000d) 復帰文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\t</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+0009) タブ文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\v</font></code><font face="ＭＳ Ｐゴシック"> 
				(U+000b) 垂直タブ文字
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\'</font></code><font face="ＭＳ Ｐゴシック"> 
				「</font><code><font face="ＭＳ Ｐゴシック">'</font></code><font face="ＭＳ Ｐゴシック">」
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\&quot;</font></code><font face="ＭＳ Ｐゴシック"> 
				「</font><code><font face="ＭＳ Ｐゴシック">&quot;</font></code><font face="ＭＳ Ｐゴシック">」
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\\</font></code><font face="ＭＳ Ｐゴシック"> 
				「</font><code><font face="ＭＳ Ｐゴシック">\</font></code><font face="ＭＳ Ｐゴシック">」
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\c</font><em><font face="ＭＳ Ｐゴシック">X</font></em></code><font face="ＭＳ Ｐゴシック"> 
				コントロール文字一般。</font><code><font face="ＭＳ Ｐゴシック">^</font><em><font face="ＭＳ Ｐゴシック">X</font></em></code><font face="ＭＳ Ｐゴシック">
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\x</font><em><font face="ＭＳ Ｐゴシック">XXXX</font></eM></code><font face="ＭＳ Ｐゴシック"> 
				(U+<em>XXXX</em>) 16 進数で表現した UNICODE 文字。<em>X</em> は 0〜9 と a〜f。
			     
				</font>
			    <li><code><font face="ＭＳ Ｐゴシック">\0</font><em><font face="ＭＳ Ｐゴシック">XXXX</font></eM></code><font face="ＭＳ Ｐゴシック"> 
				8 進数で表現した UNICODE 文字。<em>X</em> は 0〜7。
			     
				</font>
			    <li><font face="ＭＳ Ｐゴシック">上記に当てはまらない </font> <code>
				<font face="ＭＳ Ｐゴシック">\</font><em><font face="ＭＳ Ｐゴシック">X</font></em></code><font face="ＭＳ Ｐゴシック"> 
				は <em>X</em> という文字そのもの。
			 
				</font>
			</div>
		  </dl>
		</div>
		
	    </dl>
	</div>
  </dl>
</div>

</body>
</html>